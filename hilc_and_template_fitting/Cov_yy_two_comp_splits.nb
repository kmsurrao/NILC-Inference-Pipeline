(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    278617,       8117]
NotebookOptionsPosition[    269993,       7977]
NotebookOutlinePosition[    270388,       7993]
CellTagsIndexPosition[    270345,       7990]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "matrix", " ", "of", " ", "auto"}], "-", " ", 
    RowBox[{"and", " ", "cross"}], "-", 
    RowBox[{
    "frequency", " ", "power", " ", "spectra", " ", "at", " ", "some", " ", 
     "multipole", " ", "ell"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"here", ",", " ", 
    RowBox[{"CC", " ", "=", " ", 
     RowBox[{"C_ell", "^", "CMB"}]}], " ", ",", " ", 
    RowBox[{"N1", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq1", "}"}]}]}], " ", ",", " ", 
    RowBox[{"N2", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq2", "}"}]}]}], " ", ",", " ", 
    RowBox[{"g1", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq1"}]}], 
    ",", " ", 
    RowBox[{"g2", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq2"}]}], 
    ",", " ", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{"C_ell", "^", "yy"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "tSZ", " ", "power", " ", "spectrum", " ", "in", " ", "frequency"}], 
        "-", 
        RowBox[{"independent", " ", "Compton"}], "-", 
        RowBox[{"y", " ", "units"}]}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Update", ":", " ", 
     RowBox[{
     "account", " ", "here", " ", "for", " ", "the", " ", "fact", " ", "that",
       " ", "we", " ", "have", " ", "to", " ", "make", " ", "two", " ", 
      "independent", " ", "ILC", " ", "maps", " ", "from", " ", "separate", 
      " ", "subsets", " ", "of", " ", "the", " ", "data"}]}], ";", " ", 
    RowBox[{"to", " ", "be", " ", "fully", " ", "general", " ", 
     RowBox[{"let", "'"}], "s", " ", "allow", " ", "them", " ", "to", " ", 
     "each", " ", "have", " ", "their", " ", "own", " ", "arbitrary", " ", 
     "noise", " ", "power", " ", "spectra", " ", 
     RowBox[{"(", 
      RowBox[{
      "later", " ", "we", " ", "can", " ", "specialize", " ", "to", " ", 
       "the", " ", "case", " ", "where", " ", "they", " ", "are", " ", 
       "equal"}], ")"}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8500974654435797`*^9, 3.850097474804103*^9}, {
   3.850097512768484*^9, 3.850097605412682*^9}, 3.850097643969492*^9, {
   3.850702624983939*^9, 3.850702667214251*^9}, {3.850707987162773*^9, 
   3.850708021753458*^9}},
 CellLabel->
  "In[699]:=",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClijSplit1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1Split1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2Split1", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit1noA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1Split1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], "T"}]}], ",", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ",", 
       RowBox[{"CC", "+", "N2Split1", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "ClijSplit1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1Split2", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2Split2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2noA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1Split2", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ",", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ",", 
       RowBox[{"CC", "+", "N2Split2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "ClijSplit2", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.85009745416115*^9, 3.850097455840989*^9}, {
  3.850097507223783*^9, 3.850097508147098*^9}, {3.850097619328155*^9, 
  3.8500976307601347`*^9}, {3.8507026691738987`*^9, 3.850702677763043*^9}, {
  3.850708026981884*^9, 3.8507080771403008`*^9}, {3.893700516688171*^9, 
  3.89370066096591*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}]},
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.85009762595746*^9, 3.8500976493892403`*^9}, 
   3.8503462496152983`*^9, 3.850350603552491*^9, 3.850353771426209*^9, 
   3.850700149782667*^9, 3.850702679275476*^9, {3.850708060149435*^9, 
   3.8507080797472363`*^9}, 3.850731042273538*^9, 3.85083121810919*^9, 
   3.851014081795988*^9, 3.85108291494518*^9, {3.851612289160774*^9, 
   3.8516122961099977`*^9}, 3.893697298566256*^9, 3.893700589991569*^9, 
   3.89370066951173*^9},
 CellLabel->
  "Out[231]//MatrixForm=",ExpressionUUID->"8281df5d-438d-486a-b2cf-\
280097f104b5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}]},
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.85009762595746*^9, 3.8500976493892403`*^9}, 
   3.8503462496152983`*^9, 3.850350603552491*^9, 3.850353771426209*^9, 
   3.850700149782667*^9, 3.850702679275476*^9, {3.850708060149435*^9, 
   3.8507080797472363`*^9}, 3.850731042273538*^9, 3.85083121810919*^9, 
   3.851014081795988*^9, 3.85108291494518*^9, {3.851612289160774*^9, 
   3.8516122961099977`*^9}, 3.893697298566256*^9, 3.893700589991569*^9, 
   3.893700669514539*^9},
 CellLabel->
  "Out[234]//MatrixForm=",ExpressionUUID->"4a97b2af-3ffa-4af0-8d10-\
40cc4588e620"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClijSplit1Inv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2Inv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit1noAInv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit1noA", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2noAInv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit2noA", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850708116348671*^9, 3.850708130230506*^9}, 
   3.850831219621644*^9, 3.851612297577784*^9, {3.893700672956503*^9, 
   3.893700697069837*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"2f9d2e15-0d49-4cdb-bf16-a4240c685d25"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"also", " ", "define", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"cross", "'"}], " ", "Clij"}], ",", " ", 
    RowBox[{
     RowBox[{
     "which", " ", "has", " ", "no", " ", "noise", " ", "as", " ", "it", " ", 
      "comes", " ", "from", " ", "cross"}], "-", 
     RowBox[{
     "power", " ", "of", " ", "two", " ", "independent", " ", "subsets", " ", 
      "of", " ", "the", " ", "data"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClijNoNoise", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", 
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "have", " ", "free", " ", "parameters", " ", "but", " ", "weights", " ", 
     RowBox[{"don", "'"}], "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "ClijNoNoise", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850706157245708*^9, 3.85070620271761*^9}, {
  3.851010120401086*^9, 3.8510101283455687`*^9}, {3.851014086292117*^9, 
  3.851014111466357*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"0bb951f3-b1d8-4f5f-8b7f-9906015e0846"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}]},
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8507062033221617`*^9, 3.850708087014298*^9, 
  3.850731046286146*^9, 3.850831226242753*^9, 3.851014118716838*^9, 
  3.851082917833824*^9, 3.851612301087426*^9, 3.89369730231019*^9, 
  3.8937007117632008`*^9},
 CellLabel->
  "Out[240]//MatrixForm=",ExpressionUUID->"0c08977c-e6d4-4692-bc65-\
fe37f9e61555"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gvec", "=", 
   RowBox[{"{", 
    RowBox[{"g1", ",", "g2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hvec", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"CMB", " ", "spectral", " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.850097695847044*^9, {3.850702861756133*^9, 3.8507028628665543`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"let", "'"}], "s", " ", "get", " ", "the", " ", "ILC", " ", 
    "weights", " ", "for", " ", "the", " ", "y"}], "-", 
   RowBox[{
   "maps", " ", "and", " ", "the", " ", "CMB", " ", "maps", " ", 
    "explicitly"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850098378793749*^9, 3.850098392042323*^9}, {
  3.8501038369203463`*^9, 3.850103838337369*^9}, {3.850708098090229*^9, 
  3.850708099254559*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"ed802296-cd4f-4f6b-80ba-47a10560f486"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"weightsILCySplit1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit1noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit1noAInv", ".", "gvec"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCySplit2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit2noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit2noAInv", ".", "gvec"}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.850098401291662*^9, 3.8500984313636293`*^9}, {
  3.8507080951339006`*^9, 3.850708095764429*^9}, {3.8507081375439*^9, 
  3.850708160240192*^9}, {3.893700717091535*^9, 3.89370073058888*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"aae96ca5-3198-45e6-9d92-3d79d37e4666"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"CC", " ", 
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
     RowBox[{"g1", " ", "N2Split1"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2Split1"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"CC", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
     RowBox[{"g2", " ", "N1Split1"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2Split1"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.850098414021923*^9, 3.850098432101811*^9}, 
   3.850103856239477*^9, 3.850346332587731*^9, 3.850350633644227*^9, 
   3.85035378647199*^9, 3.850700150182294*^9, 3.850702782335181*^9, 
   3.850708160846946*^9, 3.8507310523372803`*^9, 3.8508312312082767`*^9, 
   3.851014127767761*^9, 3.8510829218734713`*^9, 3.851612307625265*^9, 
   3.893700732758712*^9},
 CellLabel->
  "Out[243]=",ExpressionUUID->"cde57549-661c-4882-acf9-ff93bf3526cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"CC", " ", 
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
     RowBox[{"g1", " ", "N2Split2"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2Split2"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"CC", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
     RowBox[{"g2", " ", "N1Split2"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2Split2"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.850098414021923*^9, 3.850098432101811*^9}, 
   3.850103856239477*^9, 3.850346332587731*^9, 3.850350633644227*^9, 
   3.85035378647199*^9, 3.850700150182294*^9, 3.850702782335181*^9, 
   3.850708160846946*^9, 3.8507310523372803`*^9, 3.8508312312082767`*^9, 
   3.851014127767761*^9, 3.8510829218734713`*^9, 3.851612307625265*^9, 
   3.8937007327896023`*^9},
 CellLabel->
  "Out[244]=",ExpressionUUID->"c83ba1ba-2328-4b92-ae3b-8311b97718da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"weightsILCCMBSplit1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit1noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit1noAInv", ".", "hvec"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCCMBSplit2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit2noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit2noAInv", ".", "hvec"}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8501038433425922`*^9, 3.850103852404508*^9}, {
  3.8507081686193647`*^9, 3.850708186218322*^9}, {3.8937007366608143`*^9, 
  3.893700745108939*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"0440ec80-8221-4948-9d5d-7b2e05a13bbf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"N2Split1", "+", 
     RowBox[{"g2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], 
    RowBox[{"N1Split1", "+", "N2Split1", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ",", 
   FractionBox[
    RowBox[{"N1Split1", "+", 
     RowBox[{"g1", " ", 
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], 
    RowBox[{"N1Split1", "+", "N2Split1", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.850103857010968*^9, 3.850346334582265*^9, 
  3.8503506348610373`*^9, 3.8503537877392607`*^9, 3.850700150227415*^9, 
  3.850702784641745*^9, 3.85070818680261*^9, 3.8507310550238953`*^9, 
  3.850831232903508*^9, 3.851014134330391*^9, 3.851082922974518*^9, 
  3.8516123098277082`*^9, 3.8937007455700808`*^9},
 CellLabel->
  "Out[245]=",ExpressionUUID->"f373d196-918c-4109-9d8f-ae66d6daf76d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"N2Split2", "+", 
     RowBox[{"g2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], 
    RowBox[{"N1Split2", "+", "N2Split2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ",", 
   FractionBox[
    RowBox[{"N1Split2", "+", 
     RowBox[{"g1", " ", 
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], 
    RowBox[{"N1Split2", "+", "N2Split2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.850103857010968*^9, 3.850346334582265*^9, 
  3.8503506348610373`*^9, 3.8503537877392607`*^9, 3.850700150227415*^9, 
  3.850702784641745*^9, 3.85070818680261*^9, 3.8507310550238953`*^9, 
  3.850831232903508*^9, 3.851014134330391*^9, 3.851082922974518*^9, 
  3.8516123098277082`*^9, 3.89370074559616*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"3b1bf2ec-ec02-44e5-9c13-954ef060ee63"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"now", " ", "we", " ", "need", " ", "the", " ", "cross"}], "-", 
     RowBox[{
     "power", " ", "spectrum", " ", "of", " ", "ymap1", " ", "and", " ", 
      "ymap2"}]}], ",", " ", 
    RowBox[{"Tmap1", " ", "and", " ", "Tmap2"}], ",", " ", "etc"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClijNoNoiseInv", "=", 
    RowBox[{"Inverse", "[", "ClijNoNoise", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8507028934055777`*^9, 3.85070291541721*^9}, {
  3.8507062994622183`*^9, 3.8507063365322313`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"2ce40ba6-77ff-44fa-a1cb-64d409f8b458"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClyyCross", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
   "weightsILCySplit1", ".", "ClijNoNoise", ".", "weightsILCySplit2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.850706214458373*^9, 3.8507062188413153`*^9}, {
  3.850706378190468*^9, 3.85070649119973*^9}, {3.850706859089498*^9, 
  3.850706866045746*^9}, {3.850708303257577*^9, 3.850708308879075*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"5e903483-298c-407c-90ac-3c4e16f1c6a5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Acmb", " ", "CC", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split1"}], "+", 
      RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split2"}], "+", 
      RowBox[{"g1", " ", "N2Split2"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}]}]], "+", 
  RowBox[{"Atsz", " ", "T"}]}]], "Output",
 CellChangeTimes->{{3.850706475084584*^9, 3.850706492519951*^9}, 
   3.850706869093253*^9, 3.850706933224616*^9, 3.850708309976894*^9, 
   3.850731252903427*^9, 3.850831247586746*^9, 3.851014183918715*^9, 
   3.851082934821041*^9, 3.851612323260528*^9, 3.89375415040003*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"9f6c4b1c-f3db-4b0e-b84e-23d7da0ec80f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "TT", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ClTTCross", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
    "weightsILCCMBSplit1", ".", "ClijNoNoise", ".", "weightsILCCMBSplit2"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.85070673085857*^9, 3.850706748076935*^9}, {
  3.850706943308916*^9, 3.85070695270888*^9}, {3.850706986709147*^9, 
  3.850706987749721*^9}, {3.8507084601212*^9, 3.850708463963833*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"017a879e-24ad-4c02-b8fb-f0e17fbf3732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Acmb", " ", "CC"}], "+", 
  FractionBox[
   RowBox[{"Atsz", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split1"}], "+", 
      RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split2"}], "+", 
      RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", "T"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"N1Split1", "+", "N2Split1", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"N1Split2", "+", "N2Split2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.850706950046365*^9, 3.850706953055402*^9}, 
   3.850706990504642*^9, 3.8507084650157337`*^9, 3.8507312590955067`*^9, 
   3.850831253053322*^9, 3.851014193485652*^9, 3.8510829373595877`*^9, 
   3.851612328061667*^9, 3.893754192734119*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"9183c6cb-9e28-4a26-a839-5e0ae709badd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "Ty"}], ",", " ", 
    RowBox[{
    "we", " ", "now", " ", "have", " ", "to", " ", "account", " ", "for", " ",
      "the", " ", "possible", " ", "difference", " ", "of", " ", "T_Split1", 
     " ", "x", " ", "y_Split2", " ", "and", " ", "T_split2", " ", "x", " ", 
     "y_Split1"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "these", " ", "will", " ", "be", " ", "equal", " ", "if", " ", "the", " ", 
    "noise", " ", "power", " ", "in", " ", "the", " ", "two", " ", "splits", 
    " ", "is", " ", "equal"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClTSplit1ySplit2Cross", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
     "weightsILCCMBSplit1", ".", "ClijNoNoise", ".", "weightsILCySplit2"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ClTSplit2ySplit1Cross", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
     "weightsILCCMBSplit2", ".", "ClijNoNoise", ".", "weightsILCySplit1"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8507069556222486`*^9, 3.850707010220037*^9}, {
  3.850708474018358*^9, 3.850708585520249*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"ebf5ecff-a778-422e-902e-b0c43dbc07a2"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Acmb", " ", "CC", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split2"}], "+", 
      RowBox[{"g1", " ", "N2Split2"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"CC", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
    RowBox[{
     SuperscriptBox["g1", "2"], " ", "N2Split2"}]}]], "+", 
  FractionBox[
   RowBox[{"Atsz", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split1"}], "+", 
      RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", "T"}], 
   RowBox[{"N1Split1", "+", "N2Split1", "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]]}]], "Output",
 CellChangeTimes->{3.850707011045348*^9, 3.850708588199362*^9, 
  3.850731261714222*^9, 3.8508312551429977`*^9, 3.8510141960067263`*^9, 
  3.851082940693899*^9, 3.851612329506381*^9, 3.893754198973465*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"ac2d32f3-1213-4f1c-9240-58caec4eee8a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Acmb", " ", "CC", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split1"}], "+", 
      RowBox[{"g1", " ", "N2Split1"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"CC", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
    RowBox[{
     SuperscriptBox["g1", "2"], " ", "N2Split1"}]}]], "+", 
  FractionBox[
   RowBox[{"Atsz", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1Split2"}], "+", 
      RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", "T"}], 
   RowBox[{"N1Split2", "+", "N2Split2", "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]]}]], "Output",
 CellChangeTimes->{3.850707011045348*^9, 3.850708588199362*^9, 
  3.850731261714222*^9, 3.8508312551429977`*^9, 3.8510141960067263`*^9, 
  3.851082940693899*^9, 3.851612329506381*^9, 3.8937541990427322`*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"a19f571f-898c-4710-9b2d-36dc8c9d0c78"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"NEED", " ", "TO", " ", "UPDATE", " ", "THE", " ", "FREQ"}], "-", 
    
    RowBox[{
    "FREQ", " ", "COV", " ", "MATRIX", " ", "TO", " ", "BE", " ", "CORRECT", 
     " ", "FOR", " ", "MEASUREMENTS", " ", "FROM", " ", "SPLITS"}]}], ",", 
   " ", 
   RowBox[{"I", ".", "E", "."}], ",", " ", 
   RowBox[{
    RowBox[{"ENTIRELY", " ", "CROSS"}], "-", 
    RowBox[{
     RowBox[{"SPECTRA", " ", "--"}], " ", "note", " ", "that", " ", "this", 
     " ", "means", " ", "the", " ", "150", "x90", " ", 
     RowBox[{"row", "/", "column"}], " ", "is", " ", "not", " ", "redundant", 
     " ", "now", " ", 
     RowBox[{"(", 
      RowBox[{
      "we", " ", "have", " ", "both", " ", "90", "_", "1", " ", "x", " ", 
       "150", "_", "2", " ", "and", " ", "150", "_", "1", " ", "x", " ", "90",
        "_", "2"}], ")"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850708652027328*^9, 3.850708670181693*^9}, {
   3.85070897239321*^9, 3.8507090118213778`*^9}, {3.850709169262329*^9, 
   3.850709205358961*^9}, 3.893757193785995*^9},
 CellLabel->
  "In[371]:=",ExpressionUUID->"5b898eea-17f6-4a1e-a531-c5fc3839954b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"first", ",", " ", 
    RowBox[{
     RowBox[{
     "construct", " ", "the", " ", "covariance", " ", "matrix", " ", "of", 
      " ", "the", " ", "auto"}], "-", " ", 
     RowBox[{"and", " ", "cross"}], "-", 
     RowBox[{"frequency", " ", "power", " ", "spectra"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "explicitly", " ", "include", " ", "150", "x90", " ", "terms", " ", "in", 
     " ", "power", " ", "spectrum", " ", "covariance", " ", "matrix"}], ",", 
    " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"it", " ", "is", " ", "a", " ", "4", "x4", " ", "matrix"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PScovFull", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "Nmodes"}], ")"}], "*", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"N1Split2", "+", "N1Split1"}], ")"}]}], "+", 
          RowBox[{"N1Split1", "*", "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N2Split2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N1Split1"}], " ", "+", " ", 
          RowBox[{"N1Split1", "*", "N2Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N1Split2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N2Split1"}], " ", "+", " ", 
          RowBox[{"N2Split1", "*", "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split1"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "^", "2"}]}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"N2Split2", "+", "N2Split1"}], ")"}]}], "+", 
          RowBox[{"N2Split1", "*", "N2Split2"}]}]}], "}"}]}], "}"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.850101781156426*^9, 3.850101947487274*^9}, {
   3.8501019960010643`*^9, 3.850102085096258*^9}, {3.850102119280776*^9, 
   3.850102143544561*^9}, {3.850102200267356*^9, 3.850102233136145*^9}, {
   3.850708837675036*^9, 3.850708892290057*^9}, {3.850731792784863*^9, 
   3.850731794159615*^9}, {3.8507567274435263`*^9, 3.850756741013809*^9}, {
   3.8507663531762743`*^9, 3.850766378399605*^9}, 3.850766428319909*^9, {
   3.850766822713735*^9, 3.8507668312077427`*^9}, 3.850766974907403*^9, {
   3.8507674522856092`*^9, 3.8507674797960653`*^9}, {3.850767822986814*^9, 
   3.85076785341654*^9}, {3.850768083176412*^9, 3.850768112360352*^9}, {
   3.850768212743967*^9, 3.8507682151891727`*^9}, 3.8507683427201643`*^9, {
   3.850768511393067*^9, 3.850768572454584*^9}, {3.8507687996958323`*^9, 
   3.850768817705638*^9}, {3.8507689230748463`*^9, 3.850768951144392*^9}, {
   3.850768981199883*^9, 3.8507690197499332`*^9}, 3.850769152098724*^9, 
   3.8507691959934387`*^9, {3.850769397574573*^9, 3.8507694496395903`*^9}, {
   3.850769639166727*^9, 3.850769662098054*^9}, 3.85076970990269*^9, {
   3.8507697418893633`*^9, 3.8507697688439293`*^9}, {3.8507698768634644`*^9, 
   3.850769906256014*^9}, {3.850770133369478*^9, 3.850770134294134*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Nmodes", "*", "PScovFull"}], "]"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.850102237454474*^9, 3.850102251601574*^9}, {
  3.8508279297930326`*^9, 3.850827933724401*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"78b6aedf-982d-4dbf-aa72-f05a013c3cca"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]},
     {
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.850700150320668*^9, 3.850733706814979*^9, 
  3.8507699182832336`*^9, 3.850827943307494*^9, 3.850831264970587*^9, 
  3.8510142141542187`*^9, 3.851082945986945*^9, 3.851612334853073*^9, 
  3.893754222627864*^9},
 CellLabel->
  "Out[265]//MatrixForm=",ExpressionUUID->"77cf4d70-f5b3-436b-9e6f-\
cec904a3555f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "we", " ", "are", " ", "really", " ", "representing", " ", "a", " ", 
      "four"}], "-", 
     RowBox[{"index", " ", "tensor"}]}], ",", " ", 
    RowBox[{
    "each", " ", "of", " ", "whose", " ", "indices", " ", "can", " ", "take", 
     " ", "2", " ", "values"}], ",", " ", 
    RowBox[{"as", " ", "a", " ", "4", "x4", " ", 
     RowBox[{"matrix", " ", "--"}], " ", "both", " ", "objects", " ", 
     "contain", " ", "16", " ", "elements"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "to", " ", "make", " ", "the", " ", "summ", "\[IndentingNewLine]", 
     "ation", " ", "in", " ", 
     RowBox[{"Eq", ".", " ", "87"}], " ", "straightforward"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "just", " ", "construct", " ", "the", 
      " ", "four"}], "-", 
     RowBox[{"index", " ", "tensor", " ", "explicitly"}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.850102297009666*^9, 3.850102300393331*^9}, {
   3.8501024445495653`*^9, 3.850102525922276*^9}, 3.851612336101012*^9},
 CellLabel->
  "In[732]:=",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PScovFullTensor", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.850102529406659*^9, 3.850102532963168*^9}, {
  3.850102635776206*^9, 3.850102680133873*^9}, {3.850102808164304*^9, 
  3.850102844743293*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850102822907016*^9, 3.850102881013631*^9}, {
  3.850102939548687*^9, 3.850103116470541*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"now", " ", "compute", " ", "the", " ", "sum", " ", "in", " ", 
    RowBox[{"Eq", ".", " ", "87"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{
     "covariance", " ", "of", " ", "ILC", " ", "CMB", " ", "map", " ", 
      "power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClCMBCMB", ",", "ClCMBCMB"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClTT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClTT", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClTT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8501037946230087`*^9, 3.850103826071932*^9}, {
   3.8501038894304457`*^9, 3.8501039043584013`*^9}, {3.8501039917138147`*^9, 
   3.850103993005377*^9}, {3.850346897053793*^9, 3.85034690273654*^9}, {
   3.850823390216325*^9, 3.850823401755418*^9}, {3.850823465582614*^9, 
   3.850823481769793*^9}, {3.8508240170617123`*^9, 3.850824024647163*^9}, {
   3.850825067742313*^9, 3.850825069040217*^9}, 3.851612346036056*^9, {
   3.8516123941624193`*^9, 3.8516124146099987`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], 
      "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"Nmodes", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", "N2Split1", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"], 
    " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", "N2Split2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"]}],
    ")"}]}]], "Output",
 CellChangeTimes->{3.851612427472568*^9, 3.893754241382566*^9},
 CellLabel->
  "Out[284]=",ExpressionUUID->"1fc52186-8333-43db-baea-6dc2b65a6b9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "ClCMBy"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClTy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClTy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClTy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104449157226*^9, 3.850104514135442*^9}, {
   3.8503469341668787`*^9, 3.850346935303865*^9}, {3.850824113507674*^9, 
   3.8508241681249638`*^9}, {3.8508246220771847`*^9, 3.850824626491391*^9}, 
   3.851612354114291*^9},
 CellLabel->
  "In[287]:=",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], 
      "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], " ", "Nmodes", 
    " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", "N2Split1", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"], 
    " ", 
    RowBox[{"(", 
     RowBox[{"N1Split2", "+", "N2Split2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.851612420034552*^9, 3.851612434690813*^9}, {
  3.893754252489944*^9, 3.8937542528333597`*^9}},
 CellLabel->
  "Out[288]=",ExpressionUUID->"b8d18760-d1d9-4123-92a0-9d07bf704777"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClyT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClyT", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClyT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104656964769*^9, 3.850104669523221*^9}, {
   3.850346944794262*^9, 3.850346953475602*^9}, {3.8508241857122498`*^9, 
   3.8508242110072737`*^9}, {3.850824637553503*^9, 3.850824641372036*^9}, {
   3.8508261555387*^9, 3.850826185972095*^9}, 3.8516124410887833`*^9},
 CellLabel->
  "In[289]:=",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], 
      "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], 
      "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], " ", "Nmodes", 
    " ", 
    RowBox[{"(", 
     RowBox[{"N1Split1", "+", "N2Split1", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", "N2Split2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"]}],
    ")"}]}]], "Output",
 CellChangeTimes->{3.8516124554373198`*^9, 3.893754265219051*^9},
 CellLabel->
  "Out[290]=",ExpressionUUID->"67d9b46e-bdc3-4397-a130-8eda4dbfe7bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "Clyy"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8508242390013123`*^9, 3.850824258407641*^9}, {
   3.850824650486883*^9, 3.8508246553975763`*^9}, 3.8516124434294863`*^9},
 CellLabel->
  "In[291]:=",ExpressionUUID->"91c2cf13-d95a-403a-819f-42d53ea2dba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], " ", "Nmodes", 
    " ", 
    RowBox[{"(", 
     RowBox[{"N1Split1", "+", "N2Split1", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"N1Split2", "+", "N2Split2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.85161246517095*^9, 3.8937542755157337`*^9},
 CellLabel->
  "Out[292]=",ExpressionUUID->"c86ecb6f-3fa1-4c99-9d8b-0d6b2c37e598"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBy", ",", "ClCMBCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClTyClTT", " ", "=", " ", "CovClTTClTy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824305693244*^9, 3.8508243323746567`*^9}, {
   3.850824667385872*^9, 3.85082467167284*^9}, 3.8516124486802607`*^9},
 CellLabel->
  "In[293]:=",ExpressionUUID->"d1a0375d-b2ec-4c7c-a505-75632fbc2e83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{
     "covariance", " ", "of", " ", "ILC", " ", "CMB", " ", "map", " ", "x", 
      " ", "y"}], "-", 
     RowBox[{"map", " ", "cross"}], "-", 
     RowBox[{"power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClCMBy", ",", "ClCMBy"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTyClTy", "=", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTyClTy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTyClTy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824343692913*^9, 3.850824377554647*^9}, 
   3.850824487500639*^9, 3.851082960368474*^9, 3.8516124630543337`*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"988997b5-45d0-46b5-9d35-ed0d56506ba2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], 
      "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split1", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split1", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], "2"], " ", 
    "Nmodes", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", "N2Split1", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"]}],
    ")"}]}]], "Output",
 CellChangeTimes->{3.851612475241619*^9, 3.893754288354505*^9},
 CellLabel->
  "Out[295]=",ExpressionUUID->"ec5fb244-8e01-4267-b638-164badbbbc2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBy", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTyClyT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTyClyT", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTyClyT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824394954919*^9, 3.850824421462598*^9}, {
   3.8508246833984613`*^9, 3.8508246875701723`*^9}, 3.8516124697749147`*^9},
 CellLabel->
  "In[296]:=",ExpressionUUID->"4805e1a6-9b6c-45e8-a9e3-bde8d5c28b62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], " ", "Nmodes", 
    " ", 
    RowBox[{"(", 
     RowBox[{"N1Split1", "+", "N2Split1", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"N1Split2", "+", "N2Split2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.851612485494302*^9, 3.8937543006301823`*^9},
 CellLabel->
  "Out[297]=",ExpressionUUID->"05475ffa-4d21-479b-bfdb-97f6b11da9c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBy", ",", "Clyy"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"CovClTyClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTyClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTyClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104715447761*^9, 3.850104746702614*^9}, {
   3.850346965296616*^9, 3.8503469672360687`*^9}, {3.850824568568404*^9, 
   3.850824590853876*^9}, {3.8508247172129927`*^9, 3.85082474396586*^9}, 
   3.8508247816173697`*^9, 3.85161247222323*^9},
 CellLabel->
  "In[298]:=",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split1", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], "2"], " ", 
    "Nmodes", " ", 
    RowBox[{"(", 
     RowBox[{"N1Split1", "+", "N2Split1", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.851612494851988*^9, 3.893754313042659*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"7e73f795-f059-4ab7-a568-6232255672ae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "ClCMBCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClyTClTT", " ", "=", " ", "CovClTTClyT"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850346639884039*^9, 3.850346655786344*^9}, {
  3.850346693917186*^9, 3.850346726784639*^9}, {3.8503474122585173`*^9, 
  3.850347413227049*^9}, {3.850824775304427*^9, 3.850824814089739*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"da09e2b5-a7b4-49bf-9f2b-a1e96746c6fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "ClCMBy"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClyTClTy", " ", "=", " ", "CovClTyClyT"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824821104742*^9, 3.850824847001371*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"afc0ed14-2e84-4db2-b204-d5148e7a1f7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyTClyT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyTClyT", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyTClyT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824857564348*^9, 3.8508248858960543`*^9}, 
   3.851612479196785*^9},
 CellLabel->
  "In[302]:=",ExpressionUUID->"c8b78761-42fe-46bb-920b-b13a77ea2368"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], 
      "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N2Split2", "+", 
        RowBox[{"g2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1Split2", "+", 
        RowBox[{"g1", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], "2"], " ", 
    "Nmodes", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", "N2Split2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"]}],
    ")"}]}]], "Output",
 CellChangeTimes->{3.851612506425692*^9, 3.893754326544507*^9},
 CellLabel->
  "Out[303]=",ExpressionUUID->"c40b30b5-897e-4742-bef2-1e12986bd174"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "Clyy"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"CovClyTClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyTClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyTClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824916457693*^9, 3.850824932453846*^9}, 
   3.8516124810348473`*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"3993c42b-0302-4e21-9400-788471ac28ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N2Split2", "+", 
       RowBox[{"g2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", 
       RowBox[{"g1", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], " ", "Nmodes", 
    " ", 
    RowBox[{"(", 
     RowBox[{"N1Split2", "+", "N2Split2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.8516125142015877`*^9, 3.893754338666923*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"65413a0f-811b-4b88-ac4d-4c3e8bad83c0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClCMBCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClyyClTT", " ", "=", " ", "CovClTTClyy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824943262641*^9, 3.850824959316062*^9}, {
  3.850825012659877*^9, 3.8508250142859497`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"ce94caec-2e68-41a4-b870-6d2a25617e9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClCMBy"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"CovClyyClTy", " ", "=", " ", "CovClTyClyy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8508249747217484`*^9, 3.8508250109290953`*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"7d3e4827-8c5a-40f5-b971-4d8b6f218c4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClyCMB"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"CovClyyClyT", " ", "=", " ", "CovClyTClyy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824988058978*^9, 3.850825008983264*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"8df78459-b30b-4fb9-b63e-f675b16d5800"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{"covariance", " ", "of", " ", "the", " ", "ILC", " ", "y"}], "-", 
     RowBox[{"map", " ", "power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"Clyy", ",", "Clyy"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyyClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyyClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyyClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850825049139883*^9, 3.850825051751254*^9}, 
   3.850825095639102*^9, 3.8516124897751303`*^9},
 CellLabel->
  "In[309]:=",ExpressionUUID->"2ce421c4-d370-4876-9cc8-d8ea9d613286"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N1Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"CC", "+", 
       RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "CC"}], "+", "N2Split2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N1Split1", " ", "N1Split2"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "N1Split1", "+", "N1Split2"}], ")"}], " ", "T"}]}],
       ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
       RowBox[{"g2", " ", "N1Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N2Split1", " ", "N2Split2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", "N2Split2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"CC", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"CC", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], ")"}]}],
     "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split1"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split2"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split2", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split2", "+", "N2Split1", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
        RowBox[{"g2", " ", "N1Split2"}]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
        RowBox[{"g1", " ", "N2Split1"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["CC", "2"]}], "+", 
       RowBox[{"N1Split1", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{"N2Split2", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1Split1", "+", "N2Split2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "+", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}], "2"], " ", 
    "Nmodes"}], ")"}]}]], "Output",
 CellChangeTimes->{3.851612527509688*^9, 3.893754354419591*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"869a6416-2ff5-4142-b438-5cdcb66c55d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "derivatives", " ", "of", " ", "ClTT"}], ",", 
    " ", "ClTy", ",", " ", "ClyT", ",", " ", 
    RowBox[{
    "and", " ", "Clyy", " ", "with", " ", "respect", " ", "to", " ", "Acmb", 
     " ", "and", " ", "Atsz"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTTCross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTTCross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit1ySplit2Cross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit1ySplit2Cross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit2ySplit1Cross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit2ySplit1Cross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClyyCross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClyyCross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", " ", "derivClTTAcmb", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyTAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"derivAcmb", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAcmb", ",", " ", "derivClTyAcmb", ",", " ", "derivClyTAcmb", 
      ",", " ", "derivClyyAcmb"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"derivAtsz", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAtsz", ",", " ", "derivClTyAtsz", ",", " ", "derivClyTAtsz", 
      ",", " ", "derivClyyAtsz"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.85083183620432*^9, {3.851014255180688*^9, 3.851014288628635*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"fecf5d0e-3695-4c48-8a46-d277432bced8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"CC", ",", 
   FractionBox[
    RowBox[{"CC", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split2"}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2Split2"}]}]], ",", 
   FractionBox[
    RowBox[{"CC", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split1"}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2Split1"}]}]], ",", 
   FractionBox[
    RowBox[{"CC", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split1"}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split2"}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split1"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1Split2"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2Split2"}]}], ")"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8508318409465218`*^9, 3.8510144159240093`*^9, 3.8510830573478603`*^9, {
   3.8937543545828*^9, 3.8937543546248293`*^9}},
 CellLabel->
  "Out[345]=",ExpressionUUID->"1bf6d6f0-5e1b-4611-9213-d700ca86d6f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split1"}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split2"}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", "T"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"N1Split1", "+", "N2Split1", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"N1Split2", "+", "N2Split2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split1"}], "+", 
       RowBox[{"g1", " ", "N2Split1"}]}], ")"}], " ", "T"}], 
    RowBox[{"N1Split1", "+", "N2Split1", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1Split2"}], "+", 
       RowBox[{"g1", " ", "N2Split2"}]}], ")"}], " ", "T"}], 
    RowBox[{"N1Split2", "+", "N2Split2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ",", "T"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8508318409465218`*^9, 3.8510144159240093`*^9, 3.8510830573478603`*^9, {
   3.8937543545828*^9, 3.893754354627685*^9}},
 CellLabel->
  "Out[346]=",ExpressionUUID->"44bde63e-62a5-4d57-904f-674847f75d42"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Run", " ", "cell", " ", "below", " ", "to", " ", "set", " ", "numerical", 
    " ", "values"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "using", " ", "numerical", " ", "values", " ", "from", " ", "fgspectra", 
    " ", "and", " ", "CLASS", " ", "in", " ", "python", " ", "code", " ", 
    RowBox[{"(", 
     RowBox[{"ell", "=", 
      RowBox[{"1500", " ", "here"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CC", "=", "0.0019252172031626088"}], ";", " ", 
   RowBox[{"T", "=", 
    RowBox[{"1.4575172568790597", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "18"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"g1", "=", 
    RowBox[{"-", "4356390.851902919"}]}], ";", " ", 
   RowBox[{"g2", "=", 
    RowBox[{"-", "2599711.593181207"}]}], ";", " ", 
   RowBox[{"N1Split1", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"N1Split2", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", "  ", 
   RowBox[{"N2Split1", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"N2Split2", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"Nmodes", "=", "3001"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8937571397771177`*^9, 3.8937571433700037`*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"0b2e61ff-d8f9-4676-929f-e1cd906f54ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Construct", " ", "Cov_", 
    RowBox[{"{", 
     RowBox[{"ab", ",", "cd"}], "}"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"matrix", " ", "where", " ", "Cov_", 
        RowBox[{"{", 
         RowBox[{"ab", ",", "cd"}], "}"}]}], "=", " ", 
       RowBox[{
        RowBox[{"sigma", "^", "2"}], "_", 
        RowBox[{"{", 
         RowBox[{"Cl", "^", 
          RowBox[{"{", 
           RowBox[{"ab", ",", "cd"}], "}"}]}], "}"}], " ", "where", " ", "ab",
         " ", "and", " ", "cd", " ", "are", " ", "either", " ", "TT"}]}], ",",
       " ", "Ty", ",", " ", "yT", ",", " ", 
      RowBox[{"or", " ", "yy"}]}], ")"}], " ", "as", " ", "4", "x4", " ", 
    "matrix", " ", "and", " ", "find", " ", "its", " ", "inverse"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Covabcd", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "CovClTTClTT", ",", " ", "CovClTTClTy", ",", " ", "CovClTTClyT", ",", 
         " ", "CovClTTClyy"}], " ", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClTyClTT", ",", " ", "CovClTyClTy", ",", " ", "CovClTyClyT", ",", 
         " ", "CovClTyClyy"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClyTClTT", ",", " ", "CovClyTClTy", ",", " ", "CovClyTClyT", ",", 
         " ", "CovClyTClyy"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "CovClyyClTT", ",", " ", "CovClyyClTy", ",", " ", "CovClyyClyT", ",", 
         " ", "CovClyyClyy"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CovabcdInv", " ", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "Covabcd", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "CovabcdInv", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.85034761163262*^9, 3.850347627086789*^9}, {
   3.8503476620760183`*^9, 3.8503477074779863`*^9}, {3.850347738235574*^9, 
   3.850347827652006*^9}, {3.8503490303809557`*^9, 3.8503490480026217`*^9}, {
   3.850349554687873*^9, 3.850349555120212*^9}, {3.8504038756406727`*^9, 
   3.850403889498209*^9}, {3.850516671388743*^9, 3.850516713436687*^9}, {
   3.8508251087274847`*^9, 3.850825231436008*^9}, {3.850826208381007*^9, 
   3.850826211228496*^9}, {3.850829131947513*^9, 3.850829137268963*^9}, {
   3.85101474929978*^9, 3.851014754650137*^9}, {3.8510153674301767`*^9, 
   3.851015371038816*^9}, {3.851019277861575*^9, 3.851019279652872*^9}, {
   3.8510876524250517`*^9, 3.851087658758934*^9}, 3.893757037445972*^9},
 CellLabel->
  "In[351]:=",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],

Cell[BoxData[
 TemplateBox[{
  "Inverse", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"Inverse\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"5.039705740988908`*^-6\\\", \\\",\\\", \
\\\"2.042817219965008`*^-12\\\", \\\",\\\", \\\"2.042817219965008`*^-12\\\", \
\\\",\\\", \\\"8.284513409703833`*^-19\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.042817219965008`*^-12\\\", \\\",\\\", \
\\\"8.284523139761061`*^-19\\\", \\\",\\\", \\\"8.28452275977814`*^-19\\\", \
\\\",\\\", \\\"3.3597303112015305`*^-25\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.042817219965008`*^-12\\\", \\\",\\\", \
\\\"8.28452275977814`*^-19\\\", \\\",\\\", \\\"8.284523139761061`*^-19\\\", \
\\\",\\\", \\\"3.3597303112015305`*^-25\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8.284513409703833`*^-19\\\", \\\",\\\", \
\\\"3.3597303112015305`*^-25\\\", \\\",\\\", \
\\\"3.3597303112015305`*^-25\\\", \\\",\\\", \
\\\"1.3625167042143473`*^-31\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"", 2, 352, 1, 21878786105659783113, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8937570511289186`*^9},
 CellLabel->
  "During evaluation of \
In[351]:=",ExpressionUUID->"d0d35168-d19c-441c-926b-6b2b4a0409be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"4.04688797883137`*^8", "7.633312420151838`*^13", 
      "7.633312420218262`*^13", 
      RowBox[{"-", "2.8370787551614405`*^21"}]},
     {"7.6333124157952`*^13", "1.3417701621281022`*^25", 
      RowBox[{"-", "1.2899270621850934`*^25"}], 
      RowBox[{"-", "1.2788252213371404`*^30"}]},
     {"7.6333124159296`*^13", 
      RowBox[{"-", "1.2899270621850895`*^25"}], "1.3417701621280951`*^25", 
      RowBox[{"-", "1.2788252213370675`*^30"}]},
     {
      RowBox[{"-", "2.837078754949157`*^21"}], 
      RowBox[{"-", "1.2788252213374937`*^30"}], 
      RowBox[{"-", "1.2788252213372378`*^30"}], "6.323980842253617`*^36"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.850825227795432*^9, 3.850826013816087*^9, 3.850826124824218*^9, 
   3.850826169324493*^9, 3.850826212289003*^9, {3.850829124620482*^9, 
   3.850829138485471*^9}, 3.850831635328135*^9, 3.85083174741803*^9, 
   3.850831790301549*^9, 3.8508318508667793`*^9, 3.851014506239451*^9, 
   3.851014589467422*^9, {3.8510147449500093`*^9, 3.85101475700937*^9}, {
   3.851019273508946*^9, 3.851019282003577*^9}, 3.851019400161943*^9, 
   3.851083057455346*^9, {3.851087647309947*^9, 3.851087678205822*^9}, 
   3.851087743134012*^9, {3.851087796181638*^9, 3.851087932200696*^9}, 
   3.8510879844405537`*^9, {3.851088049069518*^9, 3.851088183949627*^9}, 
   3.893757005224621*^9, 3.893757051192397*^9},
 CellLabel->
  "Out[353]//MatrixForm=",ExpressionUUID->"3a9964eb-8ee4-4292-9486-\
63a36d27233c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.850347886751474*^9, 3.850347889919529*^9}, {
   3.8503479423667583`*^9, 3.850347961952983*^9}, 3.850348874702314*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"232db559-e251-4f2c-8987-b55ed3449b19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "Fisher", " ", "matrix", " ", "from", " ", "ILC", " ", 
    "approach", " ", "as", " ", "in", " ", "eq", ".99"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FisherAcmb", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAtsz", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbAtsz", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fisher", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"FisherAcmb", ",", " ", "FisherAcmbAtsz"}], "}"}], ",", " ", 
        
        RowBox[{"{", 
         RowBox[{"FisherAcmbAtsz", ",", " ", "FisherAtsz"}], "}"}]}], "}"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85034950498853*^9, 3.850349509828374*^9}, {
   3.850349574858923*^9, 3.850349597911985*^9}, {3.8503501515145063`*^9, 
   3.850350174863008*^9}, {3.850517816131082*^9, 3.8505178194977922`*^9}, {
   3.850771674560911*^9, 3.850771714825515*^9}, {3.851014797646678*^9, 
   3.851014799941732*^9}, {3.8510154513053293`*^9, 3.851015465448802*^9}, 
   3.851016028595449*^9, {3.851088185203498*^9, 3.851088185256936*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "final", " ", "covariance", " ", "matrix", " ", "from", 
    " ", "ILC", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovILC", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Inverse", "[", "Fisher", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovILC", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850349516022242*^9, 3.850349626346944*^9}, {
   3.850350209246752*^9, 3.850350218842215*^9}, {3.8503502589937963`*^9, 
   3.8503502599082937`*^9}, {3.85035083617115*^9, 3.85035084700953*^9}, {
   3.8503538388738003`*^9, 3.850353845960312*^9}, {3.850360123321699*^9, 
   3.850360130483348*^9}, {3.850733679149158*^9, 3.850733680874502*^9}, 
   3.850733764863978*^9, {3.851014815491434*^9, 3.851014817094797*^9}, {
   3.8510154835380983`*^9, 3.8510154868038597`*^9}, 3.8510881582325583`*^9},
 CellLabel->
  "In[358]:=",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0006682618413859123`", "0.0003219581850278159`"},
     {"0.0003219581850278159`", "0.06710600009867226`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.850353846350346*^9, 3.850360143502346*^9, 3.8507001678125362`*^9, 
   3.850733682107767*^9, {3.8507337739044027`*^9, 3.8507337816951523`*^9}, 
   3.850826221712088*^9, 3.850830846231883*^9, 3.850831646235962*^9, 
   3.850831753199114*^9, 3.850831856076528*^9, 3.851014510622213*^9, 
   3.851014592930264*^9, 3.851014812623289*^9, 3.851014842852682*^9, 
   3.851083057505495*^9, 3.851087746480258*^9, {3.851087799369348*^9, 
   3.8510879378845453`*^9}, 3.851087987253676*^9, {3.8510880519348097`*^9, 
   3.8510881890454607`*^9}, 3.893757071278162*^9},
 CellLabel->
  "Out[359]//MatrixForm=",ExpressionUUID->"35c792f8-55b0-450a-b0fc-\
40a1640840ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Begin", " ", "multifrequency", " ", "template", " ", "fitting", " ", 
    "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "inverse", " ", "of", " ", "power", " ", "spectrum", " ", 
    "covariance", " ", "matrix", " ", 
    RowBox[{"Clij", "^", 
     RowBox[{"-", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PScovInv", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Inverse", "[", "PScovFull", "]"}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8503496400147123`*^9, 3.850349654350348*^9}, {
   3.8503497908572073`*^9, 3.8503497978710814`*^9}, {3.850349878403522*^9, 
   3.850349886056686*^9}, {3.85034993506516*^9, 3.850350027390441*^9}, {
   3.850350081207139*^9, 3.850350085493299*^9}, {3.850354087923471*^9, 
   3.850354094474616*^9}, {3.850354125284993*^9, 3.850354161519226*^9}, {
   3.850354210567197*^9, 3.850354224528007*^9}, {3.850354292756077*^9, 
   3.850354295342491*^9}, {3.850354361218829*^9, 3.850354362650098*^9}, {
   3.850355512960595*^9, 3.850355517830956*^9}, {3.850355592082144*^9, 
   3.8503556945546837`*^9}, {3.8503558183935328`*^9, 
   3.8503558213751707`*^9}, {3.850355862239695*^9, 3.850355862571498*^9}, {
   3.8503564617574*^9, 3.850356464796698*^9}, {3.850358682822667*^9, 
   3.8503587488098993`*^9}, {3.850358794002527*^9, 3.850358832500148*^9}, {
   3.850358866527831*^9, 3.850358912497348*^9}, 3.850359117661935*^9, {
   3.8503602492888603`*^9, 3.850360251119399*^9}, {3.850360284619053*^9, 
   3.850360484061838*^9}, {3.8503905177758913`*^9, 3.850390577682815*^9}, {
   3.850392744514257*^9, 3.850392748281014*^9}, {3.850392826907902*^9, 
   3.8503928482054653`*^9}, {3.8503942427038937`*^9, 3.850394263038974*^9}, {
   3.850399164204639*^9, 3.850399230813457*^9}, {3.8503995291376123`*^9, 
   3.850399543546097*^9}, {3.850399629073423*^9, 3.850399631962167*^9}, {
   3.8503996822963457`*^9, 3.850399688602214*^9}, {3.85039972404904*^9, 
   3.850399725387488*^9}, {3.8504002795194407`*^9, 3.8504003088129787`*^9}, {
   3.850518950334333*^9, 3.850518952616405*^9}, {3.850733555531424*^9, 
   3.8507335605151854`*^9}, {3.850770327055221*^9, 3.8507703312950974`*^9}, {
   3.850771922347678*^9, 3.850771924641581*^9}},
 CellLabel->
  "In[360]:=",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"769856.529311885`", ",", 
     RowBox[{"-", "772486.268427175`"}], ",", 
     RowBox[{"-", "772486.2684283084`"}], ",", "775124.9899981992`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "772486.268427968`"}], ",", "4.348832677187212`*^12", ",", 
     RowBox[{"-", "4.17899850895503`*^12"}], ",", 
     RowBox[{"-", "1.704136031314329`*^11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "772486.2684277892`"}], ",", 
     RowBox[{"-", "4.178998508954946`*^12"}], ",", "4.3488326771873022`*^12", 
     ",", 
     RowBox[{"-", "1.7041360313160834`*^11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"775124.9899982214`", ",", 
     RowBox[{"-", "1.7041360313151755`*^11"}], ",", 
     RowBox[{"-", "1.7041360313152365`*^11"}], ",", 
     "3.423915139311366`*^11"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.850772012620133*^9, 3.850826227249495*^9, 
  3.850830863074081*^9, 3.8508316560323687`*^9, 3.850831758975706*^9, 
  3.850831858156947*^9, 3.851014522404776*^9, 3.851014594872903*^9, 
  3.851014880334556*^9, 3.851083057533184*^9, 3.8937570739040537`*^9},
 CellLabel->
  "Out[360]=",ExpressionUUID->"f56d66a7-d524-4d82-8f98-18b52db29b2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Find", " ", "K_", 
    RowBox[{"{", 
     RowBox[{"alpha", ",", "beta"}], "}"}], " ", "from", " ", "eq", ".63", 
    " ", "by", " ", "summing", " ", "over", " ", "each", " ", "term", " ", 
    "of", " ", "PScovInv", " ", 
    RowBox[{"once", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KCMBCMB", " ", "=", " ", 
     RowBox[{
      RowBox[{"CC", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KCMBtSZ", " ", "=", " ", 
     RowBox[{"CC", "*", "T", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], "+",
         " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KtSZtSZ", " ", "=", " ", 
     RowBox[{
      RowBox[{"T", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], "+",
         " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], "+",
         " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KCMBCMB", ",", " ", "KCMBtSZ"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"KCMBtSZ", ",", " ", "KtSZtSZ"}], "}"}]}], "}"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8505198656666327`*^9, 3.850520162743334*^9}, {
   3.850520321814958*^9, 3.850520376883337*^9}, {3.8505206038216343`*^9, 
   3.85052067353691*^9}, {3.850520806532054*^9, 3.850520909483322*^9}, {
   3.85073357357976*^9, 3.850733622860013*^9}, {3.850770353217812*^9, 
   3.850770406891032*^9}, {3.8507708032485313`*^9, 3.850770985565879*^9}, {
   3.850772024644278*^9, 3.850772030791041*^9}, {3.850772073733844*^9, 
   3.85077208350599*^9}, 3.850772234339122*^9, {3.850826252965376*^9, 
   3.85082644940425*^9}},
 CellLabel->
  "In[361]:=",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1499.8863879966775`", ",", 
     RowBox[{"-", "7.196088256105546`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.196088256105546`"}], ",", "14.936322207912072`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.850401023634108*^9, 3.85040105124445*^9}, 
   3.850519055353265*^9, 3.850519788957335*^9, 3.85051984854074*^9, 
   3.8505199048615303`*^9, {3.850520141264155*^9, 3.8505201633692827`*^9}, 
   3.850520377741729*^9, 3.850520674323449*^9, {3.8505208968760567`*^9, 
   3.850520910137289*^9}, 3.850700168998295*^9, 3.8507336239812307`*^9, 
   3.8507337866699266`*^9, 3.850772068754395*^9, 3.850772239450596*^9, 
   3.850772467417974*^9, 3.850826229909732*^9, 3.850826477358424*^9, 
   3.8508310529011297`*^9, 3.850831659156024*^9, 3.850831859740365*^9, 
   3.8510145240996*^9, 3.851014596706596*^9, 3.8510150433003407`*^9, 
   3.851083057564993*^9, 3.893757076022375*^9},
 CellLabel->
  "Out[364]=",ExpressionUUID->"52644081-8ab3-4f7e-b86c-c1af48466c32"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "final", " ", "covariance", " ", "matrix", " ", "from", " ", 
    "template", " ", "fitting", " ", "approach", " ", "using", " ", "eq", 
    ".67"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovTemplateFitting", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Inverse", "[", "K", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovTemplateFitting", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850351206483547*^9, 3.8503512632120237`*^9}, {
   3.850360500871291*^9, 3.8503605209466867`*^9}, {3.8503605644973173`*^9, 
   3.850360567881268*^9}, {3.850518523986722*^9, 3.8505185287438593`*^9}, {
   3.850520397410143*^9, 3.850520397624772*^9}, {3.8505220180807*^9, 
   3.8505220242855*^9}, {3.850733628011723*^9, 3.850733628699942*^9}, 
   3.851015198548562*^9},
 CellLabel->
  "In[365]:=",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0006682618413871091`", "0.00032195818501169494`"},
     {"0.00032195818501169494`", "0.0671060000957379`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.850518559897901*^9, 3.850518576473302*^9}, 
   3.85052039918539*^9, 3.85052068330338*^9, 3.850520921982512*^9, 
   3.8505220265429173`*^9, 3.850700170101645*^9, 3.85073363290583*^9, 
   3.850733789995717*^9, 3.850826232758966*^9, 3.8508264799654207`*^9, 
   3.850831056487501*^9, 3.850831661583827*^9, 3.850831861583618*^9, 
   3.851014526690792*^9, 3.851014598424509*^9, 3.851015224334738*^9, 
   3.851083057593631*^9, 3.893757077877886*^9},
 CellLabel->
  "Out[366]//MatrixForm=",ExpressionUUID->"95cf328e-aa77-4d7e-999f-\
031cf0032066"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Subtract", " ", "final", " ", "covariance", " ", "for", " ", 
    "TemplateFitting", " ", "from", " ", "that", " ", "for", " ", "ILC"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"FinalCovILC", "-", "FinalCovTemplateFitting"}], "]"}], " ", "//",
    "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.850351271104641*^9, 3.850351296476169*^9}, {
  3.850355875846406*^9, 3.850355905899435*^9}, {3.850360545180888*^9, 
  3.8503605498940563`*^9}, {3.850360672509582*^9, 3.850360678869467*^9}, {
  3.850518617440613*^9, 3.850518631620695*^9}, {3.85051873631888*^9, 
  3.850518751618104*^9}, {3.850520457595566*^9, 3.850520482106653*^9}, {
  3.850520556251568*^9, 3.850520562191472*^9}, {3.8505207309376583`*^9, 
  3.850520736040427*^9}, {3.8505212461870737`*^9, 3.85052124648522*^9}, {
  3.850522102804269*^9, 3.8505221193104477`*^9}, {3.8507336453302402`*^9, 
  3.850733648739531*^9}, {3.850831138284753*^9, 3.85083115512575*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.1968507782067483`*^-15"}], "1.612094789257834`*^-14"},
     {"1.612094789257834`*^-14", "2.934361087447712`*^-12"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.850355906809094*^9, 3.850360495190134*^9, 3.850360574719036*^9, 
   3.85036061346474*^9, 3.850360962706068*^9, 3.8505189485289803`*^9, 
   3.850518997773788*^9, 3.8505190320029907`*^9, 3.850520445552864*^9, 
   3.8505204859194727`*^9, 3.850520566307926*^9, 3.8505207400199413`*^9, 
   3.8505212525933867`*^9, 3.85052203449234*^9, {3.8505221123532267`*^9, 
   3.8505221214016247`*^9}, 3.850700171639481*^9, 3.850733805063038*^9, 
   3.850826521849359*^9, 3.850831155845313*^9, 3.850831668834528*^9, 
   3.851014553086678*^9, 3.851015358974635*^9, 3.851083057653551*^9, 
   3.893757084411297*^9},
 CellLabel->
  "Out[369]//MatrixForm=",ExpressionUUID->"0744ead1-7dcc-4407-8f6f-\
82f336c824bc"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8508259432881393`*^9, 3.850826032700458*^9}, {
   3.850826090183419*^9, 3.850826096670219*^9}, {3.850831615386931*^9, 
   3.8508316277825003`*^9}, {3.85083197255822*^9, 3.850831975671237*^9}, {
   3.851014490001354*^9, 3.8510144903890657`*^9}, {3.8510145728706627`*^9, 
   3.851014576583416*^9}, 
   3.893757016554882*^9},ExpressionUUID->"31ff794c-f505-471d-8a56-\
21f4c54fa7e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Run", " ", "cell", " ", "below", " ", "to", " ", "clear", " ", 
    "numerical", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "CC", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "T", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "g1", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "g2", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N1Split1", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N1Split2", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N2Split1", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N2Split2", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "Nmodes", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8508260238458023`*^9, 3.850826114090095*^9}, {
   3.850831967738297*^9, 3.850831982983984*^9}, 3.8510140695405827`*^9},
 CellLabel->
  "In[698]:=",ExpressionUUID->"7f8e5ec9-b8df-4a2a-80a8-16f73dc6afc2"]
},
WindowSize->{1342, 730},
WindowMargins->{{Automatic, 6}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"839a2295-dbf7-4c58-9138-edbdf0665a83"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2543, 60, 115, "Input",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],
Cell[CellGroupData[{
Cell[3126, 84, 3289, 94, 165, "Input",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],
Cell[6418, 180, 1549, 39, 69, "Output",ExpressionUUID->"8281df5d-438d-486a-b2cf-280097f104b5"],
Cell[7970, 221, 1550, 39, 69, "Output",ExpressionUUID->"4a97b2af-3ffa-4af0-8d10-40cc4588e620"]
}, Open  ]],
Cell[9535, 263, 805, 20, 94, "Input",ExpressionUUID->"2f9d2e15-0d49-4cdb-bf16-a4240c685d25"],
Cell[CellGroupData[{
Cell[10365, 287, 1771, 47, 75, "Input",ExpressionUUID->"0bb951f3-b1d8-4f5f-8b7f-9906015e0846"],
Cell[12139, 336, 1295, 36, 69, "Output",ExpressionUUID->"0c08977c-e6d4-4692-bc65-fe37f9e61555"]
}, Open  ]],
Cell[13449, 375, 515, 15, 52, "Input",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],
Cell[13967, 392, 549, 13, 30, "Input",ExpressionUUID->"ed802296-cd4f-4f6b-80ba-47a10560f486"],
Cell[CellGroupData[{
Cell[14541, 409, 863, 21, 52, "Input",ExpressionUUID->"aae96ca5-3198-45e6-9d92-3d79d37e4666"],
Cell[15407, 432, 1433, 41, 55, "Output",ExpressionUUID->"cde57549-661c-4882-acf9-ff93bf3526cc"],
Cell[16843, 475, 1435, 41, 55, "Output",ExpressionUUID->"c83ba1ba-2328-4b92-ae3b-8311b97718da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18315, 521, 826, 21, 52, "Input",ExpressionUUID->"0440ec80-8221-4948-9d5d-7b2e05a13bbf"],
Cell[19144, 544, 1130, 31, 55, "Output",ExpressionUUID->"f373d196-918c-4109-9d8f-ae66d6daf76d"],
Cell[20277, 577, 1127, 31, 55, "Output",ExpressionUUID->"3b1bf2ec-ec02-44e5-9c13-954ef060ee63"]
}, Open  ]],
Cell[21419, 611, 684, 17, 52, "Input",ExpressionUUID->"2ce40ba6-77ff-44fa-a1cb-64d409f8b458"],
Cell[CellGroupData[{
Cell[22128, 632, 474, 10, 30, "Input",ExpressionUUID->"5e903483-298c-407c-90ac-3c4e16f1c6a5"],
Cell[22605, 644, 1383, 39, 57, "Output",ExpressionUUID->"9f6c4b1c-f3db-4b0e-b84e-23d7da0ec80f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24025, 688, 544, 12, 52, "Input",ExpressionUUID->"017a879e-24ad-4c02-b8fb-f0e17fbf3732"],
Cell[24572, 702, 1144, 32, 57, "Output",ExpressionUUID->"9183c6cb-9e28-4a26-a839-5e0ae709badd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25753, 739, 1255, 29, 94, "Input",ExpressionUUID->"ebf5ecff-a778-422e-902e-b0c43dbc07a2"],
Cell[27011, 770, 1119, 32, 55, "Output",ExpressionUUID->"ac2d32f3-1213-4f1c-9240-58caec4eee8a"],
Cell[28133, 804, 1121, 32, 55, "Output",ExpressionUUID->"a19f571f-898c-4710-9b2d-36dc8c9d0c78"]
}, Open  ]],
Cell[29269, 839, 1173, 27, 54, "Input",ExpressionUUID->"5b898eea-17f6-4a1e-a531-c5fc3839954b"],
Cell[30445, 868, 11060, 292, 388, "Input",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],
Cell[CellGroupData[{
Cell[41530, 1164, 343, 8, 30, "Input",ExpressionUUID->"78b6aedf-982d-4dbf-aa72-f05a013c3cca"],
Cell[41876, 1174, 6819, 202, 121, "Output",ExpressionUUID->"77cf4d70-f5b3-436b-9e6f-cec904a3555f"]
}, Open  ]],
Cell[48710, 1379, 1223, 30, 94, "Input",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],
Cell[49936, 1411, 470, 12, 30, "Input",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],
Cell[50409, 1425, 4519, 132, 346, "Input",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],
Cell[CellGroupData[{
Cell[54953, 1561, 2446, 58, 136, "Input",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],
Cell[57402, 1621, 10698, 331, 267, "Output",ExpressionUUID->"1fc52186-8333-43db-baea-6dc2b65a6b9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68137, 1957, 1855, 47, 115, "Input",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],
Cell[69995, 2006, 16036, 499, 378, "Output",ExpressionUUID->"b8d18760-d1d9-4123-92a0-9d07bf704777"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86068, 2510, 1899, 47, 115, "Input",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],
Cell[87970, 2559, 15981, 497, 378, "Output",ExpressionUUID->"67d9b46e-bdc3-4397-a130-8eda4dbfe7bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103988, 3061, 1751, 45, 115, "Input",ExpressionUUID->"91c2cf13-d95a-403a-819f-42d53ea2dba7"],
Cell[105742, 3108, 19823, 618, 446, "Output",ExpressionUUID->"c86ecb6f-3fa1-4c99-9d8b-0d6b2c37e598"]
}, Open  ]],
Cell[125580, 3729, 475, 12, 52, "Input",ExpressionUUID->"d1a0375d-b2ec-4c7c-a505-75632fbc2e83"],
Cell[CellGroupData[{
Cell[126080, 3745, 2022, 52, 115, "Input",ExpressionUUID->"988997b5-45d0-46b5-9d35-ed0d56506ba2"],
Cell[128105, 3799, 11071, 346, 267, "Output",ExpressionUUID->"ec5fb244-8e01-4267-b638-164badbbbc2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139213, 4150, 1746, 45, 115, "Input",ExpressionUUID->"4805e1a6-9b6c-45e8-a9e3-bde8d5c28b62"],
Cell[140962, 4197, 19824, 618, 465, "Output",ExpressionUUID->"05475ffa-4d21-479b-bfdb-97f6b11da9c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160823, 4820, 1867, 47, 115, "Input",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],
Cell[162693, 4869, 16460, 517, 378, "Output",ExpressionUUID->"7e73f795-f059-4ab7-a568-6232255672ae"]
}, Open  ]],
Cell[179168, 5389, 546, 13, 52, "Input",ExpressionUUID->"da09e2b5-a7b4-49bf-9f2b-a1e96746c6fe"],
Cell[179717, 5404, 390, 10, 52, "Input",ExpressionUUID->"afc0ed14-2e84-4db2-b204-d5148e7a1f7b"],
Cell[CellGroupData[{
Cell[180132, 5418, 1701, 45, 115, "Input",ExpressionUUID->"c8b78761-42fe-46bb-920b-b13a77ea2368"],
Cell[181836, 5465, 11071, 346, 267, "Output",ExpressionUUID->"c40b30b5-897e-4742-bef2-1e12986bd174"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192944, 5816, 1697, 45, 115, "Input",ExpressionUUID->"3993c42b-0302-4e21-9400-788471ac28ef"],
Cell[194644, 5863, 16462, 517, 378, "Output",ExpressionUUID->"65413a0f-811b-4b88-ac4d-4c3e8bad83c0"]
}, Open  ]],
Cell[211121, 6383, 449, 12, 52, "Input",ExpressionUUID->"ce94caec-2e68-41a4-b870-6d2a25617e9c"],
Cell[211573, 6397, 400, 11, 52, "Input",ExpressionUUID->"7d3e4827-8c5a-40f5-b971-4d8b6f218c4f"],
Cell[211976, 6410, 396, 11, 52, "Input",ExpressionUUID->"8df78459-b30b-4fb9-b63e-f675b16d5800"],
Cell[CellGroupData[{
Cell[212397, 6425, 1901, 48, 115, "Input",ExpressionUUID->"2ce421c4-d370-4876-9cc8-d8ea9d613286"],
Cell[214301, 6475, 11439, 360, 267, "Output",ExpressionUUID->"869a6416-2ff5-4142-b438-5cdcb66c55d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225777, 6840, 5429, 151, 451, "Input",ExpressionUUID->"fecf5d0e-3695-4c48-8a46-d277432bced8"],
Cell[231209, 6993, 2184, 69, 103, "Output",ExpressionUUID->"1bf6d6f0-5e1b-4611-9213-d700ca86d6f9"],
Cell[233396, 7064, 1718, 53, 57, "Output",ExpressionUUID->"44bde63e-62a5-4d57-904f-674847f75d42"]
}, Open  ]],
Cell[235129, 7120, 1736, 47, 115, "Input",ExpressionUUID->"0b2e61ff-d8f9-4676-929f-e1cd906f54ac"],
Cell[CellGroupData[{
Cell[236890, 7171, 2681, 61, 115, "Input",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],
Cell[239574, 7234, 1358, 23, 81, "Message",ExpressionUUID->"d0d35168-d19c-441c-926b-6b2b4a0409be"],
Cell[240935, 7259, 1888, 40, 109, "Output",ExpressionUUID->"3a9964eb-8ee4-4292-9486-63a36d27233c"]
}, Open  ]],
Cell[242838, 7302, 245, 3, 30, "Input",ExpressionUUID->"232db559-e251-4f2c-8987-b55ed3449b19"],
Cell[243086, 7307, 3879, 103, 157, "Input",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],
Cell[CellGroupData[{
Cell[246990, 7414, 1046, 21, 73, "Input",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],
Cell[248039, 7437, 1236, 27, 63, "Output",ExpressionUUID->"35c792f8-55b0-450a-b0fc-40a1640840ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249312, 7469, 2396, 42, 94, "Input",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],
Cell[251711, 7513, 1261, 29, 60, "Output",ExpressionUUID->"f56d66a7-d524-4d82-8f98-18b52db29b2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253009, 7547, 9943, 264, 304, "Input",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],
Cell[262955, 7813, 1059, 21, 34, "Output",ExpressionUUID->"52644081-8ab3-4f7e-b86c-c1af48466c32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264051, 7839, 999, 21, 73, "Input",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],
Cell[265053, 7862, 1127, 25, 63, "Output",ExpressionUUID->"95cf328e-aa77-4d7e-999f-031cf0032066"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266217, 7892, 1116, 21, 52, "Input",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],
Cell[267336, 7915, 1309, 29, 69, "Output",ExpressionUUID->"0744ead1-7dcc-4407-8f6f-82f336c824bc"]
}, Open  ]],
Cell[268660, 7947, 428, 7, 30, "Input",ExpressionUUID->"31ff794c-f505-471d-8a56-21f4c54fa7e2"],
Cell[269091, 7956, 898, 19, 73, "Input",ExpressionUUID->"7f8e5ec9-b8df-4a2a-80a8-16f73dc6afc2"]
}
]
*)

