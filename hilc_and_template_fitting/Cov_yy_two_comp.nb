(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    153237,       4308]
NotebookOptionsPosition[    145685,       4180]
NotebookOutlinePosition[    146081,       4196]
CellTagsIndexPosition[    146038,       4193]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "matrix", " ", "of", " ", "auto"}], "-", " ", 
    RowBox[{"and", " ", "cross"}], "-", 
    RowBox[{
    "frequency", " ", "power", " ", "spectra", " ", "at", " ", "some", " ", 
     "multipole", " ", "ell"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"here", ",", " ", 
    RowBox[{"CC", " ", "=", " ", 
     RowBox[{"C_ell", "^", "CMB"}]}], " ", ",", " ", 
    RowBox[{"N1", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq1", "}"}]}]}], " ", ",", " ", 
    RowBox[{"N2", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq2", "}"}]}]}], " ", ",", " ", 
    RowBox[{"g1", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq1"}]}], 
    ",", " ", 
    RowBox[{"g2", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq2"}]}], 
    ",", " ", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{"C_ell", "^", "yy"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "tSZ", " ", "power", " ", "spectrum", " ", "in", " ", "frequency"}], 
        "-", 
        RowBox[{"independent", " ", "Compton"}], "-", 
        RowBox[{"y", " ", "units"}]}], ")"}]}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8500974654435797`*^9, 3.850097474804103*^9}, {
   3.850097512768484*^9, 3.850097605412682*^9}, 3.850097643969492*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clij", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Clij", "]"}]}], "Input",
 CellChangeTimes->{{3.85009745416115*^9, 3.850097455840989*^9}, {
  3.850097507223783*^9, 3.850097508147098*^9}, {3.850097619328155*^9, 
  3.8500976307601347`*^9}, {3.851081839361023*^9, 3.8510818642124577`*^9}, {
  3.8510820267280817`*^9, 3.851082046218465*^9}, {3.851775495911669*^9, 
  3.851775519664749*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N1", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}]},
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N2", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8936969268728523`*^9, 3.8936969413163013`*^9}},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"8b1df1ad-7223-4018-b8b2-\
127aabbecec2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClijInv", " ", "=", " ", 
    RowBox[{"Inverse", "[", "Clij", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.893696922409892*^9, 3.893696939191497*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"6574f643-d4b1-4604-970a-deca9402bd10"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gvec", "=", 
    RowBox[{"{", 
     RowBox[{"g1", ",", "g2"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"tSZ", " ", "spectral", " ", "response", " ", "vector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CMB", " ", "spectral", " ", "response", " ", "vector"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"let", "'"}], "s", " ", "get", " ", "the", " ", "ILC", " ", 
     "weights", " ", "for", " ", "the", " ", "y"}], "-", 
    RowBox[{"map", " ", "and", " ", "the", " ", "CMB", " ", "map", " ", 
     RowBox[{"explicitly", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "note", " ", "that", " ", "the", " ", "weights", " ", "should", 
    " ", "be", " ", "measured", " ", "once", " ", "from", " ", "data", " ", 
    "and", " ", "thus", " ", "should", " ", "not", " ", "be", " ", 
    "functions", " ", "of", " ", "Acmb", " ", "or", " ", "Atsz"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijNoA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ",", " ", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", "  ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", "  ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], "  ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijNoAInv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijNoA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCy", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijNoAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijNoAInv", ".", "gvec"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCCMB", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijNoAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijNoAInv", ".", "hvec"}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.850097695847044*^9, {3.851775606465138*^9, 3.851775621929944*^9}, {
   3.893696273622905*^9, 3.893696301133051*^9}, {3.893696839458085*^9, 
   3.8936969175247*^9}, {3.893696956827209*^9, 3.8936970072358513`*^9}, {
   3.893697068233581*^9, 3.893697068799679*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"CC", " ", 
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}]}], "+", 
     RowBox[{"g1", " ", "N2"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"CC", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "g1"}], "+", "g2"}], ")"}]}], "+", 
     RowBox[{"g2", " ", "N1"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.851775622799059*^9, 3.851775629794685*^9}, {
   3.893696270364366*^9, 3.893696301658752*^9}, 3.89369686565466*^9, {
   3.893696945315098*^9, 3.893696947104446*^9}, {3.893696983080895*^9, 
   3.893697019906136*^9}, 3.8936970693903513`*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"f9c252b8-334b-4aba-a335-091b0fd7e293"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"N2", "+", 
     RowBox[{"g2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "g1"}], "+", "g2"}], ")"}], " ", "T"}]}], 
    RowBox[{"N1", "+", "N2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ",", 
   FractionBox[
    RowBox[{"N1", "+", 
     RowBox[{"g1", " ", 
      RowBox[{"(", 
       RowBox[{"g1", "-", "g2"}], ")"}], " ", "T"}]}], 
    RowBox[{"N1", "+", "N2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.851775622799059*^9, 3.851775629794685*^9}, {
   3.893696270364366*^9, 3.893696301658752*^9}, 3.89369686565466*^9, {
   3.893696945315098*^9, 3.893696947104446*^9}, {3.893696983080895*^9, 
   3.893697019906136*^9}, 3.8936970694319277`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"b62cee4c-aaff-4577-9f7c-41a1788a4312"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"first", " ", 
     RowBox[{"let", "'"}], "s", " ", "double"}], "-", 
    RowBox[{
    "check", " ", "the", " ", "calculation", " ", "of", " ", "the", " ", 
     "total", " ", "power", " ", "at", " ", "this", " ", "ell", " ", "in", 
     " ", "the", " ", "harmonic", " ", "ILC", " ", "y"}], "-", "map"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "result", " ", "below", " ", "matches", " ", 
    RowBox[{"Eq", ".", " ", "83"}], " ", "of", " ", "our", " ", "notes", " ", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"version", " ", "12"}], "-", "31", "-", "21"}], ")"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.850097706486309*^9, 3.850097717640025*^9}, {
  3.8500977767353907`*^9, 3.8500977915243187`*^9}, {3.850097888230196*^9, 
  3.850097919774589*^9}, {3.8511767699252863`*^9, 3.851176769961831*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"df97776b-da40-4b25-b589-6c7346b9279c"],

Cell[BoxData[""], "Input",ExpressionUUID->"bb27a85a-a5af-4b31-b956-99d4126a5ca0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Clyy", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"weightsILCy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"weightsILCy", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clyytest", " ", "=", " ", 
     RowBox[{
      RowBox[{"Atsz", " ", "T"}], " ", "+", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"N1", " ", "N2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"g2", "^", "2"}], " ", "N1"}], "+", 
           RowBox[{
            RowBox[{"g1", "^", "2"}], " ", "N2"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "N1", " ", "N2"}], 
           "+", 
           RowBox[{"Acmb", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g2", " ", "N1"}], "+", 
               RowBox[{"g1", " ", "N2"}]}], ")"}], "2"]}]}], ")"}], " ", 
         "CC"}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"N1", "+", " ", "N2"}], ")"}], " ", 
         SuperscriptBox["CC", "2"]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nyy", " ", "=", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"N1", " ", "N2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"g2", "^", "2"}], " ", "N1"}], "+", 
          RowBox[{
           RowBox[{"g1", "^", "2"}], " ", "N2"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "N1", " ", "N2"}], 
          "+", 
          RowBox[{"Acmb", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g2", " ", "N1"}], "+", 
              RowBox[{"g1", " ", "N2"}]}], ")"}], "2"]}]}], ")"}], " ", 
        "CC"}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"N1", "+", " ", "N2"}], ")"}], " ", 
        SuperscriptBox["CC", "2"]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CC", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Clyytest", "-", "Clyytest"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850097721464882*^9, 3.8500977478645077`*^9}, {
   3.850346276713788*^9, 3.850346278442189*^9}, {3.851775542167411*^9, 
   3.85177557100146*^9}, 3.851775656318345*^9, {3.851775699975924*^9, 
   3.8517757097956247`*^9}, {3.851779231571993*^9, 3.851779267066864*^9}, {
   3.8517817147134447`*^9, 3.8517817163706827`*^9}, {3.851782329010209*^9, 
   3.8517824011966743`*^9}, {3.851782440513945*^9, 3.8517824671823483`*^9}, 
   3.851782501193589*^9, {3.851783004556847*^9, 3.851783007902253*^9}, {
   3.851783074788918*^9, 3.8517831921761217`*^9}, {3.851783279763715*^9, 
   3.851783285053823*^9}, {3.851783316808724*^9, 3.851783329632969*^9}, {
   3.851785330348691*^9, 3.8517853470821238`*^9}, 3.89369683587698*^9, 
   3.8936970396557217`*^9, 3.8936970997794724`*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"2a5c4249-e0ed-410e-8c3e-5a3f596868af"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.8936971016172256`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"8170f776-6f22-40e1-975f-51c3b4b5a7a5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "we", " ", "can", " ", "also", " ", "do", " ", "the", " ", "same", " ", 
     "for", " ", "the", " ", "total", " ", "power", " ", "in", " ", "the", 
     " ", "harmonic", " ", "ILC", " ", "CMB", " ", "map"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "the", " ", "cross"}], "-", 
     RowBox[{
     "power", " ", "between", " ", "the", " ", "CMB", " ", "map", " ", "and", 
      " ", "the", " ", "y"}], "-", "map"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "results", " ", "below", " ", "match", " ", 
    RowBox[{"Eqs", ".", " ", "85"}], " ", "and", " ", "86", " ", "of", " ", 
    "our", " ", "notes", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"version", " ", "12"}], "-", "31", "-", "21"}], ")"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.850097988895115*^9, 3.8500980107783947`*^9}, {
  3.850098350392034*^9, 3.850098360121747*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"9ff3a268-3d8e-422b-87d0-5b3bbdc7c55e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClTT", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"weightsILCCMB", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"weightsILCCMB", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Clij", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClTTtest", " ", "=", " ", 
   RowBox[{
    RowBox[{"Acmb", " ", "CC"}], " ", "+", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"N1", " ", "N2", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "N1", " ", "N2"}], 
         "+", 
         RowBox[{"Atsz", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g2", " ", "N1"}], "+", 
             RowBox[{"g1", " ", "N2"}]}], ")"}], "2"]}]}], ")"}], " ", "T"}], 
      "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
       SuperscriptBox["T", "2"]}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"N1", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
      "2"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NTT", " ", "=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{"N1", " ", "N2", " ", 
      RowBox[{"(", 
       RowBox[{"N1", "+", "N2"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "N1", " ", "N2"}], 
        "+", 
        RowBox[{"Atsz", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g2", " ", "N1"}], "+", 
            RowBox[{"g1", " ", "N2"}]}], ")"}], "2"]}]}], ")"}], " ", "T"}], 
     "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
      SuperscriptBox["T", "2"]}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1", "+", "N2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
     "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ClTT", "-", "ClTTtest"}], "]"}]}], "Input",
 CellChangeTimes->{{3.850098038744236*^9, 3.850098040556843*^9}, {
  3.850346295093009*^9, 3.850346296550972*^9}, {3.851781726935107*^9, 
  3.8517817779944143`*^9}, {3.851782060870788*^9, 3.851782098855464*^9}, {
  3.851782574901383*^9, 3.8517825783021297`*^9}, {3.89369712139384*^9, 
  3.8936971256889963`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"ef68a8aa-608a-4e49-ab94-ba30add8c398"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.850098041552128*^9, 3.850346317794262*^9, 3.850350626401301*^9, 
   3.8503537807664223`*^9, 3.851081892229968*^9, 3.851082056789184*^9, 
   3.8511767779487333`*^9, 3.851702815205996*^9, 3.851781779199175*^9, {
   3.851782081707451*^9, 3.851782099682085*^9}, 3.851782579444764*^9, 
   3.8936971266446047`*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"72042c4c-106a-4f2a-8216-918f3c611286"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClTy", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"weightsILCCMB", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"weightsILCy", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "*", 
        RowBox[{"Clij", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8500981952249937`*^9, 3.8500982362816143`*^9}, {
   3.850346324598196*^9, 3.850346326782585*^9}, {3.851781801757866*^9, 
   3.8517818139926243`*^9}, {3.851785310914205*^9, 3.851785318128643*^9}, {
   3.851785351279695*^9, 3.8517853719366426`*^9}, {3.851785409424596*^9, 
   3.851785409922306*^9}, 3.8936971319497347`*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"1c59591f-124e-44d7-927c-7b4b25b7a6af"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g2", " ", "N1"}], "+", 
     RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Acmb", " ", "CC", " ", "N1"}], "+", 
     RowBox[{"Acmb", " ", "CC", " ", "N2"}], "+", 
     RowBox[{"N1", " ", "N2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Acmb", "+", "Atsz"}], ")"}], " ", "CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}], "+", 
     RowBox[{"Atsz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}]}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"N1", "+", "N2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{
  3.8500982370956717`*^9, 3.85034632773096*^9, 3.850350630567959*^9, 
   3.850353784138055*^9, 3.85108189602794*^9, 3.851082059226143*^9, 
   3.851176780450508*^9, 3.851702817520669*^9, 3.851702932161551*^9, 
   3.851781815047332*^9, 3.851783509506652*^9, {3.851785353997609*^9, 
   3.8517853729145203`*^9}, 3.851785410882362*^9, 3.893697132717533*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"17617406-1cb7-4fad-a03e-51c134f38846"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"now", " ", 
     RowBox[{"let", "'"}], "s", " ", "compute", " ", "the", " ", "auto"}], 
    "-", 
    RowBox[{"covariance", " ", "of", " ", "the", " ", "ILC", " ", "y"}], "-", 
    
    RowBox[{"map", " ", "power", " ", "spectrum"}]}], ",", " ", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "Clyy"}], ")"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850101693327486*^9, 3.8501017265692368`*^9}, {
  3.850103986399466*^9, 3.850103987874785*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"4fc0363f-8a90-463c-b651-01b54643e951"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"first", ",", " ", 
    RowBox[{
     RowBox[{
     "construct", " ", "the", " ", "covariance", " ", "matrix", " ", "of", 
      " ", "the", " ", "auto"}], "-", " ", 
     RowBox[{"and", " ", "cross"}], "-", 
     RowBox[{"frequency", " ", "power", " ", "spectra"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "explicitly", " ", "include", " ", "150", "x90", " ", "terms", " ", "in", 
     " ", "power", " ", "spectrum", " ", "covariance", " ", "matrix"}], ",", 
    " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"it", " ", "is", " ", "a", " ", "4", "x4", " ", "matrix"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PScovFull", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "Nmodes"}], ")"}], "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N1", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N1", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N1", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N2", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N1", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N2", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N2", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
           RowBox[{"2", "*", "N2", "*", 
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"Clij", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}]}], "}"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PScovFull", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "PScovFull", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.850101781156426*^9, 3.850101947487274*^9}, {
  3.8501019960010643`*^9, 3.850102085096258*^9}, {3.850102119280776*^9, 
  3.850102143544561*^9}, {3.850102200267356*^9, 3.850102233136145*^9}, {
  3.850585600333256*^9, 3.850585721314766*^9}, {3.8517818473221893`*^9, 
  3.851781851416587*^9}, {3.851781891720147*^9, 3.851781906624173*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Nmodes", "*", "PScovFull"}], "]"}]], "Input",
 CellChangeTimes->{{3.850102237454474*^9, 3.850102251601574*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"78b6aedf-982d-4dbf-aa72-f05a013c3cca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", "N1", "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], "2"]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", "N1", "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", "N1", "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", "N1", "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CC", "+", "N1", "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "T"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"CC", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", 
         RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], "2"]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"CC", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8510820116361523`*^9, 3.851082084627617*^9, 3.851176791399457*^9, 
   3.851702966247176*^9, 3.851781822254259*^9, {3.851781898718251*^9, 
   3.8517819094237347`*^9}, 3.893697154111022*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"7742be56-88d8-40db-907c-f0d89623aac7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "we", " ", "are", " ", "really", " ", "representing", " ", "a", " ", 
      "four"}], "-", 
     RowBox[{"index", " ", "tensor"}]}], ",", " ", 
    RowBox[{
    "each", " ", "of", " ", "whose", " ", "indices", " ", "can", " ", "take", 
     " ", "2", " ", "values"}], ",", " ", 
    RowBox[{"as", " ", "a", " ", "4", "x4", " ", 
     RowBox[{"matrix", " ", "--"}], " ", "both", " ", "objects", " ", 
     "contain", " ", "16", " ", "elements"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"to", " ", "make", " ", "the", " ", "summation", " ", "in", " ", 
     RowBox[{"Eq", ".", " ", "87"}], " ", "straightforward"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "just", " ", "construct", " ", "the", 
      " ", "four"}], "-", 
     RowBox[{"index", " ", "tensor", " ", "explicitly"}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.850102297009666*^9, 3.850102300393331*^9}, {
  3.8501024445495653`*^9, 3.850102525922276*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PScovFullTensor", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.850102529406659*^9, 3.850102532963168*^9}, {
  3.850102635776206*^9, 3.850102680133873*^9}, {3.850102808164304*^9, 
  3.850102844743293*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850102822907016*^9, 3.850102881013631*^9}, {
  3.850102939548687*^9, 3.850103116470541*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"now", " ", "compute", " ", "the", " ", "sum", " ", "in", " ", 
    RowBox[{"Eq", ".", " ", "87"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyyClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyyClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyyClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850103216280018*^9, 3.850103345534136*^9}, {
  3.85034688314222*^9, 3.8503468872510147`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"4b50a60d-5c89-4026-82d7-b87a5b4b31cf"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
      RowBox[{"CC", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
      "+", 
      RowBox[{"N1", " ", 
       RowBox[{"(", 
        RowBox[{"N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", 
   "Nmodes"}]]], "Output",
 CellChangeTimes->{
  3.850103346418851*^9, {3.850346359463306*^9, 3.850346364372675*^9}, 
   3.850346890790058*^9, 3.8503506508829317`*^9, 3.85035379965446*^9, 
   3.8510820970841722`*^9, 3.851176809393149*^9, 3.8517029739428253`*^9, 
   3.851703038565802*^9, 3.851781916173739*^9, 3.89369716549603*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"9a3bdedb-aef2-4d58-a451-16ca4842660d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "verify", " ", "equivalence", " ", "to", " ", "\"\<standard formula\>\"", 
    " ", "with", " ", "appropriate", " ", "identification", " ", "of", " ", 
    "Nlyy", " ", "from", " ", "above"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"CovClyyClyy", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "Nmodes"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"N1", " ", "N2"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2"}], ")"}]}]}], 
         RowBox[{
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2"}]}]], "+", "T"}], ")"}], "^", 
      "2"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850103624426714*^9, 3.850103658011508*^9}, {
  3.850103917746697*^9, 3.850103920006114*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"774d1a86-8c55-4371-a437-38d99507c637"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.850103684182703*^9, 3.850103920746769*^9, 
  3.8503463700119543`*^9, 3.850350653026937*^9, 3.8503538018794518`*^9, 
  3.851082098981771*^9, 3.851176812199201*^9, 3.851702975720098*^9, 
  3.851781918012065*^9, 3.8936971715892553`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"51debd75-bab9-4358-84e1-b04424e2f419"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{
     "covariance", " ", "of", " ", "ILC", " ", "CMB", " ", "map", " ", 
      "power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClCMB", ",", "ClCMB"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClCMBClCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClCMBClCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClCMBClCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8501037946230087`*^9, 3.850103826071932*^9}, {
  3.8501038894304457`*^9, 3.8501039043584013`*^9}, {3.8501039917138147`*^9, 
  3.850103993005377*^9}, {3.850346897053793*^9, 3.85034690273654*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
      RowBox[{"CC", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
      "+", 
      RowBox[{"N1", " ", 
       RowBox[{"(", 
        RowBox[{"N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], "2"]}], 
  RowBox[{"Nmodes", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"N1", "+", "N2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.850103905720087*^9, 3.85010399328983*^9, 
  3.850346483719808*^9, 3.850346904462935*^9, 3.850350655019381*^9, 
  3.850353803411281*^9, 3.851082100701714*^9, 3.8511768135861607`*^9, 
  3.851703040704958*^9, 3.8517819196342907`*^9, 3.893697176374056*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"fd2075db-0a26-4cd7-a41b-1fe156d751a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "verify", " ", "equivalence", " ", "to", " ", "\"\<standard formula\>\"", 
    " ", "with", " ", "appropriate", " ", "identification", " ", "of", " ", 
    "NlCMBCMB", " ", "from", " ", "above"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"CovClCMBClCMB", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "Nmodes"}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
         RowBox[{"CC", " ", 
          RowBox[{"(", 
           RowBox[{"N1", "+", "N2", "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
         "+", 
         RowBox[{"N1", " ", 
          RowBox[{"(", 
           RowBox[{"N2", "+", 
            RowBox[{
             SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ")"}], "^",
       "2"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850103926989203*^9, 3.85010397108169*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"346c8244-6bfb-41f7-9ecc-51b32463d282"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8501039729449387`*^9, 3.850103994339409*^9}, 
   3.850346486449524*^9, 3.850350656830573*^9, 3.850353805453516*^9, 
   3.851082102314516*^9, 3.851176815478478*^9, 3.85178192233889*^9, 
   3.893697180855094*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"db1eac50-83e8-4031-b2fc-49a95cf09ca1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{"covariance", " ", "of", " ", "ILC", " ", "y"}], "-", 
     RowBox[{"map", " ", "x", " ", "CMB", " ", "map", " ", "cross"}], "-", 
     RowBox[{"power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClyCMB", ",", "ClyCMB"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyCMBClyCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyCMBClyCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyCMBClyCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104065705544*^9, 3.8501041223220253`*^9}, {
  3.8503469083506823`*^9, 3.8503469142925377`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"7c73614c-802e-4ef8-afa0-ea8ed97ad75c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["g2", "2"], " ", 
       SuperscriptBox["N1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
      RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["g1", "2"], " ", 
       SuperscriptBox["N2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], "+", 
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]}], 
     ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
       RowBox[{"CC", " ", 
        RowBox[{"(", 
         RowBox[{"N1", "+", "N2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
       "+", 
       RowBox[{"N1", " ", 
        RowBox[{"(", 
         RowBox[{"N2", "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], "2"]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", "Nmodes", 
    " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1", "+", "N2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"]}],
    ")"}]}]], "Output",
 CellChangeTimes->{3.85170313704725*^9, 3.8517819241535587`*^9, 
  3.893697183547526*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"095a51ce-2ed8-40ec-8bdc-f35b9919c3af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "does", " ", "this", " ", "match", " ", "\"\<standard formula\>\"", " ", 
      "for", " ", "the", " ", "variance", " ", "of", " ", "a", " ", "cross"}],
      "-", 
     RowBox[{"power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"Eq", ".", " ", 
     RowBox[{"93", "?", " ", "yes"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"FullSimplify", "[", 
   RowBox[{"CovClyCMBClyCMB", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "Nmodes"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"N1", " ", "N2"}], "+", 
            RowBox[{"CC", " ", 
             RowBox[{"(", 
              RowBox[{"N1", "+", "N2"}], ")"}]}]}], 
           RowBox[{
            RowBox[{"CC", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
            RowBox[{
             SuperscriptBox["g1", "2"], " ", "N2"}]}]], "+", "T"}], ")"}], 
        "*", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
           RowBox[{"CC", " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}], "+", 
           RowBox[{"N1", " ", 
            RowBox[{"(", 
             RowBox[{"N2", "+", 
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], 
          RowBox[{"N1", "+", "N2", "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g2", " ", "N1"}], "+", 
             RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
             RowBox[{"CC", " ", 
              RowBox[{"(", 
               RowBox[{"N1", "+", "N2", "+", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
               ")"}]}], "+", 
             RowBox[{"N1", " ", 
              RowBox[{"(", 
               RowBox[{"N2", "+", 
                RowBox[{
                 SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
          
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"CC", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
             RowBox[{
              SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
            ")"}]}]], ")"}], "^", "2"}]}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850104128647295*^9, 3.8501041643763027`*^9}, {
  3.8501041945403967`*^9, 3.850104197086047*^9}, {3.850104268044387*^9, 
  3.850104369010168*^9}, {3.850104811303342*^9, 3.8501048151093616`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"0b988f29-1b9f-4752-a117-c262c9e0d852"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.850104198464525*^9, 3.850104336374015*^9, 
  3.8501043721680517`*^9, 3.8501048163255157`*^9, 3.8503465163199797`*^9, 
  3.8503506606213303`*^9, 3.8503538090396976`*^9, 3.851082106279949*^9, 
  3.851176818712575*^9, 3.851781925929563*^9, 3.893697185175617*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"919ba89a-1639-491e-88ea-92f0c1c1a06e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "Clyy"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClCMBCMBClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClCMBCMBClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClCMBCMBClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104449157226*^9, 3.850104514135442*^9}, {
  3.8503469341668787`*^9, 3.850346935303865*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g2", " ", "N1"}], "+", 
      RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
      RowBox[{"CC", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
      "+", 
      RowBox[{"N1", " ", 
       RowBox[{"(", 
        RowBox[{"N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", "Nmodes", 
   " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"N1", "+", "N2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.8501045160244293`*^9, 3.8501048195121393`*^9, 
  3.850346607407558*^9, 3.850346936361726*^9, 3.85035066278769*^9, 
  3.8503538107603407`*^9, 3.851082108061067*^9, 3.851176820963545*^9, 
  3.8517819282157583`*^9, 3.893697187778475*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"0faf7d1f-94f2-4e8c-9e56-0a0789e5ce87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compare", " ", "to", " ", 
    RowBox[{"Eq", ".", " ", "94"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"CovClCMBCMBClyy", "-", 
    RowBox[{
     RowBox[{"2", "/", "Nmodes"}], "*", 
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g2", " ", "N1"}], "+", 
           RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
           RowBox[{"CC", " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}], "+", 
           RowBox[{"N1", " ", 
            RowBox[{"(", 
             RowBox[{"N2", "+", 
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"N1", "+", "N2", "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]], 
       ")"}], "^", "2"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850104547610674*^9, 3.850104583537491*^9}, 
   3.851176822272448*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"59698b36-d77e-41ed-8c07-40800060d8d6"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.850104583790039*^9, 3.8501048213833857`*^9, 3.850346610293372*^9, 
   3.850350664360497*^9, 3.85035381237696*^9, 3.8510821097154627`*^9, 
   3.851176824271294*^9, 3.851781929616485*^9, {3.893697191016382*^9, 
   3.893697192282855*^9}},
 CellLabel->
  "Out[157]=",ExpressionUUID->"4d0a287f-c7b6-434f-915d-f261f31b7377"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClCMBCMBClyCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClCMBCMBClyCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClCMBCMBClyCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104656964769*^9, 3.850104669523221*^9}, {
  3.850346944794262*^9, 3.850346953475602*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g2", " ", "N1"}], "+", 
     RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
      RowBox[{"CC", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
      "+", 
      RowBox[{"N1", " ", 
       RowBox[{"(", 
        RowBox[{"N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], "2"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "Nmodes", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"N1", "+", "N2", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{
  3.85010467004191*^9, 3.8501048223395567`*^9, 3.850346614262608*^9, {
   3.850346946483223*^9, 3.850346954129952*^9}, 3.850350666759492*^9, 
   3.850353813924749*^9, 3.8510821112591753`*^9, 3.851176826504139*^9, 
   3.851781931168932*^9, 3.893697194237885*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"0b564cb5-2f14-4b8f-9838-c4ed94f226e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compare", " ", "to", " ", 
    RowBox[{"Eq", ".", " ", "95"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"CovClCMBCMBClyCMB", "-", 
    RowBox[{
     RowBox[{"2", "/", "Nmodes"}], "*", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
        RowBox[{"CC", " ", 
         RowBox[{"(", 
          RowBox[{"N1", "+", "N2", "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
        "+", 
        RowBox[{"N1", " ", 
         RowBox[{"(", 
          RowBox[{"N2", "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], 
       RowBox[{"N1", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ")"}], "*", 
     
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g2", " ", "N1"}], "+", 
          RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"N1", "+", "N2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]], 
      ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8501046724036694`*^9, 3.8501047115510178`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"7244c4e4-7f83-4a91-aeb2-5bfc64f9d09b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.8501047123686533`*^9, 3.8501048229092627`*^9, 
  3.850346617270659*^9, 3.8503506684613132`*^9, 3.8503538157856483`*^9, 
  3.851082113117478*^9, 3.8511768279499903`*^9, 3.851781932561489*^9, 
  3.893697196156186*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"208084ba-53a9-44f9-bd46-1985cd9e517a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClyCMB"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"CovClyyClyCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyyClyCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyyClyCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104715447761*^9, 3.850104746702614*^9}, {
  3.850346965296616*^9, 3.8503469672360687`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g2", " ", "N1"}], "+", 
     RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
      RowBox[{"CC", " ", 
       RowBox[{"(", 
        RowBox[{"N1", "+", "N2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}], 
      "+", 
      RowBox[{"N1", " ", 
       RowBox[{"(", 
        RowBox[{"N2", "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", "Nmodes", 
   " ", 
   RowBox[{"(", 
    RowBox[{"N1", "+", "N2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.850104747289631*^9, 3.850104823809876*^9, 
  3.850346620035562*^9, 3.850346967788084*^9, 3.8503506704589376`*^9, 
  3.8503538173910913`*^9, 3.8510821150022793`*^9, 3.851176829604721*^9, 
  3.851781935806242*^9, 3.8936971983914547`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"b06281cc-73df-48cb-a59d-73afd95ac9af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"compare", " ", "to", " ", 
    RowBox[{"Eq", ".", " ", "96"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"CovClyyClyCMB", "-", 
    RowBox[{
     RowBox[{"2", "/", "Nmodes"}], "*", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"N1", " ", "N2"}], "+", 
         RowBox[{"CC", " ", 
          RowBox[{"(", 
           RowBox[{"N1", "+", "N2"}], ")"}]}]}], 
        RowBox[{
         RowBox[{"CC", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
         RowBox[{
          SuperscriptBox["g1", "2"], " ", "N2"}]}]], "+", "T"}], ")"}], "*", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g2", " ", "N1"}], "+", 
          RowBox[{"g1", " ", "N2"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"N1", "+", "N2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}]], 
      ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8501047498211823`*^9, 3.850104783093261*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"dbc1f8e0-da2e-4bfe-b605-a36b7380eaeb"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.850104783414096*^9, 3.850104824549026*^9, 
  3.85034662310184*^9, 3.850350671964156*^9, 3.850353819282922*^9, 
  3.851082116241734*^9, 3.8511768310618896`*^9, 3.851781937362851*^9, 
  3.893697200546509*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"3dbe92d7-81a8-4236-921f-d9f52e58bb22"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.850346639884039*^9, 3.850346655786344*^9}, {
  3.850346693917186*^9, 3.850346726784639*^9}, {3.8503474122585173`*^9, 
  3.850347413227049*^9}},ExpressionUUID->"da09e2b5-a7b4-49bf-9f2b-\
a1e96746c6fe"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.850347598617648*^9, 
  3.850347599860127*^9}},ExpressionUUID->"f16f6cfd-0237-4346-86b1-\
05357cf80bb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Construct", " ", "Cov_", 
    RowBox[{"{", 
     RowBox[{"ab", ",", "cd"}], "}"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"matrix", " ", "where", " ", "Cov_", 
        RowBox[{"{", 
         RowBox[{"ab", ",", "cd"}], "}"}]}], "=", " ", 
       RowBox[{
        RowBox[{"sigma", "^", "2"}], "_", 
        RowBox[{"{", 
         RowBox[{"Cl", "^", 
          RowBox[{"{", 
           RowBox[{"ab", ",", "cd"}], "}"}]}], "}"}], " ", "where", " ", "ab",
         " ", "and", " ", "cd", " ", "are", " ", "either", " ", "TT"}]}], ",",
       " ", "Ty", ",", " ", 
      RowBox[{"or", " ", "yy"}]}], ")"}], " ", "as", " ", "3", "x3", " ", 
    "matrix", " ", "and", " ", "find", " ", "its", " ", "inverse"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Covabcd", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "CovClCMBClCMB", ",", " ", "CovClCMBCMBClyCMB", ",", " ", 
         "CovClCMBCMBClyy"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClCMBCMBClyCMB", ",", " ", "CovClyCMBClyCMB", ",", " ", 
         "CovClyyClyCMB"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClCMBCMBClyy", ",", " ", "CovClyyClyCMB", ",", " ", 
         "CovClyyClyy"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CovabcdInv", " ", "=", " ", 
     RowBox[{"Inverse", "[", "Covabcd", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85034761163262*^9, 3.850347627086789*^9}, {
  3.8503476620760183`*^9, 3.8503477074779863`*^9}, {3.850347738235574*^9, 
  3.850347827652006*^9}, {3.8503490303809557`*^9, 3.8503490480026217`*^9}, {
  3.850349554687873*^9, 3.850349555120212*^9}, {3.8504038756406727`*^9, 
  3.850403889498209*^9}, {3.850516671388743*^9, 3.850516713436687*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.850347886751474*^9, 3.850347889919529*^9}, {
   3.8503479423667583`*^9, 3.850347961952983*^9}, 
   3.850348874702314*^9},ExpressionUUID->"232db559-e251-4f2c-8987-\
b55ed3449b19"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "derivatives", " ", "of", " ", "ClTT"}], ",", 
    " ", "ClTy", ",", " ", 
    RowBox[{
    "and", " ", "Clyy", " ", "with", " ", "respect", " ", "to", " ", "Acmb", 
     " ", "and", " ", "Atsz", " ", 
     RowBox[{"(", 
      RowBox[{
      "use", " ", "expressions", " ", "from", " ", "earlier", " ", "in", " ", 
       "notebook", " ", "with", " ", "Acmb", " ", "and", " ", "Atsz", " ", 
       "inserted", " ", "next", " ", "to", " ", "CC", " ", "and", " ", "T", 
       " ", "respectively"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTT", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTT", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTy", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTy", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Clyy", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Clyy", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", " ", "derivClTTAcmb", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"derivAcmb", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAcmb", ",", " ", "derivClTyAcmb", ",", " ", "derivClyyAcmb"}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"derivAtsz", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAtsz", ",", " ", "derivClTyAtsz", ",", " ", "derivClyyAtsz"}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ7TNb+OCX9W8cz727dxxEP0/UPQOiZSdy3QPRHHbS
T0C0h33jSxD9+5YZ81cgXXInnBVEW7xxFAPRRvP3iINom2dSsiC6o5/XAETX
/VE0AdEingmWIPpEYawTiP6uWOwCok9Fc3uCaMldV71AtMc7z0AQLSNWAKZL
lvmHg+g7857EgmihSN9kED1hycZ8EL2ii7kUROdaTQTTl7Q2TgfRR9hjZoFo
PR3G6yB6U1j4TRCdFvH9FYjOaIz5A3b/+Z8834D0gzpFXhDdZqspBqJFZRbI
gGiWRhsV9w1vHMtvnQfTzy/VG0dvfOP4JtfAD0R7uOcHg+i+s3KRIForz6uo
E0if2J4Hph9EfHy+YdMbxzMvN74E0QAFudI/
  "],
 CellLabel->
  "In[166]:=",ExpressionUUID->"3d6b127a-5a9a-49a2-b7fe-3623bf033a7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"CC", ",", 
   FractionBox[
    RowBox[{"CC", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1"}], "+", 
       RowBox[{"g1", " ", "N2"}]}], ")"}]}], 
    RowBox[{
     RowBox[{"CC", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
     RowBox[{
      SuperscriptBox["g1", "2"], " ", "N2"}]}]], ",", 
   FractionBox[
    RowBox[{"CC", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g2", " ", "N1"}], "+", 
        RowBox[{"g1", " ", "N2"}]}], ")"}], "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CC", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
       RowBox[{
        SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8511768533064337`*^9, 3.851781966300085*^9, 
  3.893697204923592*^9},
 CellLabel->
  "Out[178]=",ExpressionUUID->"a8b01632-eb5e-48a4-8c49-c2fed6d70627"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g2", " ", "N1"}], "+", 
        RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", "T"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"N1", "+", "N2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], "2"]], 
   ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g2", " ", "N1"}], "+", 
       RowBox[{"g1", " ", "N2"}]}], ")"}], " ", "T"}], 
    RowBox[{"N1", "+", "N2", "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}]], ",", "T"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8511768533064337`*^9, 3.851781966300085*^9, 
  3.8936972049262877`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"f19e084b-4aae-4021-aa0b-b12731f3510a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "Fisher", " ", "matrix", " ", "from", " ", "NILC", " ", 
    "approach", " ", "as", " ", "in", " ", "eq", ".99"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FisherAcmb", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAtsz", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbAtsz", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Fisher", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "FisherAcmb", "]"}], ",", " ", 
        RowBox[{"FullSimplify", "[", "FisherAcmbAtsz", "]"}]}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "FisherAcmbAtsz", "]"}], ",", " ", 
        RowBox[{"FullSimplify", "[", "FisherAtsz", "]"}]}], "}"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.85034950498853*^9, 3.850349509828374*^9}, {
   3.850349574858923*^9, 3.850349597911985*^9}, {3.8503501515145063`*^9, 
   3.850350174863008*^9}, {3.850517816131082*^9, 3.8505178194977922`*^9}, 
   3.851176862907642*^9},
 CellLabel->
  "In[180]:=",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["CC", "2"], " ", "Nmodes", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"N1", "+", "N2", "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
        "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], 
        "2"]}]], ",", 
     FractionBox[
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g2", " ", "N1"}], "+", 
          RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", "Nmodes", " ", "T"}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], 
        "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"CC", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g2", " ", "N1"}], "+", 
          RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", "Nmodes", " ", "T"}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], 
        "2"]}]], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", 
       "Nmodes", " ", 
       SuperscriptBox["T", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}], 
        "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.851176865491004*^9, 3.851781969369155*^9, 
  3.893697208940415*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"ac3a8222-eaa5-41cc-a56b-017e00c0e0fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "final", " ", "covariance", " ", "matrix", " ", "from", 
    " ", "NILC", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovNILC", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "Fisher", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovNILC", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850349516022242*^9, 3.850349626346944*^9}, {
  3.850350209246752*^9, 3.850350218842215*^9}, {3.8503502589937963`*^9, 
  3.8503502599082937`*^9}, {3.85035083617115*^9, 3.85035084700953*^9}, {
  3.8503538388738003`*^9, 3.850353845960312*^9}, {3.850360123321699*^9, 
  3.850360130483348*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["CC", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", 
           SuperscriptBox["N1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g1", "2"], " ", 
           SuperscriptBox["N2", "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
             RowBox[{
              SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
          "+", 
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
            ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g2", " ", "N1"}], "+", 
            RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
           RowBox[{"CC", " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}], "+", 
           RowBox[{"N1", " ", 
            RowBox[{"(", 
             RowBox[{"N2", "+", 
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"CC", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", "T", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["g2", "2"], " ", 
            SuperscriptBox["N1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["g1", "2"], " ", 
            SuperscriptBox["N2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
              RowBox[{
               SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
           "+", 
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}]}], ")"}]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g2", " ", "N1"}], "+", 
            RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
           RowBox[{"CC", " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}], "+", 
           RowBox[{"N1", " ", 
            RowBox[{"(", 
             RowBox[{"N2", "+", 
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"CC", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", "T", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["g2", "2"], " ", 
            SuperscriptBox["N1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["g1", "2"], " ", 
            SuperscriptBox["N2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
              RowBox[{
               SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
           "+", 
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"N1", "+", "N2", "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
         "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", 
        SuperscriptBox["T", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", 
           SuperscriptBox["N1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g1", "2"], " ", 
           SuperscriptBox["N2", "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
             RowBox[{
              SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
          "+", 
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
            ")"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.850353846350346*^9, 3.850360143502346*^9, 
  3.8510824617195*^9, 3.851176871340629*^9, 3.851781971892877*^9, 
  3.893697210676709*^9},
 CellLabel->
  "Out[185]//MatrixForm=",ExpressionUUID->"8cdb1f73-01e1-4201-9b33-\
2e7099aa90c3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Begin", " ", "multifrequency", " ", "template", " ", "fitting", " ", 
    "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "inverse", " ", "of", " ", "power", " ", "spectrum", " ", 
    "covariance", " ", "matrix", " ", 
    RowBox[{"Clij", "^", 
     RowBox[{"-", "1"}]}], " ", "and", " ", "the", " ", "associated", " ", 
    "tensor"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PScov", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PScovInv", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "PScov", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PScovInvTensor", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8503496400147123`*^9, 3.850349654350348*^9}, {
   3.8503497908572073`*^9, 3.8503497978710814`*^9}, {3.850349878403522*^9, 
   3.850349886056686*^9}, {3.85034993506516*^9, 3.850350027390441*^9}, {
   3.850350081207139*^9, 3.850350085493299*^9}, {3.850354087923471*^9, 
   3.850354094474616*^9}, {3.850354125284993*^9, 3.850354161519226*^9}, {
   3.850354210567197*^9, 3.850354224528007*^9}, {3.850354292756077*^9, 
   3.850354295342491*^9}, {3.850354361218829*^9, 3.850354362650098*^9}, {
   3.850355512960595*^9, 3.850355517830956*^9}, {3.850355592082144*^9, 
   3.8503556945546837`*^9}, {3.8503558183935328`*^9, 
   3.8503558213751707`*^9}, {3.850355862239695*^9, 3.850355862571498*^9}, {
   3.8503564617574*^9, 3.850356464796698*^9}, {3.850358682822667*^9, 
   3.8503587488098993`*^9}, {3.850358794002527*^9, 3.850358832500148*^9}, {
   3.850358866527831*^9, 3.850358912497348*^9}, 3.850359117661935*^9, {
   3.8503602492888603`*^9, 3.850360251119399*^9}, {3.850360284619053*^9, 
   3.850360484061838*^9}, {3.8503905177758913`*^9, 3.850390577682815*^9}, {
   3.850392744514257*^9, 3.850392748281014*^9}, {3.850392826907902*^9, 
   3.8503928482054653`*^9}, {3.8503942427038937`*^9, 3.850394263038974*^9}, {
   3.850399164204639*^9, 3.850399230813457*^9}, {3.8503995291376123`*^9, 
   3.850399543546097*^9}, {3.850399629073423*^9, 3.850399631962167*^9}, {
   3.8503996822963457`*^9, 3.850399688602214*^9}, {3.85039972404904*^9, 
   3.850399725387488*^9}, {3.8504002795194407`*^9, 3.8504003088129787`*^9}, {
   3.850518950334333*^9, 3.850518952616405*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "K", " ", "by", " ", "explicitly", " ", "summing", " ", 
    "over", " ", "matrix", " ", "elements", " ", "instead", " ", "of", " ", 
    "tensor"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KCMBCMB", " ", "=", " ", 
     RowBox[{
      RowBox[{"CC", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KCMBtSZ", " ", "=", " ", 
     RowBox[{"CC", "*", "T", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KtSZCMB", " ", "=", "  ", 
     RowBox[{"T", "*", "CC", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KtSZtSZ", " ", "=", " ", 
     RowBox[{
      RowBox[{"T", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KCMBCMB", ",", " ", "KCMBtSZ"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"KtSZCMB", ",", " ", "KtSZtSZ"}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8505198656666327`*^9, 3.850520162743334*^9}, {
  3.850520321814958*^9, 3.850520376883337*^9}, {3.8505206038216343`*^9, 
  3.85052067353691*^9}, {3.850520806532054*^9, 3.850520909483322*^9}, {
  3.851082502529337*^9, 3.8510825452871637`*^9}, {3.851176880241252*^9, 
  3.85117691126571*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "final", " ", "covariance", " ", "matrix", " ", "from", " ", 
    "template", " ", "fitting", " ", "approach", " ", "using", " ", "eq", 
    ".67"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovTemplateFitting", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "K", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovTemplateFitting", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850351206483547*^9, 3.8503512632120237`*^9}, {
  3.850360500871291*^9, 3.8503605209466867`*^9}, {3.8503605644973173`*^9, 
  3.850360567881268*^9}, {3.850518523986722*^9, 3.8505185287438593`*^9}, {
  3.850520397410143*^9, 3.850520397624772*^9}, {3.8505220180807*^9, 
  3.8505220242855*^9}, {3.851082551020994*^9, 3.8510825514764843`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["CC", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", 
           SuperscriptBox["N1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g1", "2"], " ", 
           SuperscriptBox["N2", "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
             RowBox[{
              SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
          "+", 
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
            ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g2", " ", "N1"}], "+", 
            RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
           RowBox[{"CC", " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}], "+", 
           RowBox[{"N1", " ", 
            RowBox[{"(", 
             RowBox[{"N2", "+", 
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"CC", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", "T", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["g2", "2"], " ", 
            SuperscriptBox["N1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["g1", "2"], " ", 
            SuperscriptBox["N2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
              RowBox[{
               SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
           "+", 
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}]}], ")"}]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g2", " ", "N1"}], "+", 
            RowBox[{"g1", " ", "N2"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
           RowBox[{"CC", " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}], "+", 
           RowBox[{"N1", " ", 
            RowBox[{"(", 
             RowBox[{"N2", "+", 
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"CC", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", "T", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["g2", "2"], " ", 
            SuperscriptBox["N1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
           RowBox[{
            SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["g1", "2"], " ", 
            SuperscriptBox["N2", "2"]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
              RowBox[{
               SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
           "+", 
           RowBox[{"CC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"N1", "+", "N2", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
             ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"N1", "+", "N2", "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}], 
         "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N2", " ", "T"}], "+", 
          RowBox[{"CC", " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], ")"}]}],
           "+", 
          RowBox[{"N1", " ", 
           RowBox[{"(", 
            RowBox[{"N2", "+", 
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "T"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "Nmodes", " ", 
        SuperscriptBox["T", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["g2", "2"], " ", 
           SuperscriptBox["N1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", "g1", " ", "g2", " ", "N1", " ", "N2"}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "N1", " ", "N2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["g1", "2"], " ", 
           SuperscriptBox["N2", "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g2", "2"], " ", "N1"}], "+", 
             RowBox[{
              SuperscriptBox["g1", "2"], " ", "N2"}]}], ")"}], " ", "T"}], 
          "+", 
          RowBox[{"CC", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"N1", "+", "N2", "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"g1", "-", "g2"}], ")"}], "2"], " ", "T"}]}], 
            ")"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.850518559897901*^9, 3.850518576473302*^9}, 
   3.85052039918539*^9, 3.85052068330338*^9, 3.850520921982512*^9, 
   3.8505220265429173`*^9, 3.851082475158839*^9, {3.8510825484751*^9, 
   3.851082553370549*^9}, 3.851176926298634*^9, 3.8517819786364737`*^9, 
   3.89369721972893*^9},
 CellLabel->
  "Out[211]//MatrixForm=",ExpressionUUID->"088b6f63-4339-4c7f-80b3-\
79c9ffb9100b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "quick", " ", "idea", " ", "of", " ", "whether", " ", "final",
      " ", "covariance", " ", "matrices", " ", "from", " ", "NILC", " ", 
     "and", " ", "template", " ", "fitting", " ", "are", " ", "equal"}], ",", 
    " ", 
    RowBox[{
    "check", " ", "using", " ", "numerical", " ", "values", " ", "from", " ", 
     "fgspectra", " ", "and", " ", "CLASS", " ", "in", " ", "python", " ", 
     "code", " ", 
     RowBox[{"(", 
      RowBox[{"ell", "=", 
       RowBox[{"1500", " ", "here"}]}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CC", "=", "0.0019252172031626088"}], ",", " ", 
        RowBox[{"T", "=", 
         RowBox[{"1.4575172568790597", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "18"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"g1", "=", 
         RowBox[{"-", "4356390.851902919"}]}], ",", " ", 
        RowBox[{"g2", "=", 
         RowBox[{"-", "2599711.593181207"}]}], ",", " ", 
        RowBox[{"N1", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"N2", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"Nmodes", "=", "3001"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "FinalCovNILC", "]"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CC", "=", "0.0019252172031626088"}], ",", " ", 
        RowBox[{"T", "=", 
         RowBox[{"1.4575172568790597", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "18"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"g1", "=", 
         RowBox[{"-", "4356390.851902919"}]}], ",", " ", 
        RowBox[{"g2", "=", 
         RowBox[{"-", "2599711.593181207"}]}], ",", " ", 
        RowBox[{"N1", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"N2", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"Nmodes", "=", "3001"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "FinalCovTemplateFitting", "]"}]}], "]"}], " ",
     "//", "MatrixForm"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.850518551990716*^9, 3.850518602762053*^9}, 
   3.850522254379108*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"504ce110-8039-496b-a8d4-aadf73bca5af"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0006669482171160556`", 
      RowBox[{"-", "9.885857716096249`*^-9"}]},
     {
      RowBox[{"-", "9.885857716096249`*^-9"}], "0.0007211476087589747`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8503605014548187`*^9, 3.8503605226187267`*^9}, 
   3.850360579046646*^9, 3.850392735523131*^9, 3.8503928911949263`*^9, 
   3.850399735689913*^9, 3.850400327191451*^9, 3.8504009648859873`*^9, 
   3.850401054016142*^9, 3.850518556370965*^9, 3.8505186096229267`*^9, 
   3.850520402067823*^9, 3.850520689078629*^9, 3.850520926119872*^9, 
   3.8505220309300528`*^9, 3.85108247749647*^9, 3.851082555131734*^9, 
   3.851082819716818*^9, 3.851176927504758*^9, 3.851781980227248*^9, 
   3.8936972215727587`*^9},
 CellLabel->
  "Out[212]//MatrixForm=",ExpressionUUID->"a16dfa86-132e-4032-bd43-\
f0c4c2258c48"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0006669482171160556`", 
      RowBox[{"-", "9.885857716096249`*^-9"}]},
     {
      RowBox[{"-", "9.885857716096249`*^-9"}], "0.0007211476087589747`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8503605014548187`*^9, 3.8503605226187267`*^9}, 
   3.850360579046646*^9, 3.850392735523131*^9, 3.8503928911949263`*^9, 
   3.850399735689913*^9, 3.850400327191451*^9, 3.8504009648859873`*^9, 
   3.850401054016142*^9, 3.850518556370965*^9, 3.8505186096229267`*^9, 
   3.850520402067823*^9, 3.850520689078629*^9, 3.850520926119872*^9, 
   3.8505220309300528`*^9, 3.85108247749647*^9, 3.851082555131734*^9, 
   3.851082819716818*^9, 3.851176927504758*^9, 3.851781980227248*^9, 
   3.8936972215761633`*^9},
 CellLabel->
  "Out[213]//MatrixForm=",ExpressionUUID->"9e3bdc6e-17e8-420b-a346-\
b8de1c7e8b90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Analytically", " ", "compare", " ", "final", " ", "covariance", " ", 
    "matrices", " ", "from", " ", "NILC", " ", "and", " ", "template", " ", 
    "fitting"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"FinalCovNILC", "-", "FinalCovTemplateFitting"}], "]"}], " ", "//",
    "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.850351271104641*^9, 3.850351296476169*^9}, {
  3.850355875846406*^9, 3.850355905899435*^9}, {3.850360545180888*^9, 
  3.8503605498940563`*^9}, {3.850360672509582*^9, 3.850360678869467*^9}, {
  3.850518617440613*^9, 3.850518631620695*^9}, {3.85051873631888*^9, 
  3.850518751618104*^9}, {3.850520457595566*^9, 3.850520482106653*^9}, {
  3.850520556251568*^9, 3.850520562191472*^9}, {3.8505207309376583`*^9, 
  3.850520736040427*^9}, {3.8505212461870737`*^9, 3.85052124648522*^9}, {
  3.850522102804269*^9, 3.8505221193104477`*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.850355906809094*^9, 3.850360495190134*^9, 3.850360574719036*^9, 
   3.85036061346474*^9, 3.850360962706068*^9, 3.8505189485289803`*^9, 
   3.850518997773788*^9, 3.8505190320029907`*^9, 3.850520445552864*^9, 
   3.8505204859194727`*^9, 3.850520566307926*^9, 3.8505207400199413`*^9, 
   3.8505212525933867`*^9, 3.85052203449234*^9, {3.8505221123532267`*^9, 
   3.8505221214016247`*^9}, 3.8510824805972157`*^9, 3.851082559525449*^9, 
   3.851176930833293*^9, 3.851781984332346*^9, 3.893697228912821*^9},
 CellLabel->
  "Out[214]//MatrixForm=",ExpressionUUID->"8b56192d-eac0-499c-a948-\
ebe037e88425"]
}, Open  ]]
},
WindowSize->{1233, 746},
WindowMargins->{{Automatic, 0}, {14, Automatic}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"839a2295-dbf7-4c58-9138-edbdf0665a83"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1549, 39, 73, "Input",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],
Cell[CellGroupData[{
Cell[2132, 63, 1218, 30, 54, "Input",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],
Cell[3353, 95, 1156, 33, 69, "Output",ExpressionUUID->"8b1df1ad-7223-4018-b8b2-127aabbecec2"]
}, Open  ]],
Cell[4524, 131, 304, 6, 52, "Input",ExpressionUUID->"6574f643-d4b1-4604-970a-deca9402bd10"],
Cell[CellGroupData[{
Cell[4853, 141, 2809, 74, 201, "Input",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],
Cell[7665, 217, 1277, 38, 54, "Output",ExpressionUUID->"f9c252b8-334b-4aba-a335-091b0fd7e293"],
Cell[8945, 257, 1024, 29, 54, "Output",ExpressionUUID->"b62cee4c-aaff-4577-9f7c-41a1788a4312"]
}, Open  ]],
Cell[9984, 289, 997, 22, 52, "Input",ExpressionUUID->"df97776b-da40-4b25-b589-6c7346b9279c"],
Cell[10984, 313, 81, 0, 30, "Input",ExpressionUUID->"bb27a85a-a5af-4b31-b956-99d4126a5ca0"],
Cell[CellGroupData[{
Cell[11090, 317, 4710, 129, 187, "Input",ExpressionUUID->"2a5c4249-e0ed-410e-8c3e-5a3f596868af"],
Cell[15803, 448, 155, 3, 34, "Output",ExpressionUUID->"8170f776-6f22-40e1-975f-51c3b4b5a7a5"]
}, Open  ]],
Cell[15973, 454, 1047, 24, 52, "Input",ExpressionUUID->"9ff3a268-3d8e-422b-87d0-5b3bbdc7c55e"],
Cell[CellGroupData[{
Cell[17045, 482, 3715, 113, 166, "Input",ExpressionUUID->"ef68a8aa-608a-4e49-ab94-ba30add8c398"],
Cell[20763, 597, 444, 8, 34, "Output",ExpressionUUID->"72042c4c-106a-4f2a-8216-918f3c611286"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21244, 610, 1060, 25, 30, "Input",ExpressionUUID->"1c59591f-124e-44d7-927c-7b4b25b7a6af"],
Cell[22307, 637, 1760, 52, 61, "Output",ExpressionUUID->"17617406-1cb7-4fad-a03e-51c134f38846"]
}, Open  ]],
Cell[24082, 692, 614, 16, 30, "Input",ExpressionUUID->"4fc0363f-8a90-463c-b651-01b54643e951"],
Cell[24699, 710, 8274, 226, 199, "Input",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],
Cell[CellGroupData[{
Cell[32998, 940, 250, 5, 30, "Input",ExpressionUUID->"78b6aedf-982d-4dbf-aa72-f05a013c3cca"],
Cell[33251, 947, 5216, 159, 108, "Output",ExpressionUUID->"7742be56-88d8-40db-907c-f0d89623aac7"]
}, Open  ]],
Cell[38482, 1109, 1162, 28, 94, "Input",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],
Cell[39647, 1139, 470, 12, 30, "Input",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],
Cell[40120, 1153, 4519, 132, 346, "Input",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],
Cell[CellGroupData[{
Cell[44664, 1289, 1719, 43, 94, "Input",ExpressionUUID->"4b50a60d-5c89-4026-82d7-b87a5b4b31cf"],
Cell[46386, 1334, 1347, 40, 63, "Output",ExpressionUUID->"9a3bdedb-aef2-4d58-a451-16ca4842660d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47770, 1379, 1233, 34, 77, "Input",ExpressionUUID->"774d1a86-8c55-4371-a437-38d99507c637"],
Cell[49006, 1415, 366, 6, 34, "Output",ExpressionUUID->"51debd75-bab9-4358-84e1-b04424e2f419"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49409, 1426, 1984, 51, 115, "Input",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],
Cell[51396, 1479, 1202, 35, 63, "Output",ExpressionUUID->"fd2075db-0a26-4cd7-a41b-1fe156d751a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52635, 1519, 1396, 39, 82, "Input",ExpressionUUID->"346c8244-6bfb-41f7-9ecc-51b32463d282"],
Cell[54034, 1560, 344, 6, 34, "Output",ExpressionUUID->"db1eac50-83e8-4031-b2fc-49a95cf09ca1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54415, 1571, 1957, 50, 115, "Input",ExpressionUUID->"7c73614c-802e-4ef8-afa0-ea8ed97ad75c"],
Cell[56375, 1623, 2580, 82, 61, "Output",ExpressionUUID->"095a51ce-2ed8-40ec-8bdc-f35b9919c3af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58992, 1710, 3948, 112, 186, "Input",ExpressionUUID->"0b988f29-1b9f-4752-a117-c262c9e0d852"],
Cell[62943, 1824, 392, 6, 34, "Output",ExpressionUUID->"919ba89a-1639-491e-88ea-92f0c1c1a06e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63372, 1835, 1712, 45, 115, "Input",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],
Cell[65087, 1882, 1662, 52, 63, "Output",ExpressionUUID->"0faf7d1f-94f2-4e8c-9e56-0a0789e5ce87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66786, 1939, 1900, 55, 84, "Input",ExpressionUUID->"59698b36-d77e-41ed-8c07-40800060d8d6"],
Cell[68689, 1996, 371, 7, 34, "Output",ExpressionUUID->"4d0a287f-c7b6-434f-915d-f261f31b7377"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69097, 2008, 1720, 45, 115, "Input",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],
Cell[70820, 2055, 1620, 50, 63, "Output",ExpressionUUID->"0b564cb5-2f14-4b8f-9838-c4ed94f226e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72477, 2110, 2560, 77, 166, "Input",ExpressionUUID->"7244c4e4-7f83-4a91-aeb2-5bfc64f9d09b"],
Cell[75040, 2189, 348, 6, 34, "Output",ExpressionUUID->"208084ba-53a9-44f9-bd46-1985cd9e517a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75425, 2200, 1702, 45, 115, "Input",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],
Cell[77130, 2247, 1603, 50, 63, "Output",ExpressionUUID->"b06281cc-73df-48cb-a59d-73afd95ac9af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78770, 2302, 2347, 70, 84, "Input",ExpressionUUID->"dbc1f8e0-da2e-4bfe-b605-a36b7380eaeb"],
Cell[81120, 2374, 339, 6, 34, "Output",ExpressionUUID->"3dbe92d7-81a8-4236-921f-d9f52e58bb22"]
}, Open  ]],
Cell[81474, 2383, 249, 4, 30, "Input",ExpressionUUID->"da09e2b5-a7b4-49bf-9f2b-a1e96746c6fe"],
Cell[81726, 2389, 152, 3, 30, "Input",ExpressionUUID->"f16f6cfd-0237-4346-86b1-05357cf80bb7"],
Cell[81881, 2394, 1959, 49, 115, "Input",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],
Cell[83843, 2445, 227, 4, 30, "Input",ExpressionUUID->"232db559-e251-4f2c-8987-b55ed3449b19"],
Cell[CellGroupData[{
Cell[84095, 2453, 4796, 132, 346, "Input",ExpressionUUID->"3d6b127a-5a9a-49a2-b7fe-3623bf033a7d"],
Cell[88894, 2587, 1206, 40, 60, "Output",ExpressionUUID->"a8b01632-eb5e-48a4-8c49-c2fed6d70627"],
Cell[90103, 2629, 979, 33, 60, "Output",ExpressionUUID->"f19e084b-4aae-4021-aa0b-b12731f3510a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91119, 2667, 3793, 103, 157, "Input",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],
Cell[94915, 2772, 4186, 130, 118, "Output",ExpressionUUID->"ac3a8222-eaa5-41cc-a56b-017e00c0e0fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99138, 2907, 853, 19, 73, "Input",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],
Cell[99994, 2928, 10259, 288, 113, "Output",ExpressionUUID->"8cdb1f73-01e1-4201-9b33-2e7099aa90c3"]
}, Open  ]],
Cell[110268, 3219, 8523, 231, 493, "Input",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],
Cell[118794, 3452, 7852, 214, 325, "Input",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],
Cell[CellGroupData[{
Cell[126671, 3670, 975, 20, 73, "Input",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],
Cell[127649, 3692, 10406, 290, 113, "Output",ExpressionUUID->"088b6f63-4339-4c7f-80b3-79c9ffb9100b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138092, 3987, 2919, 77, 157, "Input",ExpressionUUID->"504ce110-8039-496b-a8d4-aadf73bca5af"],
Cell[141014, 4066, 1232, 28, 69, "Output",ExpressionUUID->"a16dfa86-132e-4032-bd43-f0c4c2258c48"],
Cell[142249, 4096, 1232, 28, 69, "Output",ExpressionUUID->"9e3bdc6e-17e8-420b-a346-b8de1c7e8b90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143518, 4129, 1044, 20, 52, "Input",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],
Cell[144565, 4151, 1104, 26, 63, "Output",ExpressionUUID->"8b56192d-eac0-499c-a948-ebe037e88425"]
}, Open  ]]
}
]
*)

