(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83791,       2087]
NotebookOptionsPosition[     80856,       2038]
NotebookOutlinePosition[     81255,       2054]
CellTagsIndexPosition[     81212,       2051]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "matrix", " ", "of", " ", "auto"}], "-", " ", 
    RowBox[{"and", " ", "cross"}], "-", 
    RowBox[{
    "frequency", " ", "power", " ", "spectra", " ", "at", " ", "some", " ", 
     "multipole", " ", "ell"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"here", ",", " ", 
    RowBox[{"CC", " ", "=", " ", 
     RowBox[{"C_ell", "^", "CMB"}]}], " ", ",", " ", 
    RowBox[{"N1", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq1", "}"}]}]}], " ", ",", " ", 
    RowBox[{"N2", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq2", "}"}]}]}], " ", ",", " ", 
    RowBox[{"g1", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq1"}]}], 
    ",", " ", 
    RowBox[{"g2", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq2"}]}], 
    ",", " ", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{"C_ell", "^", "yy"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "tSZ", " ", "power", " ", "spectrum", " ", "in", " ", "frequency"}], 
        "-", 
        RowBox[{"independent", " ", "Compton"}], "-", 
        RowBox[{"y", " ", "units"}]}], ")"}]}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8500974654435797`*^9, 3.850097474804103*^9}, {
   3.850097512768484*^9, 3.850097605412682*^9}, 3.850097643969492*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clij", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g3", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g2", " ", "g3", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g3", " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g2", "  ", "g3", " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N3", "+", 
        RowBox[{
         SuperscriptBox["g3", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Clij", "]"}]}], "Input",
 CellChangeTimes->{{3.85009745416115*^9, 3.850097455840989*^9}, {
   3.850097507223783*^9, 3.850097508147098*^9}, {3.850097619328155*^9, 
   3.8500976307601347`*^9}, {3.851081839361023*^9, 3.8510818642124577`*^9}, {
   3.8510820267280817`*^9, 3.851082046218465*^9}, {3.851775495911669*^9, 
   3.851775519664749*^9}, 3.912356136090687*^9, {3.9161851231021233`*^9, 
   3.9161851944351*^9}, {3.916218721545936*^9, 3.916218732097715*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N1", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g1", "2"], " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g3", " ", "T"}]}]},
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g2", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N2", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g2", "2"], " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g2", " ", "g3", " ", "T"}]}]},
     {
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g1", " ", "g3", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", 
       RowBox[{"Atsz", " ", "g2", " ", "g3", " ", "T"}]}], 
      RowBox[{
       RowBox[{"Acmb", " ", "CC"}], "+", "N3", "+", 
       RowBox[{"Atsz", " ", 
        SuperscriptBox["g3", "2"], " ", "T"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8936969268728523`*^9, 3.8936969413163013`*^9}, 
   3.912356138719865*^9, 3.912852468755699*^9, 3.912873558484352*^9, 
   3.916172522844046*^9, 3.916175777986582*^9, 3.91618521579071*^9, 
   3.9161869575900583`*^9, 3.916216355529974*^9, 3.91621643773818*^9, {
   3.9162187226587973`*^9, 3.916218736011746*^9}, 3.918677511099311*^9, 
   3.9186799043103037`*^9, 3.9277624798450336`*^9, 3.9279034333403273`*^9, 
   3.927906708590502*^9, 3.927918303963984*^9, 3.927965905972653*^9},
 CellLabel->
  "Out[476]//MatrixForm=",ExpressionUUID->"399797ed-a789-49a4-a24b-\
8b7d47530b13"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClijInv", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Inverse", "[", "Clij", "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.893696922409892*^9, 3.893696939191497*^9}, {
  3.91621635944206*^9, 3.91621636395444*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"6574f643-d4b1-4604-970a-deca9402bd10"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gvec", "=", 
    RowBox[{"{", 
     RowBox[{"g1", ",", "g2", ",", " ", "g3"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"tSZ", " ", "spectral", " ", "response", " ", "vector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", " ", "1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CMB", " ", "spectral", " ", "response", " ", "vector"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"let", "'"}], "s", " ", "get", " ", "the", " ", "ILC", " ", 
     "weights", " ", "for", " ", "the", " ", "y"}], "-", 
    RowBox[{"map", " ", "and", " ", "the", " ", "CMB", " ", "map", " ", 
     RowBox[{"explicitly", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "note", " ", "that", " ", "the", " ", "weights", " ", "here", 
    " ", "are", " ", "measured", " ", "once", " ", "from", " ", "data", " ", 
    "and", " ", "thus", " ", "should", " ", "not", " ", "be", " ", 
    "functions", " ", "of", " ", "Acmb", " ", "or", " ", "Atsz"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijNoA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ",", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g3", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", 
        RowBox[{"g2", " ", "g3", "  ", "T"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g3", "  ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", " ", 
        RowBox[{"g2", "  ", "g3", "  ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", "N3", "+", 
        RowBox[{
         SuperscriptBox["g3", "2"], "  ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijNoAInv", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Inverse", "[", "ClijNoA", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsILCy", "=", 
   RowBox[{"{", 
    RowBox[{"w1y", ",", " ", "w2y", ",", " ", "w3y"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsILCCMB", "=", 
   RowBox[{"{", 
    RowBox[{"w1cmb", ",", " ", "w2cmb", ",", " ", "w3cmb"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ILCweights", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"weightsILCCMB", ",", " ", "weightsILCy"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assumptions", " ", "=", " ", 
   RowBox[{
    RowBox[{"CC", ">", "0"}], " ", "&&", " ", 
    RowBox[{"T", ">", "0"}], " ", "&&", " ", 
    RowBox[{"N1", ">", "0"}], " ", "&&", " ", 
    RowBox[{"N2", ">", "0"}], " ", "&&", " ", 
    RowBox[{"N3", ">", "0"}], " ", "&&", " ", 
    RowBox[{"g1", "!=", "0"}], " ", "&&", " ", 
    RowBox[{"g2", " ", "!=", "0"}], " ", "&&", " ", 
    RowBox[{"g3", "!=", "0"}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"w1cmb", "+", "w2cmb", "+", "w3cmb"}], "==", "1"}], " ", "&&", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"g1", "*", "w1y"}], " ", "+", " ", 
      RowBox[{"g2", "*", "w2y"}], " ", "+", " ", 
      RowBox[{"g3", "*", "w3y"}]}], " ", "==", " ", "1"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.850097695847044*^9, {3.851775606465138*^9, 3.851775621929944*^9}, {
   3.893696273622905*^9, 3.893696301133051*^9}, {3.893696839458085*^9, 
   3.8936969175247*^9}, {3.893696956827209*^9, 3.8936970072358513`*^9}, {
   3.893697068233581*^9, 3.893697068799679*^9}, {3.912356292289198*^9, 
   3.9123563085899267`*^9}, {3.9123587037551727`*^9, 3.912358705991654*^9}, {
   3.912852524957137*^9, 3.9128525373687487`*^9}, {3.9128536943079023`*^9, 
   3.912853723681417*^9}, {3.916185229181353*^9, 3.916185303852524*^9}, {
   3.916218702892089*^9, 3.916218703024744*^9}, {3.9162187863161297`*^9, 
   3.9162187887694893`*^9}, {3.927918309481958*^9, 3.927918319370038*^9}, {
   3.9279186400144567`*^9, 3.927918642693426*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w1cmb", ",", "w2cmb", ",", "w3cmb"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w1y", ",", "w2y", ",", "w3y"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.912853724062608*^9, 3.912873563071289*^9, 3.916172533155102*^9, 
   3.916175781086645*^9, 3.916185232883863*^9, {3.916185293646035*^9, 
   3.916185304468408*^9}, 3.916186960958791*^9, 3.916216367473343*^9, 
   3.916216438975286*^9, 3.916218793011836*^9, 3.918677515923517*^9, {
   3.9186799080726757`*^9, 3.918679910455648*^9}, {3.927762483125978*^9, 
   3.927762507551156*^9}, 3.92790343749415*^9, 3.927903836540732*^9, 
   3.927906712974409*^9, {3.927918307186413*^9, 3.9279183204994717`*^9}, 
   3.92791864407792*^9, 3.9279659094748697`*^9},
 CellLabel->
  "Out[484]=",ExpressionUUID->"e2597b7a-c8c4-46f5-81ab-8b905fc106e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Construct", " ", "data", " ", "vector", " ", "for", " ", "harmonic", " ", 
    "ILC", " ", "approach"}], "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Clyy", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"weightsILCy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"weightsILCy", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClTT", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"weightsILCCMB", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"weightsILCCMB", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClTy", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"weightsILCCMB", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"weightsILCy", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.850097721464882*^9, 3.8500977478645077`*^9}, {
   3.850346276713788*^9, 3.850346278442189*^9}, {3.851775542167411*^9, 
   3.85177557100146*^9}, 3.851775656318345*^9, {3.851775699975924*^9, 
   3.8517757097956247`*^9}, {3.851779231571993*^9, 3.851779267066864*^9}, {
   3.8517817147134447`*^9, 3.8517817163706827`*^9}, {3.851782329010209*^9, 
   3.8517824011966743`*^9}, {3.851782440513945*^9, 3.8517824671823483`*^9}, 
   3.851782501193589*^9, {3.851783004556847*^9, 3.851783007902253*^9}, {
   3.851783074788918*^9, 3.8517831921761217`*^9}, {3.851783279763715*^9, 
   3.851783285053823*^9}, {3.851783316808724*^9, 3.851783329632969*^9}, {
   3.851785330348691*^9, 3.8517853470821238`*^9}, 3.89369683587698*^9, 
   3.8936970396557217`*^9, 3.8936970997794724`*^9, {3.912355894988212*^9, 
   3.912355907622816*^9}, {3.912358748604013*^9, 3.912358756861215*^9}, {
   3.9128748143038797`*^9, 3.9128748190909653`*^9}, {3.9161853115281763`*^9, 
   3.916185318672202*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"2a5c4249-e0ed-410e-8c3e-5a3f596868af"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.850101781156426*^9, 3.850101947487274*^9}, {
   3.8501019960010643`*^9, 3.850102085096258*^9}, {3.850102119280776*^9, 
   3.850102143544561*^9}, {3.850102200267356*^9, 3.850102233136145*^9}, {
   3.850585600333256*^9, 3.850585721314766*^9}, {3.8517818473221893`*^9, 
   3.851781851416587*^9}, {3.851781891720147*^9, 3.851781906624173*^9}, {
   3.912873573062683*^9, 3.9128735734398518`*^9}, {3.912873663299159*^9, 
   3.912873673171523*^9}, {3.912873724455068*^9, 3.9128737247628117`*^9}, {
   3.912873927120644*^9, 3.912873931933135*^9}, {3.9128739749600782`*^9, 
   3.91287398199268*^9}, {3.912874057898666*^9, 3.912874063994863*^9}, {
   3.9128741037433147`*^9, 3.912874137435522*^9}, {3.9128741930768642`*^9, 
   3.912874209237049*^9}, {3.912874256281001*^9, 3.912874256678738*^9}, {
   3.912874791242359*^9, 3.912874797513936*^9}, {3.916172632597136*^9, 
   3.916172639025494*^9}, {3.916173205448017*^9, 3.91617324416761*^9}, {
   3.9161732751661177`*^9, 3.916173277633732*^9}, 3.9161741780775414`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "we", " ", "are", " ", "really", " ", "representing", " ", "a", " ", 
      "four"}], "-", 
     RowBox[{"index", " ", "tensor"}]}], ",", " ", 
    RowBox[{
    "each", " ", "of", " ", "whose", " ", "indices", " ", "can", " ", "take", 
     " ", "3", " ", "values"}], ",", " ", 
    RowBox[{"as", " ", "a", " ", "6", "x6", " ", "matrix"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "to", " ", "make", " ", "the", " ", "summation", " ", "straightforward"}],
     ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "just", " ", "construct", " ", "the", 
      " ", "four"}], "-", 
     RowBox[{"index", " ", "tensor", " ", 
      RowBox[{"explicitly", ".", " ", "For"}], " ", "simplicity"}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{"let", "'"}], "s", " ", "make", " ", "it", " ", "an", " ", 
     "identity", " ", "matrix", " ", "scaled", " ", "by", " ", "a", " ", 
     "constant", " ", "factor"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.850102297009666*^9, 3.850102300393331*^9}, {
   3.8501024445495653`*^9, 3.850102525922276*^9}, 3.916174173276832*^9, {
   3.916185375073578*^9, 3.916185389952979*^9}, {3.927904435508069*^9, 
   3.927904445885537*^9}, {3.927904870905282*^9, 
   3.9279048751109457`*^9}},ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-\
b460c1ab0052"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PScovFullTensor", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "<=", " ", "3"}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", " ", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", "<=", " ", "3"}], ",", " ", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", " ", 
       RowBox[{"k", "<=", " ", "3"}], ",", " ", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", " ", "[", 
        RowBox[{
         RowBox[{"l", "=", "1"}], ",", " ", 
         RowBox[{"l", "<=", " ", "3"}], ",", " ", 
         RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PScovFullTensor", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ClijNoA", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
            RowBox[{"ClijNoA", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "l"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"ClijNoA", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "l"}], "]"}], "]"}], "*", 
            RowBox[{"ClijNoA", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "k"}], "]"}], "]"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PScovFull", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"a", "=", "1"}], ",", 
   RowBox[{"a", "<=", "3"}], ",", 
   RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"b", "=", "1"}], ",", 
     RowBox[{"b", "<=", "3"}], ",", 
     RowBox[{"b", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"c", "=", "1"}], ",", 
       RowBox[{"c", "<=", "3"}], ",", 
       RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"d", "=", "1"}], ",", 
         RowBox[{"d", "<=", "3"}], ",", 
         RowBox[{"d", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idxa", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"a", "==", "b", "==", "1"}], ",", " ", "1", ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "b", "==", "2"}], ",", " ", "2", ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"a", "==", "b", "==", "3"}], ",", " ", "3", ",", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], " ", "&&", 
                    RowBox[{"b", "==", "2"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "2"}], " ", "&&", " ", 
                    RowBox[{"b", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "4",
                    ",", " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], "&&", 
                    RowBox[{"b", "==", "3"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "3"}], " ", "&&", " ", 
                    RowBox[{"b", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "5",
                     ",", " ", "6"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"idxb", " ", "=", "  ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "==", "d", "==", "1"}], ",", " ", "1", ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"c", "==", "d", "==", "2"}], ",", " ", "2", ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"c", "==", "d", "==", "3"}], ",", " ", "3", ",", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "1"}], " ", "&&", 
                    RowBox[{"d", "==", "2"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "2"}], " ", "&&", " ", 
                    RowBox[{"d", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "4",
                    ",", " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "1"}], "&&", 
                    RowBox[{"d", "==", "3"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "3"}], " ", "&&", " ", 
                    RowBox[{"d", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "5",
                     ",", " ", "6"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"PScovFull", "[", 
            RowBox[{"[", 
             RowBox[{"idxa", ",", " ", "idxb"}], "]"}], "]"}], " ", "=", " ", 
           
           RowBox[{"PScovFullTensor", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], " ",
           ";"}]}], "\[IndentingNewLine]", "\t", "]"}]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "PScovFull", "]"}]}], "Input",
 CellChangeTimes->{{3.850102529406659*^9, 3.850102532963168*^9}, {
   3.850102635776206*^9, 3.850102680133873*^9}, {3.850102808164304*^9, 
   3.850102844743293*^9}, {3.912874838149637*^9, 3.912874838402274*^9}, 
   3.91617399792735*^9, {3.916185400401185*^9, 3.9161854303686047`*^9}, {
   3.916185463310375*^9, 3.916185536932143*^9}, {3.91618692030899*^9, 
   3.916186952606862*^9}, {3.9162194541212797`*^9, 3.916219458567175*^9}, {
   3.927904876793201*^9, 3.927904881182763*^9}, {3.927906331821054*^9, 
   3.927906469184025*^9}, {3.927906524785699*^9, 3.9279065491000566`*^9}, {
   3.92790658729322*^9, 3.927906622844469*^9}, {3.9279066552156754`*^9, 
   3.927906683889792*^9}, {3.927906726946033*^9, 3.927906732394268*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.9162194591359997`*^9, 3.9186799193959103`*^9, 3.927762512247254*^9, 
   3.927903446958424*^9, 3.927903845111755*^9, 3.927904881999097*^9, {
   3.927906715775839*^9, 3.927906733542006*^9}, 3.927918326725729*^9, 
   3.927965912189629*^9},
 CellLabel->
  "Out[493]=",ExpressionUUID->"4439dd46-950f-4e78-96e0-561dc5dd6aad"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CovabcdTensor", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", " ", "2", ",", " ", "2"}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Covabcd", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"a", "=", "1"}], ",", 
   RowBox[{"a", "<=", "2"}], ",", 
   RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"b", "=", "1"}], ",", 
     RowBox[{"b", "<=", "2"}], ",", 
     RowBox[{"b", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"c", "=", "1"}], ",", 
       RowBox[{"c", "<=", "2"}], ",", 
       RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"d", "=", "1"}], ",", 
         RowBox[{"d", "<=", "2"}], ",", 
         RowBox[{"d", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CovabcdTensor", "[", 
           RowBox[{"[", 
            RowBox[{"a", ",", "b", ",", "c", ",", " ", "d"}], "]"}], "]"}], 
          "=", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ILCweights", "[", 
                    RowBox[{"[", 
                    RowBox[{"a", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"ILCweights", "[", 
                    RowBox[{"[", 
                    RowBox[{"b", ",", "j"}], "]"}], "]"}], "*", 
                    RowBox[{"ILCweights", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "k"}], "]"}], "]"}], "*", 
                    RowBox[{"ILCweights", "[", 
                    RowBox[{"[", 
                    RowBox[{"d", ",", "l"}], "]"}], "]"}], "*", 
                    RowBox[{"PScovFullTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                    "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "\t", "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.850103216280018*^9, 3.850103345534136*^9}, {
   3.85034688314222*^9, 3.8503468872510147`*^9}, 3.912356236225366*^9, {
   3.912356268282111*^9, 3.912356281475205*^9}, {3.912356322260798*^9, 
   3.912356372469767*^9}, {3.91235657947683*^9, 3.91235665690681*^9}, {
   3.9123568215927153`*^9, 3.9123569810398607`*^9}, {3.916185544369575*^9, 
   3.9161855577306433`*^9}, {3.927926637737824*^9, 3.927926642298661*^9}},
 CellLabel->
  "In[494]:=",ExpressionUUID->"4b50a60d-5c89-4026-82d7-b87a5b4b31cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Covabcd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{"CovabcdTensor", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Covabcd", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{"CovabcdTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "Covabcd", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CovabcdInv", " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", "assumptions", "}"}], ",", " ", 
     RowBox[{"Inverse", "[", "Covabcd", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQveF9cF3t+jeOLr5OTSDa7JhuF4hmq+DuAdGTrn+b
BqJ5dBSmg+g1OxSNvgDpPROvg+nns2ZMsFJ761hzJXApiO7q3b8aRC9gLd4K
oh+8mOBho/7WkSuawxNENxS9NW3Wfet4zrnSDESbGecxdQDpmVYrwfSi853s
04H0rSQhDhCt9Wjt/RfObx03KewH02e2r30Mot+ufv0ERH9bkcr+EkgHyV8F
0zEx7otB9In6OjCtdqN8PYhO+mq/BUQ36avuBNET/5ruAtGztvw8BqKf6Xqd
BNGXz8rveA2kj+/yBNMLZvu/fwOkOw+9ANMcsTkf/wPpP6uWgmkAsiWuJw==

  "],
 CellLabel->
  "In[497]:=",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{
  3.9279200009312162`*^9, 3.927920036155335*^9, {3.927920075389688*^9, 
   3.92792008593503*^9}, 3.92792020300742*^9, 3.9279241631233377`*^9, 
   3.927926660215217*^9, 3.927926699009061*^9, 3.927965582041223*^9, 
   3.9279659280106497`*^9},
 CellLabel->
  "Out[506]=",ExpressionUUID->"21706293-d026-41d0-a157-cf7406bb0868"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "derivatives", " ", "of", " ", "ClTT"}], ",", 
    " ", "ClTy", ",", " ", 
    RowBox[{
    "and", " ", "Clyy", " ", "with", " ", "respect", " ", "to", " ", "Acmb", 
     " ", "and", " ", "Atsz", " ", 
     RowBox[{"(", 
      RowBox[{
      "use", " ", "expressions", " ", "from", " ", "earlier", " ", "in", " ", 
       "notebook", " ", "with", " ", "Acmb", " ", "and", " ", "Atsz", " ", 
       "inserted", " ", "next", " ", "to", " ", "CC", " ", "and", " ", "T", 
       " ", "respectively"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTT", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTT", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTy", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTy", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Clyy", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Clyy", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", " ", "derivClTTAcmb", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivAcmbILC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "derivClTTAcmb", ",", " ", "derivClTyAcmb", ",", " ", "derivClyyAcmb"}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivAtszILC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "derivClTTAtsz", ",", " ", "derivClTyAtsz", ",", " ", "derivClyyAtsz"}],
       "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzk0og3EAx/ExsrCLly0MLSLLRiOb9/6ovXgL2Uuz8p4U85qDwhyEA+Oi
rHAQbsxFyUUpL81WK4kkZZnxPGuEJYr9nsO3z/UrbDc1doWyWCxBMFhjjT3+
2KWIw3d/Cj1tYjtMXoq8h5yyJDdUlpu98Oe2gP0ZdOROGw7lFOFB6foRH5Y8
JSbD2UVuLpz4FebDOFVrITwbNFbAgHC4Cl4YolQw4fBKDZU+VQMU8AYYR7bq
tfBuzW2EMfraDmjZtJngzjx7FPYVLTG6RLYVeBLRsgol2SHXcF+jvYHdusAL
7DG3/DL/zu/or6APE0IunCnN4sF4wYYAhplL0hV7FBm7dTJ6XJN5BhtFqL7c
OqhUmJrgwmWKHor61UNzQc8O+hkfdG+evX2K2L02L6RqA6nFGTR53P5Lh/Ll
TqsskyaSnPM1yG9WXEyLaaLxcxzwdSqnqVpKE0vvswa6n8b9VCVNEtNk7/Af
voL5Jg==
  "],
 CellLabel->
  "In[508]:=",ExpressionUUID->"3d6b127a-5a9a-49a2-b7fe-3623bf033a7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "Fisher", " ", "matrix", " ", "from", " ", "ILC", " ", 
    "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FisherAcmbILC", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAcmbILC", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAcmbILC", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAtszILC", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAtszILC", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAtszILC", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbAtszILC", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAcmbILC", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAtszILC", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAtszILC", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAcmbILC", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherILC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"FisherAcmbILC", ",", " ", "FisherAcmbAtszILC"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"FisherAcmbAtszILC", ",", "FisherAtszILC"}], "}"}]}], "}"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85034950498853*^9, 3.850349509828374*^9}, {
   3.850349574858923*^9, 3.850349597911985*^9}, {3.8503501515145063`*^9, 
   3.850350174863008*^9}, {3.850517816131082*^9, 3.8505178194977922`*^9}, 
   3.851176862907642*^9, {3.912357679010384*^9, 3.912357701047683*^9}, {
   3.9123579601315203`*^9, 3.912357976278566*^9}, {3.9123581884384537`*^9, 
   3.91235820585118*^9}, {3.912358616943062*^9, 3.912358617130588*^9}, {
   3.9128763027573643`*^9, 3.912876427577269*^9}, {3.91287645986346*^9, 
   3.912876464311139*^9}, {3.912884769229219*^9, 3.9128847944983473`*^9}, {
   3.9128848333837843`*^9, 3.912884847689084*^9}, {3.9128854545155993`*^9, 
   3.91288547640895*^9}, {3.912885869119712*^9, 3.912885953054233*^9}, {
   3.91288633267043*^9, 3.9128864079380198`*^9}, {3.916174977981307*^9, 
   3.9161749782844887`*^9}, {3.916216415521246*^9, 3.916216421564374*^9}, {
   3.927925875334304*^9, 3.927925895497457*^9}, {3.9279267057257967`*^9, 
   3.927926726949525*^9}, {3.9279655904334*^9, 3.9279656239205103`*^9}},
 CellLabel->
  "In[522]:=",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "final", " ", "covariance", " ", "matrix", " ", "from", 
    " ", "HILC", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FinalCovILC", " ", "=", " ", 
    RowBox[{"Inverse", "[", "FisherILC", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850349516022242*^9, 3.850349626346944*^9}, {
  3.850350209246752*^9, 3.850350218842215*^9}, {3.8503502589937963`*^9, 
  3.8503502599082937`*^9}, {3.85035083617115*^9, 3.85035084700953*^9}, {
  3.8503538388738003`*^9, 3.850353845960312*^9}, {3.850360123321699*^9, 
  3.850360130483348*^9}, {3.912356052955002*^9, 3.9123560606028013`*^9}, {
  3.91235770878484*^9, 3.912357712933118*^9}, {3.9123579806033783`*^9, 
  3.9123579807899218`*^9}, {3.912875593778928*^9, 3.9128755987400312`*^9}, {
  3.912875729701529*^9, 3.912875732019967*^9}, {3.916174983283711*^9, 
  3.9161749836694803`*^9}, {3.916216398852646*^9, 3.916216399336323*^9}, {
  3.916219010456493*^9, 3.916219012204159*^9}, {3.927925900664382*^9, 
  3.9279259026219463`*^9}, {3.927926732052781*^9, 3.927926735710147*^9}, {
  3.927965644710655*^9, 3.927965646427498*^9}},
 CellLabel->
  "In[526]:=",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Begin", " ", "multifrequency", " ", "template", " ", "fitting", " ", 
    "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "inverse", " ", "of", " ", "power", " ", "spectrum", " ", 
    "covariance", " ", "matrix", " ", 
    RowBox[{"Clij", "^", 
     RowBox[{"-", "1"}]}], " ", "and", " ", "the", " ", "associated", " ", 
    "tensor"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PScovInv", " ", "=", " ", 
     RowBox[{"Inverse", "[", "PScovFull", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PScovInvTensor", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"a", "=", "1"}], ",", 
     RowBox[{"a", "<=", "3"}], ",", 
     RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"b", "=", "1"}], ",", 
       RowBox[{"b", "<=", "3"}], ",", 
       RowBox[{"b", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"c", "=", "1"}], ",", 
         RowBox[{"c", "<=", "3"}], ",", 
         RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"d", "=", "1"}], ",", 
           RowBox[{"d", "<=", "3"}], ",", 
           RowBox[{"d", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idxa", " ", "=", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"a", "==", "b", "==", "1"}], ",", " ", "1", ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"a", "==", "b", "==", "2"}], ",", " ", "2", ",", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"a", "==", "b", "==", "3"}], ",", " ", "3", ",", 
                   " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], " ", "&&", 
                    RowBox[{"b", "==", "2"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "2"}], " ", "&&", " ", 
                    RowBox[{"b", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "4",
                     ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "1"}], "&&", 
                    RowBox[{"b", "==", "3"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "==", "3"}], " ", "&&", " ", 
                    RowBox[{"b", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "5",
                     ",", " ", "6"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"idxb", " ", "=", "  ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"c", "==", "d", "==", "1"}], ",", " ", "1", ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"c", "==", "d", "==", "2"}], ",", " ", "2", ",", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"c", "==", "d", "==", "3"}], ",", " ", "3", ",", 
                   " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "1"}], " ", "&&", 
                    RowBox[{"d", "==", "2"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "2"}], " ", "&&", " ", 
                    RowBox[{"d", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "4",
                     ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "1"}], "&&", 
                    RowBox[{"d", "==", "3"}]}], ")"}], " ", "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", "==", "3"}], " ", "&&", " ", 
                    RowBox[{"d", "==", "1"}]}], ")"}]}], ")"}], ",", " ", "5",
                     ",", " ", "6"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PScovInvTensor", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], " ",
              "=", " ", 
             RowBox[{"PScovInv", "[", 
              RowBox[{"[", 
               RowBox[{"idxa", ",", " ", "idxb"}], "]"}], "]"}]}], " ", 
            ";"}]}], "\[IndentingNewLine]", "\t", "]"}]}], "]"}]}], "]"}]}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8503496400147123`*^9, 3.850349654350348*^9}, {
   3.8503497908572073`*^9, 3.8503497978710814`*^9}, {3.850349878403522*^9, 
   3.850349886056686*^9}, {3.85034993506516*^9, 3.850350027390441*^9}, {
   3.850350081207139*^9, 3.850350085493299*^9}, {3.850354087923471*^9, 
   3.850354094474616*^9}, {3.850354125284993*^9, 3.850354161519226*^9}, {
   3.850354210567197*^9, 3.850354224528007*^9}, {3.850354292756077*^9, 
   3.850354295342491*^9}, {3.850354361218829*^9, 3.850354362650098*^9}, {
   3.850355512960595*^9, 3.850355517830956*^9}, {3.850355592082144*^9, 
   3.8503556945546837`*^9}, {3.8503558183935328`*^9, 
   3.8503558213751707`*^9}, {3.850355862239695*^9, 3.850355862571498*^9}, {
   3.8503564617574*^9, 3.850356464796698*^9}, {3.850358682822667*^9, 
   3.8503587488098993`*^9}, {3.850358794002527*^9, 3.850358832500148*^9}, {
   3.850358866527831*^9, 3.850358912497348*^9}, 3.850359117661935*^9, {
   3.8503602492888603`*^9, 3.850360251119399*^9}, {3.850360284619053*^9, 
   3.850360484061838*^9}, {3.8503905177758913`*^9, 3.850390577682815*^9}, {
   3.850392744514257*^9, 3.850392748281014*^9}, {3.850392826907902*^9, 
   3.8503928482054653`*^9}, {3.8503942427038937`*^9, 3.850394263038974*^9}, {
   3.850399164204639*^9, 3.850399230813457*^9}, {3.8503995291376123`*^9, 
   3.850399543546097*^9}, {3.850399629073423*^9, 3.850399631962167*^9}, {
   3.8503996822963457`*^9, 3.850399688602214*^9}, {3.85039972404904*^9, 
   3.850399725387488*^9}, {3.8504002795194407`*^9, 3.8504003088129787`*^9}, {
   3.850518950334333*^9, 3.850518952616405*^9}, {3.916174996881249*^9, 
   3.916175000451489*^9}, {3.916217855233227*^9, 3.91621786123925*^9}, {
   3.91621789226413*^9, 3.916217915990073*^9}, {3.9279259148959227`*^9, 
   3.927925915330316*^9}, {3.927926740062848*^9, 3.9279267409042892`*^9}, {
   3.927965652299464*^9, 3.9279656747499847`*^9}},
 CellLabel->
  "In[527]:=",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "Fisher", " ", "matrix", " ", "from", " ", 
    "multifrequency", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"derivCl11Acmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "Acmb"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl11Atsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "Atsz"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl12Acmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "Acmb"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl12Atsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "Atsz"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl13Acmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "Acmb"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl13Atsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "Atsz"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl22Acmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "Acmb"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl22Atsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "Atsz"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl23Acmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "Acmb"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl23Atsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", "Atsz"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl33Acmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "Acmb"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivCl33Atsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Clij", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "Atsz"}], "]"}], 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivAcmbmult", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "derivCl11Acmb", ",", " ", "derivCl22Acmb", ",", " ", "derivCl33Acmb", 
       ",", " ", "derivCl12Acmb", ",", " ", "derivCl13Acmb", ",", " ", 
       "derivCl23Acmb"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivAtszmult", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "derivCl11Atsz", ",", " ", "derivCl22Atsz", ",", " ", "derivCl33Atsz", 
       ",", " ", "derivCl12Atsz", ",", " ", "derivCl13Atsz", ",", " ", 
       "derivCl23Atsz"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbmult", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAcmbmult", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAcmbmult", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"PScovInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAtszmult", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAtszmult", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAtszmult", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"PScovInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbAtszmult", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAcmbmult", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAtszmult", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"PScovInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAtszmult", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAcmbmult", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"PScovInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fishermult", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"FisherAcmbmult", ",", " ", "FisherAcmbAtszmult"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"FisherAcmbAtszmult", ",", "FisherAtszmult"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FinalCovMult", " ", "=", " ", 
     RowBox[{"Inverse", "[", "Fishermult", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.850351206483547*^9, 3.8503512632120237`*^9}, {
   3.850360500871291*^9, 3.8503605209466867`*^9}, {3.8503605644973173`*^9, 
   3.850360567881268*^9}, {3.850518523986722*^9, 3.8505185287438593`*^9}, {
   3.850520397410143*^9, 3.850520397624772*^9}, {3.8505220180807*^9, 
   3.8505220242855*^9}, {3.851082551020994*^9, 3.8510825514764843`*^9}, {
   3.912357992875286*^9, 3.912358034629939*^9}, {3.9123582299586487`*^9, 
   3.912358252381942*^9}, {3.912358330138082*^9, 3.912358602316607*^9}, 
   3.912874863078413*^9, {3.9128753419067383`*^9, 3.9128753500532913`*^9}, {
   3.9128754427700987`*^9, 3.912875443563072*^9}, {3.912875625149267*^9, 
   3.912875630967787*^9}, {3.912875718651389*^9, 3.912875720774786*^9}, {
   3.912875802290146*^9, 3.912875802907237*^9}, {3.916175008950409*^9, 
   3.916175029731086*^9}, {3.916217191306731*^9, 3.916217423008774*^9}, {
   3.916217937626099*^9, 3.9162179591918592`*^9}, 3.9162190366557693`*^9, {
   3.9279656870817842`*^9, 3.9279656886486464`*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "quick", " ", "idea", " ", "of", " ", "whether", " ", "final",
      " ", "covariance", " ", "matrices", " ", "from", " ", "ILC", " ", "and",
      " ", "multifrequency", " ", "are", " ", "equal"}], ",", " ", 
    RowBox[{
    "check", " ", "using", " ", "some", " ", "numerical", " ", "values", " ", 
     "with", " ", "realistic", " ", "ILC", " ", "weights"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g1Num", " ", "=", " ", 
     RowBox[{"-", "4.356"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g2Num", "  ", "=", " ", 
     RowBox[{"-", "2.5997"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g3Num", " ", "=", " ", 
     RowBox[{"-", "5.997"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gvecNum", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"g1Num", ",", " ", "g2Num", ",", " ", "g3Num"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CCNum", " ", "=", " ", 
     RowBox[{"0.4", " ", "*", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "8"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TNum", " ", "=", " ", 
     RowBox[{"0.3", " ", "*", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "8"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N1Num", " ", "=", " ", 
     RowBox[{"9.05", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "10"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N2Num", " ", "=", " ", 
     RowBox[{"1.1", "*", "N1Num"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N3Num", " ", "=", " ", 
     RowBox[{"2.0", "*", "N1Num"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClijNoAInvNum", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CC", "=", "CCNum"}], ",", " ", 
         RowBox[{"T", "=", "TNum"}], ",", "  ", 
         RowBox[{"g1", "=", "g1Num"}], ",", " ", 
         RowBox[{"g2", "=", "g2Num"}], ",", "  ", 
         RowBox[{"g3", "=", "g3Num"}], ",", 
         RowBox[{"N1", "=", "N1Num"}], ",", " ", 
         RowBox[{"N2", "=", "N2Num"}], ",", " ", 
         RowBox[{"N3", "=", "N3Num"}], ",", " ", 
         RowBox[{"Nmodes", "=", "3001"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "ClijNoAInv", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w1cmbNum", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ClijNoAInvNum", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "j"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ClijNoAInvNum", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "l"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2cmbNum", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ClijNoAInvNum", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "j"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ClijNoAInvNum", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "l"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w3cmbNum", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ClijNoAInvNum", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "j"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ClijNoAInvNum", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "l"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w1yNum", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"ClijNoAInvNum", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "*", 
         RowBox[{"ClijNoAInvNum", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l"}], "]"}], "]"}], "*", 
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2yNum", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"ClijNoAInvNum", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "j"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "*", 
         RowBox[{"ClijNoAInvNum", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l"}], "]"}], "]"}], "*", 
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w3yNum", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"ClijNoAInvNum", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "j"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "*", 
         RowBox[{"ClijNoAInvNum", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l"}], "]"}], "]"}], "*", 
         RowBox[{"gvecNum", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CC", "=", "CCNum"}], ",", " ", 
        RowBox[{"T", "=", "TNum"}], ",", " ", 
        RowBox[{"g1", "=", "g1Num"}], ",", " ", 
        RowBox[{"g2", "=", "g2Num"}], ",", "  ", 
        RowBox[{"g3", "=", "g3Num"}], ",", 
        RowBox[{"N1", "=", "N1Num"}], ",", " ", 
        RowBox[{"N2", "=", "N2Num"}], ",", " ", 
        RowBox[{"N3", "=", "N3Num"}], ",", " ", 
        RowBox[{"Nmodes", "=", "3001"}], ",", "  ", 
        RowBox[{"w1cmb", "=", "w1cmbNum"}], ",", " ", 
        RowBox[{"w2cmb", "=", "w2cmbNum"}], ",", " ", 
        RowBox[{"w3cmb", "=", "w3cmbNum"}], ",", " ", 
        RowBox[{"w1y", "=", "w1yNum"}], ",", " ", 
        RowBox[{"w2y", "=", "w2yNum"}], ",", " ", 
        RowBox[{"w3y", "=", "w3yNum"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "FinalCovILC", "]"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CC", "=", "CCNum"}], ",", " ", 
        RowBox[{"T", "=", "TNum"}], ",", " ", 
        RowBox[{"g1", "=", "g1Num"}], ",", " ", 
        RowBox[{"g2", "=", "g2Num"}], ",", "  ", 
        RowBox[{"g3", "=", "g3Num"}], ",", 
        RowBox[{"N1", "=", "N1Num"}], ",", " ", 
        RowBox[{"N2", "=", "N2Num"}], ",", " ", 
        RowBox[{"N3", "=", "N3Num"}], ",", " ", 
        RowBox[{"Nmodes", "=", "3001"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "FinalCovMult", "]"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\n", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.850351271104641*^9, 3.850351296476169*^9}, {
   3.850355875846406*^9, 3.850355905899435*^9}, {3.850360545180888*^9, 
   3.8503605498940563`*^9}, {3.850360672509582*^9, 3.850360678869467*^9}, {
   3.850518617440613*^9, 3.850518631620695*^9}, {3.85051873631888*^9, 
   3.850518751618104*^9}, {3.850520457595566*^9, 3.850520482106653*^9}, {
   3.850520556251568*^9, 3.850520562191472*^9}, {3.8505207309376583`*^9, 
   3.850520736040427*^9}, {3.8505212461870737`*^9, 3.85052124648522*^9}, {
   3.850522102804269*^9, 3.8505221193104477`*^9}, 3.9123560764128113`*^9, {
   3.912358634235312*^9, 3.912358643622941*^9}, {3.91287564034875*^9, 
   3.912875652284721*^9}, {3.912875693353619*^9, 3.912875724024167*^9}, {
   3.912875773392749*^9, 3.912875776630146*^9}, {3.916216523529645*^9, 
   3.916216552518114*^9}, {3.916216591600518*^9, 3.916216607916978*^9}, {
   3.916216665580818*^9, 3.916216673733027*^9}, {3.9162179770568953`*^9, 
   3.916217987209199*^9}, {3.916218201376318*^9, 3.9162182155768213`*^9}, {
   3.916219399492625*^9, 3.916219420355426*^9}, {3.927904094829487*^9, 
   3.927904108745453*^9}, {3.92790418457714*^9, 3.92790423388739*^9}, {
   3.927904376050984*^9, 3.9279043852561703`*^9}, {3.927904485045542*^9, 
   3.927904532960232*^9}, {3.927911524824086*^9, 3.927911532842676*^9}, {
   3.927926509599925*^9, 3.927926510420987*^9}, {3.927965933084155*^9, 
   3.9279664057376204`*^9}, {3.9279664691057243`*^9, 
   3.9279664885107603`*^9}, {3.927971174092387*^9, 3.927971225376992*^9}, {
   3.927971604155861*^9, 
   3.9279716063342657`*^9}},ExpressionUUID->"0a153ff8-2438-42d0-a366-\
cc118750013b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"7.900085524712681`", 
      RowBox[{"-", "0.14426990928408395`"}]},
     {
      RowBox[{"-", "0.14426990928408395`"}], "2.1778118149187864`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.850355906809094*^9, 3.850360495190134*^9, 3.850360574719036*^9, 
   3.85036061346474*^9, 3.850360962706068*^9, 3.8505189485289803`*^9, 
   3.850518997773788*^9, 3.8505190320029907`*^9, 3.850520445552864*^9, 
   3.8505204859194727`*^9, 3.850520566307926*^9, 3.8505207400199413`*^9, 
   3.8505212525933867`*^9, 3.85052203449234*^9, {3.8505221123532267`*^9, 
   3.8505221214016247`*^9}, 3.8510824805972157`*^9, 3.851082559525449*^9, 
   3.851176930833293*^9, 3.851781984332346*^9, 3.893697228912821*^9, 
   3.912358676702755*^9, 3.9123591061393147`*^9, 3.912853891133017*^9, 
   3.912873636085096*^9, 3.912873741960472*^9, 3.912874050656783*^9, {
   3.912875634697384*^9, 3.912875652748667*^9}, {3.912875683499145*^9, 
   3.912875698260291*^9}, {3.912875740666649*^9, 3.912875777279523*^9}, 
   3.9161752064578533`*^9, 3.916216501789535*^9, {3.916216533043416*^9, 
   3.91621655518582*^9}, 3.916216608889412*^9, 3.916216675606998*^9, {
   3.916217966579484*^9, 3.916217989571871*^9}, 3.9162182185914307`*^9, {
   3.916219072854561*^9, 3.916219075084613*^9}, {3.91621940091986*^9, 
   3.9162194210930357`*^9}, 3.927762583880577*^9, 3.9279039018639603`*^9, {
   3.9279041792994127`*^9, 3.927904194217025*^9}, 3.927904234851725*^9, 
   3.927904386068169*^9, 3.927904533794416*^9, 3.9279048482717*^9, 
   3.927905029359954*^9, 3.927908159149344*^9, 3.927911541128627*^9, 
   3.92792594683982*^9, 3.927926399339013*^9, 3.927926515029674*^9, 
   3.9279657112160254`*^9, 3.927966406898386*^9, 3.9279664892265663`*^9},
 CellLabel->
  "Out[581]//MatrixForm=",ExpressionUUID->"4cb104e9-3b7b-44fb-9282-\
4fbc71ae1008"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"7.770352337018162`", 
      RowBox[{"-", "0.1365948099571383`"}]},
     {
      RowBox[{"-", "0.1365948099571383`"}], "2.1719191111261265`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.850355906809094*^9, 3.850360495190134*^9, 3.850360574719036*^9, 
   3.85036061346474*^9, 3.850360962706068*^9, 3.8505189485289803`*^9, 
   3.850518997773788*^9, 3.8505190320029907`*^9, 3.850520445552864*^9, 
   3.8505204859194727`*^9, 3.850520566307926*^9, 3.8505207400199413`*^9, 
   3.8505212525933867`*^9, 3.85052203449234*^9, {3.8505221123532267`*^9, 
   3.8505221214016247`*^9}, 3.8510824805972157`*^9, 3.851082559525449*^9, 
   3.851176930833293*^9, 3.851781984332346*^9, 3.893697228912821*^9, 
   3.912358676702755*^9, 3.9123591061393147`*^9, 3.912853891133017*^9, 
   3.912873636085096*^9, 3.912873741960472*^9, 3.912874050656783*^9, {
   3.912875634697384*^9, 3.912875652748667*^9}, {3.912875683499145*^9, 
   3.912875698260291*^9}, {3.912875740666649*^9, 3.912875777279523*^9}, 
   3.9161752064578533`*^9, 3.916216501789535*^9, {3.916216533043416*^9, 
   3.91621655518582*^9}, 3.916216608889412*^9, 3.916216675606998*^9, {
   3.916217966579484*^9, 3.916217989571871*^9}, 3.9162182185914307`*^9, {
   3.916219072854561*^9, 3.916219075084613*^9}, {3.91621940091986*^9, 
   3.9162194210930357`*^9}, 3.927762583880577*^9, 3.9279039018639603`*^9, {
   3.9279041792994127`*^9, 3.927904194217025*^9}, 3.927904234851725*^9, 
   3.927904386068169*^9, 3.927904533794416*^9, 3.9279048482717*^9, 
   3.927905029359954*^9, 3.927908159149344*^9, 3.927911541128627*^9, 
   3.92792594683982*^9, 3.927926399339013*^9, 3.927926515029674*^9, 
   3.9279657112160254`*^9, 3.927966406898386*^9, 3.927966492294709*^9},
 CellLabel->
  "Out[582]//MatrixForm=",ExpressionUUID->"67466410-59a3-4cf5-9e33-\
ab289b00c68b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Analytically", " ", "compare", " ", "final", " ", "covariance", " ", 
   "matrices", " ", "from", " ", "ILC", " ", "and", " ", "multifrequency"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9279152136500263`*^9, 3.927915217313287*^9}, {
   3.927915307115666*^9, 3.927915361002852*^9}, {3.927915862062936*^9, 
   3.9279158634186697`*^9}, {3.927915915938799*^9, 3.927915917760406*^9}, 
   3.927916684351636*^9, 3.927916777303073*^9, {3.927965709517494*^9, 
   3.927965738677763*^9}},ExpressionUUID->"861e03fc-55e4-4537-ae9d-\
07817338fd69"],

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"{", "assumptions", "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"FinalCovILC", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"FinalCovMult", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ">", "0"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.927916151979945*^9, 3.927916230913809*^9}, {
  3.92791906082837*^9, 3.927919062201166*^9}, {3.927920051121222*^9, 
  3.927920062594713*^9}, {3.927965723504388*^9, 3.927965723735571*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"bc3d0f96-691a-46c3-bc9d-750aea073a62"],

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"{", "assumptions", "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"FinalCovILC", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"FinalCovMult", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ">", "0"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.927916265152692*^9, 3.9279162696509933`*^9}, {
   3.927916674711812*^9, 3.927916715850696*^9}, 3.927919068615182*^9, {
   3.9279201131049833`*^9, 3.9279201183989983`*^9}, 3.927965722063924*^9},
 CellLabel->
  "In[354]:=",ExpressionUUID->"a787ccb9-5040-4c9e-9c0c-50f2bd179d86"],

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"{", "assumptions", "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"FinalCovILC", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"FinalCovMult", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ">", "0"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.927920231424871*^9, 3.927920235909333*^9}, 
   3.927965725112361*^9},
 CellLabel->
  "In[355]:=",ExpressionUUID->"8c213d1e-ce1b-4e3b-88f2-273bff5c149d"]
},
WindowSize->{1233, 746},
WindowMargins->{{73, Automatic}, {-187, Automatic}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"839a2295-dbf7-4c58-9138-edbdf0665a83"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1549, 39, 73, "Input",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],
Cell[CellGroupData[{
Cell[2132, 63, 2069, 50, 77, "Input",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],
Cell[4204, 115, 2209, 56, 89, "Output",ExpressionUUID->"399797ed-a789-49a4-a24b-8b7d47530b13"]
}, Open  ]],
Cell[6428, 174, 397, 9, 52, "Input",ExpressionUUID->"6574f643-d4b1-4604-970a-deca9402bd10"],
Cell[CellGroupData[{
Cell[6850, 187, 4547, 114, 243, "Input",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],
Cell[11400, 303, 861, 17, 34, "Output",ExpressionUUID->"e2597b7a-c8c4-46f5-81ab-8b905fc106e8"]
}, Open  ]],
Cell[12276, 323, 3404, 82, 94, "Input",ExpressionUUID->"2a5c4249-e0ed-410e-8c3e-5a3f596868af"],
Cell[15683, 407, 1135, 15, 30, "Input",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],
Cell[16821, 424, 1423, 35, 73, "Input",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],
Cell[CellGroupData[{
Cell[18269, 463, 7362, 173, 451, "Input",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],
Cell[25634, 638, 372, 7, 34, "Output",ExpressionUUID->"4439dd46-950f-4e78-96e0-561dc5dd6aad"]
}, Open  ]],
Cell[26021, 648, 3444, 82, 262, "Input",ExpressionUUID->"4b50a60d-5c89-4026-82d7-b87a5b4b31cf"],
Cell[CellGroupData[{
Cell[29490, 734, 3358, 101, 262, "Input",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],
Cell[32851, 837, 372, 7, 34, "Output",ExpressionUUID->"21706293-d026-41d0-a157-cf7406bb0868"]
}, Open  ]],
Cell[33238, 847, 4944, 136, 346, "Input",ExpressionUUID->"3d6b127a-5a9a-49a2-b7fe-3623bf033a7d"],
Cell[38185, 985, 4423, 109, 157, "Input",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],
Cell[42611, 1096, 1253, 22, 52, "Input",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],
Cell[43867, 1120, 7420, 159, 367, "Input",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],
Cell[51290, 1281, 11793, 319, 493, "Input",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],
Cell[CellGroupData[{
Cell[63108, 1604, 10828, 274, 556, "Input",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],
Cell[73939, 1880, 2228, 42, 63, "Output",ExpressionUUID->"4cb104e9-3b7b-44fb-9282-4fbc71ae1008"],
Cell[76170, 1924, 2224, 42, 63, "Output",ExpressionUUID->"67466410-59a3-4cf5-9e33-ab289b00c68b"]
}, Open  ]],
Cell[78409, 1969, 582, 11, 30, "Input",ExpressionUUID->"861e03fc-55e4-4537-ae9d-07817338fd69"],
Cell[78994, 1982, 654, 17, 30, "Input",ExpressionUUID->"bc3d0f96-691a-46c3-bc9d-750aea073a62"],
Cell[79651, 2001, 661, 17, 30, "Input",ExpressionUUID->"a787ccb9-5040-4c9e-9c0c-50f2bd179d86"],
Cell[80315, 2020, 537, 16, 30, "Input",ExpressionUUID->"8c213d1e-ce1b-4e3b-88f2-273bff5c149d"]
}
]
*)

