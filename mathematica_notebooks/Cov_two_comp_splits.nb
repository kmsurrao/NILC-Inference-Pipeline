(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90422,       2335]
NotebookOptionsPosition[     85827,       2277]
NotebookOutlinePosition[     86222,       2293]
CellTagsIndexPosition[     86179,       2290]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "matrix", " ", "of", " ", "auto"}], "-", " ", 
    RowBox[{"and", " ", "cross"}], "-", 
    RowBox[{
    "frequency", " ", "power", " ", "spectra", " ", "at", " ", "some", " ", 
     "multipole", " ", "ell"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"here", ",", " ", 
    RowBox[{"CC", " ", "=", " ", 
     RowBox[{"C_ell", "^", "CMB"}]}], " ", ",", " ", 
    RowBox[{"N1", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq1", "}"}]}]}], " ", ",", " ", 
    RowBox[{"N2", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq2", "}"}]}]}], " ", ",", " ", 
    RowBox[{"g1", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq1"}]}], 
    ",", " ", 
    RowBox[{"g2", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq2"}]}], 
    ",", " ", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{"C_ell", "^", "yy"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "tSZ", " ", "power", " ", "spectrum", " ", "in", " ", "frequency"}], 
        "-", 
        RowBox[{"independent", " ", "Compton"}], "-", 
        RowBox[{"y", " ", "units"}]}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Update", ":", " ", 
     RowBox[{
     "account", " ", "here", " ", "for", " ", "the", " ", "fact", " ", "that",
       " ", "we", " ", "have", " ", "to", " ", "make", " ", "two", " ", 
      "independent", " ", "ILC", " ", "maps", " ", "from", " ", "separate", 
      " ", "subsets", " ", "of", " ", "the", " ", "data"}]}], ";", " ", 
    RowBox[{"to", " ", "be", " ", "fully", " ", "general", " ", 
     RowBox[{"let", "'"}], "s", " ", "allow", " ", "them", " ", "to", " ", 
     "each", " ", "have", " ", "their", " ", "own", " ", "arbitrary", " ", 
     "noise", " ", "power", " ", "spectra", " ", 
     RowBox[{"(", 
      RowBox[{
      "later", " ", "we", " ", "can", " ", "specialize", " ", "to", " ", 
       "the", " ", "case", " ", "where", " ", "they", " ", "are", " ", 
       "equal"}], ")"}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8500974654435797`*^9, 3.850097474804103*^9}, {
   3.850097512768484*^9, 3.850097605412682*^9}, 3.850097643969492*^9, {
   3.850702624983939*^9, 3.850702667214251*^9}, {3.850707987162773*^9, 
   3.850708021753458*^9}},
 CellLabel->
  "In[699]:=",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClijSplit1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1Split1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2Split1", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit1noA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1Split1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], "T"}]}], ",", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ",", 
       RowBox[{"CC", "+", "N2Split1", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "ClijSplit1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1Split2", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2Split2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2noA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1Split2", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ",", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", " ", "T"}]}], ",", 
       RowBox[{"CC", "+", "N2Split2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "ClijSplit2", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.85009745416115*^9, 3.850097455840989*^9}, {
  3.850097507223783*^9, 3.850097508147098*^9}, {3.850097619328155*^9, 
  3.8500976307601347`*^9}, {3.8507026691738987`*^9, 3.850702677763043*^9}, {
  3.850708026981884*^9, 3.8507080771403008`*^9}, {3.893700516688171*^9, 
  3.89370066096591*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClijSplit1Inv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2Inv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit1noAInv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit1noA", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijSplit2noAInv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijSplit2noA", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850708116348671*^9, 3.850708130230506*^9}, 
   3.850831219621644*^9, 3.851612297577784*^9, {3.893700672956503*^9, 
   3.893700697069837*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"2f9d2e15-0d49-4cdb-bf16-a4240c685d25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"also", " ", "define", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"cross", "'"}], " ", "Clij"}], ",", " ", 
    RowBox[{
     RowBox[{
     "which", " ", "has", " ", "no", " ", "noise", " ", "as", " ", "it", " ", 
      "comes", " ", "from", " ", "cross"}], "-", 
     RowBox[{
     "power", " ", "of", " ", "two", " ", "independent", " ", "subsets", " ", 
      "of", " ", "the", " ", "data"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClijNoNoise", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{
           SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", 
         RowBox[{
          RowBox[{"Acmb", " ", "CC"}], "+", 
          RowBox[{
           SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "have", " ", "free", " ", "parameters", " ", "but", " ", "weights", " ", 
     RowBox[{"don", "'"}], "t"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "ClijNoNoise", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850706157245708*^9, 3.85070620271761*^9}, {
  3.851010120401086*^9, 3.8510101283455687`*^9}, {3.851014086292117*^9, 
  3.851014111466357*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"0bb951f3-b1d8-4f5f-8b7f-9906015e0846"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gvec", "=", 
   RowBox[{"{", 
    RowBox[{"g1", ",", "g2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hvec", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"CMB", " ", "spectral", " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.850097695847044*^9, {3.850702861756133*^9, 3.8507028628665543`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"let", "'"}], "s", " ", "get", " ", "the", " ", "ILC", " ", 
    "weights", " ", "for", " ", "the", " ", "y"}], "-", 
   RowBox[{
   "maps", " ", "and", " ", "the", " ", "CMB", " ", "maps", " ", 
    "explicitly"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850098378793749*^9, 3.850098392042323*^9}, {
  3.8501038369203463`*^9, 3.850103838337369*^9}, {3.850708098090229*^9, 
  3.850708099254559*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"ed802296-cd4f-4f6b-80ba-47a10560f486"],

Cell[BoxData[{
 RowBox[{"weightsILCySplit1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit1noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit1noAInv", ".", "gvec"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCySplit2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit2noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijSplit2noAInv", ".", "gvec"}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.850098401291662*^9, 3.8500984313636293`*^9}, {
  3.8507080951339006`*^9, 3.850708095764429*^9}, {3.8507081375439*^9, 
  3.850708160240192*^9}, {3.893700717091535*^9, 3.89370073058888*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"aae96ca5-3198-45e6-9d92-3d79d37e4666"],

Cell[BoxData[{
 RowBox[{"weightsILCCMBSplit1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit1noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit1noAInv", ".", "hvec"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCCMBSplit2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit2noAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijSplit2noAInv", ".", "hvec"}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8501038433425922`*^9, 3.850103852404508*^9}, {
  3.8507081686193647`*^9, 3.850708186218322*^9}, {3.8937007366608143`*^9, 
  3.893700745108939*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"0440ec80-8221-4948-9d5d-7b2e05a13bbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"now", " ", "we", " ", "need", " ", "the", " ", "cross"}], "-", 
     RowBox[{
     "power", " ", "spectrum", " ", "of", " ", "ymap1", " ", "and", " ", 
      "ymap2"}]}], ",", " ", 
    RowBox[{"Tmap1", " ", "and", " ", "Tmap2"}], ",", " ", "etc"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClijNoNoiseInv", "=", 
    RowBox[{"Inverse", "[", "ClijNoNoise", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8507028934055777`*^9, 3.85070291541721*^9}, {
  3.8507062994622183`*^9, 3.8507063365322313`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"2ce40ba6-77ff-44fa-a1cb-64d409f8b458"],

Cell[BoxData[
 RowBox[{"ClyyCross", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
   "weightsILCySplit1", ".", "ClijNoNoise", ".", "weightsILCySplit2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.850706214458373*^9, 3.8507062188413153`*^9}, {
  3.850706378190468*^9, 3.85070649119973*^9}, {3.850706859089498*^9, 
  3.850706866045746*^9}, {3.850708303257577*^9, 3.850708308879075*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"5e903483-298c-407c-90ac-3c4e16f1c6a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "TT", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ClTTCross", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
    "weightsILCCMBSplit1", ".", "ClijNoNoise", ".", "weightsILCCMBSplit2"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.85070673085857*^9, 3.850706748076935*^9}, {
  3.850706943308916*^9, 3.85070695270888*^9}, {3.850706986709147*^9, 
  3.850706987749721*^9}, {3.8507084601212*^9, 3.850708463963833*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"017a879e-24ad-4c02-b8fb-f0e17fbf3732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "Ty"}], ",", " ", 
    RowBox[{
    "we", " ", "now", " ", "have", " ", "to", " ", "account", " ", "for", " ",
      "the", " ", "possible", " ", "difference", " ", "of", " ", "T_Split1", 
     " ", "x", " ", "y_Split2", " ", "and", " ", "T_split2", " ", "x", " ", 
     "y_Split1"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "these", " ", "will", " ", "be", " ", "equal", " ", "if", " ", "the", " ", 
    "noise", " ", "power", " ", "in", " ", "the", " ", "two", " ", "splits", 
    " ", "is", " ", "equal"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClTSplit1ySplit2Cross", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
     "weightsILCCMBSplit1", ".", "ClijNoNoise", ".", "weightsILCySplit2"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ClTSplit2ySplit1Cross", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
     "weightsILCCMBSplit2", ".", "ClijNoNoise", ".", "weightsILCySplit1"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8507069556222486`*^9, 3.850707010220037*^9}, {
  3.850708474018358*^9, 3.850708585520249*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"ebf5ecff-a778-422e-902e-b0c43dbc07a2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"NEED", " ", "TO", " ", "UPDATE", " ", "THE", " ", "FREQ"}], "-", 
    
    RowBox[{
    "FREQ", " ", "COV", " ", "MATRIX", " ", "TO", " ", "BE", " ", "CORRECT", 
     " ", "FOR", " ", "MEASUREMENTS", " ", "FROM", " ", "SPLITS"}]}], ",", 
   " ", 
   RowBox[{"I", ".", "E", "."}], ",", " ", 
   RowBox[{
    RowBox[{"ENTIRELY", " ", "CROSS"}], "-", 
    RowBox[{
     RowBox[{"SPECTRA", " ", "--"}], " ", "note", " ", "that", " ", "this", 
     " ", "means", " ", "the", " ", "150", "x90", " ", 
     RowBox[{"row", "/", "column"}], " ", "is", " ", "not", " ", "redundant", 
     " ", "now", " ", 
     RowBox[{"(", 
      RowBox[{
      "we", " ", "have", " ", "both", " ", "90", "_", "1", " ", "x", " ", 
       "150", "_", "2", " ", "and", " ", "150", "_", "1", " ", "x", " ", "90",
        "_", "2"}], ")"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850708652027328*^9, 3.850708670181693*^9}, {
   3.85070897239321*^9, 3.8507090118213778`*^9}, {3.850709169262329*^9, 
   3.850709205358961*^9}, 3.893757193785995*^9},
 CellLabel->
  "In[371]:=",ExpressionUUID->"5b898eea-17f6-4a1e-a531-c5fc3839954b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"first", ",", " ", 
    RowBox[{
     RowBox[{
     "construct", " ", "the", " ", "covariance", " ", "matrix", " ", "of", 
      " ", "the", " ", "auto"}], "-", " ", 
     RowBox[{"and", " ", "cross"}], "-", 
     RowBox[{"frequency", " ", "power", " ", "spectra"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "explicitly", " ", "include", " ", "150", "x90", " ", "terms", " ", "in", 
     " ", "power", " ", "spectrum", " ", "covariance", " ", "matrix"}], ",", 
    " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"it", " ", "is", " ", "a", " ", "4", "x4", " ", "matrix"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PScovFull", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "Nmodes"}], ")"}], "*", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"N1Split2", "+", "N1Split1"}], ")"}]}], "+", 
          RowBox[{"N1Split1", "*", "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N2Split2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N1Split1"}], " ", "+", " ", 
          RowBox[{"N1Split1", "*", "N2Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N1Split2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           "N2Split1"}], " ", "+", " ", 
          RowBox[{"N2Split1", "*", "N1Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split1"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "^", "2"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{"g1", "*", "g2", "*", "T"}]}], ")"}], "*", 
           "N2Split1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"CC", "+", 
              RowBox[{
               RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "^", "2"}]}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CC", "+", 
             RowBox[{
              RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"N2Split2", "+", "N2Split1"}], ")"}]}], "+", 
          RowBox[{"N2Split1", "*", "N2Split2"}]}]}], "}"}]}], "}"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.850101781156426*^9, 3.850101947487274*^9}, {
   3.8501019960010643`*^9, 3.850102085096258*^9}, {3.850102119280776*^9, 
   3.850102143544561*^9}, {3.850102200267356*^9, 3.850102233136145*^9}, {
   3.850708837675036*^9, 3.850708892290057*^9}, {3.850731792784863*^9, 
   3.850731794159615*^9}, {3.8507567274435263`*^9, 3.850756741013809*^9}, {
   3.8507663531762743`*^9, 3.850766378399605*^9}, 3.850766428319909*^9, {
   3.850766822713735*^9, 3.8507668312077427`*^9}, 3.850766974907403*^9, {
   3.8507674522856092`*^9, 3.8507674797960653`*^9}, {3.850767822986814*^9, 
   3.85076785341654*^9}, {3.850768083176412*^9, 3.850768112360352*^9}, {
   3.850768212743967*^9, 3.8507682151891727`*^9}, 3.8507683427201643`*^9, {
   3.850768511393067*^9, 3.850768572454584*^9}, {3.8507687996958323`*^9, 
   3.850768817705638*^9}, {3.8507689230748463`*^9, 3.850768951144392*^9}, {
   3.850768981199883*^9, 3.8507690197499332`*^9}, 3.850769152098724*^9, 
   3.8507691959934387`*^9, {3.850769397574573*^9, 3.8507694496395903`*^9}, {
   3.850769639166727*^9, 3.850769662098054*^9}, 3.85076970990269*^9, {
   3.8507697418893633`*^9, 3.8507697688439293`*^9}, {3.8507698768634644`*^9, 
   3.850769906256014*^9}, {3.850770133369478*^9, 3.850770134294134*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Nmodes", "*", "PScovFull"}], "]"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.850102237454474*^9, 3.850102251601574*^9}, {
  3.8508279297930326`*^9, 3.850827933724401*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"78b6aedf-982d-4dbf-aa72-f05a013c3cca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "we", " ", "are", " ", "really", " ", "representing", " ", "a", " ", 
      "four"}], "-", 
     RowBox[{"index", " ", "tensor"}]}], ",", " ", 
    RowBox[{
    "each", " ", "of", " ", "whose", " ", "indices", " ", "can", " ", "take", 
     " ", "2", " ", "values"}], ",", " ", 
    RowBox[{"as", " ", "a", " ", "4", "x4", " ", 
     RowBox[{"matrix", " ", "--"}], " ", "both", " ", "objects", " ", 
     "contain", " ", "16", " ", "elements"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "to", " ", "make", " ", "the", " ", "summ", "\[IndentingNewLine]", 
     "ation", " ", "in", " ", 
     RowBox[{"Eq", ".", " ", "21"}], " ", "straightforward"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "just", " ", "construct", " ", "the", 
      " ", "four"}], "-", 
     RowBox[{"index", " ", "tensor", " ", "explicitly"}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.850102297009666*^9, 3.850102300393331*^9}, {
   3.8501024445495653`*^9, 3.850102525922276*^9}, 3.851612336101012*^9, {
   3.9019584488968687`*^9, 
   3.901958450450715*^9}},ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-\
b460c1ab0052"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PScovFullTensor", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.850102529406659*^9, 3.850102532963168*^9}, {
  3.850102635776206*^9, 3.850102680133873*^9}, {3.850102808164304*^9, 
  3.850102844743293*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850102822907016*^9, 3.850102881013631*^9}, {
  3.850102939548687*^9, 3.850103116470541*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"now", " ", "compute", " ", "the", " ", "sum", " ", "in", " ", 
    RowBox[{"Eq", ".", " ", "21"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{
     "covariance", " ", "of", " ", "ILC", " ", "CMB", " ", "map", " ", 
      "power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClCMBCMB", ",", "ClCMBCMB"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClTT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClTT", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClTT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8501037946230087`*^9, 3.850103826071932*^9}, {
   3.8501038894304457`*^9, 3.8501039043584013`*^9}, {3.8501039917138147`*^9, 
   3.850103993005377*^9}, {3.850346897053793*^9, 3.85034690273654*^9}, {
   3.850823390216325*^9, 3.850823401755418*^9}, {3.850823465582614*^9, 
   3.850823481769793*^9}, {3.8508240170617123`*^9, 3.850824024647163*^9}, {
   3.850825067742313*^9, 3.850825069040217*^9}, 3.851612346036056*^9, {
   3.8516123941624193`*^9, 3.8516124146099987`*^9}, {3.9019584684471807`*^9, 
   3.90195846897779*^9}},ExpressionUUID->"67d94767-cec9-46e3-9c9d-\
7dbca1cf7588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "ClCMBy"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClTy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClTy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClTy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104449157226*^9, 3.850104514135442*^9}, {
   3.8503469341668787`*^9, 3.850346935303865*^9}, {3.850824113507674*^9, 
   3.8508241681249638`*^9}, {3.8508246220771847`*^9, 3.850824626491391*^9}, 
   3.851612354114291*^9},
 CellLabel->
  "In[287]:=",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClyT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClyT", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClyT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104656964769*^9, 3.850104669523221*^9}, {
   3.850346944794262*^9, 3.850346953475602*^9}, {3.8508241857122498`*^9, 
   3.8508242110072737`*^9}, {3.850824637553503*^9, 3.850824641372036*^9}, {
   3.8508261555387*^9, 3.850826185972095*^9}, 3.8516124410887833`*^9},
 CellLabel->
  "In[289]:=",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "Clyy"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTTClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTTClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTTClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8508242390013123`*^9, 3.850824258407641*^9}, {
   3.850824650486883*^9, 3.8508246553975763`*^9}, 3.8516124434294863`*^9},
 CellLabel->
  "In[291]:=",ExpressionUUID->"91c2cf13-d95a-403a-819f-42d53ea2dba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBy", ",", "ClCMBCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClTyClTT", " ", "=", " ", "CovClTTClTy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824305693244*^9, 3.8508243323746567`*^9}, {
   3.850824667385872*^9, 3.85082467167284*^9}, 3.8516124486802607`*^9},
 CellLabel->
  "In[293]:=",ExpressionUUID->"d1a0375d-b2ec-4c7c-a505-75632fbc2e83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{
     "covariance", " ", "of", " ", "ILC", " ", "CMB", " ", "map", " ", "x", 
      " ", "y"}], "-", 
     RowBox[{"map", " ", "cross"}], "-", 
     RowBox[{"power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClCMBy", ",", "ClCMBy"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTyClTy", "=", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTyClTy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTyClTy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824343692913*^9, 3.850824377554647*^9}, 
   3.850824487500639*^9, 3.851082960368474*^9, 3.8516124630543337`*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"988997b5-45d0-46b5-9d35-ed0d56506ba2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBy", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClTyClyT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTyClyT", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTyClyT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824394954919*^9, 3.850824421462598*^9}, {
   3.8508246833984613`*^9, 3.8508246875701723`*^9}, 3.8516124697749147`*^9},
 CellLabel->
  "In[296]:=",ExpressionUUID->"4805e1a6-9b6c-45e8-a9e3-bde8d5c28b62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBy", ",", "Clyy"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"CovClTyClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMBSplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClTyClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClTyClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104715447761*^9, 3.850104746702614*^9}, {
   3.850346965296616*^9, 3.8503469672360687`*^9}, {3.850824568568404*^9, 
   3.850824590853876*^9}, {3.8508247172129927`*^9, 3.85082474396586*^9}, 
   3.8508247816173697`*^9, 3.85161247222323*^9},
 CellLabel->
  "In[298]:=",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "ClCMBCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClyTClTT", " ", "=", " ", "CovClTTClyT"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850346639884039*^9, 3.850346655786344*^9}, {
  3.850346693917186*^9, 3.850346726784639*^9}, {3.8503474122585173`*^9, 
  3.850347413227049*^9}, {3.850824775304427*^9, 3.850824814089739*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"da09e2b5-a7b4-49bf-9f2b-a1e96746c6fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "ClCMBy"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClyTClTy", " ", "=", " ", "CovClTyClyT"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824821104742*^9, 3.850824847001371*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"afc0ed14-2e84-4db2-b204-d5148e7a1f7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyTClyT", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyTClyT", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyTClyT", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824857564348*^9, 3.8508248858960543`*^9}, 
   3.851612479196785*^9},
 CellLabel->
  "In[302]:=",ExpressionUUID->"c8b78761-42fe-46bb-920b-b13a77ea2368"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClyCMB", ",", "Clyy"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"CovClyTClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMBSplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyTClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyTClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850824916457693*^9, 3.850824932453846*^9}, 
   3.8516124810348473`*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"3993c42b-0302-4e21-9400-788471ac28ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClCMBCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CovClyyClTT", " ", "=", " ", "CovClTTClyy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824943262641*^9, 3.850824959316062*^9}, {
  3.850825012659877*^9, 3.8508250142859497`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"ce94caec-2e68-41a4-b870-6d2a25617e9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClCMBy"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"CovClyyClTy", " ", "=", " ", "CovClTyClyy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8508249747217484`*^9, 3.8508250109290953`*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"7d3e4827-8c5a-40f5-b971-4d8b6f218c4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClyCMB"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"CovClyyClyT", " ", "=", " ", "CovClyTClyy"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.850824988058978*^9, 3.850825008983264*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"8df78459-b30b-4fb9-b63e-f675b16d5800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{"covariance", " ", "of", " ", "the", " ", "ILC", " ", "y"}], "-", 
     RowBox[{"map", " ", "power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"Clyy", ",", "Clyy"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyyClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit1", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCySplit2", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyyClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyyClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850825049139883*^9, 3.850825051751254*^9}, 
   3.850825095639102*^9, 3.8516124897751303`*^9},
 CellLabel->
  "In[309]:=",ExpressionUUID->"2ce421c4-d370-4876-9cc8-d8ea9d613286"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "derivatives", " ", "of", " ", "ClTT"}], ",", 
    " ", "ClTy", ",", " ", "ClyT", ",", " ", 
    RowBox[{
    "and", " ", "Clyy", " ", "with", " ", "respect", " ", "to", " ", "Acmb", 
     " ", "and", " ", "Atsz"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTTCross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTTCross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit1ySplit2Cross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit1ySplit2Cross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit2ySplit1Cross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTSplit2ySplit1Cross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClyyCross", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClyyCross", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", " ", "derivClTTAcmb", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyTAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"derivAcmb", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAcmb", ",", " ", "derivClTyAcmb", ",", " ", "derivClyTAcmb", 
      ",", " ", "derivClyyAcmb"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"derivAtsz", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAtsz", ",", " ", "derivClTyAtsz", ",", " ", "derivClyTAtsz", 
      ",", " ", "derivClyyAtsz"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.85083183620432*^9, {3.851014255180688*^9, 3.851014288628635*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"fecf5d0e-3695-4c48-8a46-d277432bced8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Run", " ", "cell", " ", "below", " ", "to", " ", "set", " ", "numerical", 
    " ", "values"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "using", " ", "numerical", " ", "values", " ", "from", " ", "fgspectra", 
    " ", "and", " ", "CLASS", " ", "in", " ", "python", " ", "code", " ", 
    RowBox[{"(", 
     RowBox[{"ell", "=", 
      RowBox[{"1500", " ", "here"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CC", "=", "0.0019252172031626088"}], ";", " ", 
   RowBox[{"T", "=", 
    RowBox[{"1.4575172568790597", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "18"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"g1", "=", 
    RowBox[{"-", "4356390.851902919"}]}], ";", " ", 
   RowBox[{"g2", "=", 
    RowBox[{"-", "2599711.593181207"}]}], ";", " ", 
   RowBox[{"N1Split1", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"N1Split2", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", "  ", 
   RowBox[{"N2Split1", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"N2Split2", "=", 
    RowBox[{"9.051010437258822", "*", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "8"}], ")"}]}]}]}], ";", " ", 
   RowBox[{"Nmodes", "=", "3001"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8937571397771177`*^9, 3.8937571433700037`*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"0b2e61ff-d8f9-4676-929f-e1cd906f54ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Construct", " ", "Cov_", 
    RowBox[{"{", 
     RowBox[{"ab", ",", "cd"}], "}"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"matrix", " ", "where", " ", "Cov_", 
        RowBox[{"{", 
         RowBox[{"ab", ",", "cd"}], "}"}]}], "=", " ", 
       RowBox[{
        RowBox[{"sigma", "^", "2"}], "_", 
        RowBox[{"{", 
         RowBox[{"Cl", "^", 
          RowBox[{"{", 
           RowBox[{"ab", ",", "cd"}], "}"}]}], "}"}], " ", "where", " ", "ab",
         " ", "and", " ", "cd", " ", "are", " ", "either", " ", "TT"}]}], ",",
       " ", "Ty", ",", " ", "yT", ",", " ", 
      RowBox[{"or", " ", "yy"}]}], ")"}], " ", "as", " ", "4", "x4", " ", 
    "matrix", " ", "and", " ", "find", " ", "its", " ", "inverse"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Covabcd", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "CovClTTClTT", ",", " ", "CovClTTClTy", ",", " ", "CovClTTClyT", ",", 
         " ", "CovClTTClyy"}], " ", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClTyClTT", ",", " ", "CovClTyClTy", ",", " ", "CovClTyClyT", ",", 
         " ", "CovClTyClyy"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClyTClTT", ",", " ", "CovClyTClTy", ",", " ", "CovClyTClyT", ",", 
         " ", "CovClyTClyy"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "CovClyyClTT", ",", " ", "CovClyyClTy", ",", " ", "CovClyyClyT", ",", 
         " ", "CovClyyClyy"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CovabcdInv", " ", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "Covabcd", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "CovabcdInv", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.85034761163262*^9, 3.850347627086789*^9}, {
   3.8503476620760183`*^9, 3.8503477074779863`*^9}, {3.850347738235574*^9, 
   3.850347827652006*^9}, {3.8503490303809557`*^9, 3.8503490480026217`*^9}, {
   3.850349554687873*^9, 3.850349555120212*^9}, {3.8504038756406727`*^9, 
   3.850403889498209*^9}, {3.850516671388743*^9, 3.850516713436687*^9}, {
   3.8508251087274847`*^9, 3.850825231436008*^9}, {3.850826208381007*^9, 
   3.850826211228496*^9}, {3.850829131947513*^9, 3.850829137268963*^9}, {
   3.85101474929978*^9, 3.851014754650137*^9}, {3.8510153674301767`*^9, 
   3.851015371038816*^9}, {3.851019277861575*^9, 3.851019279652872*^9}, {
   3.8510876524250517`*^9, 3.851087658758934*^9}, 3.893757037445972*^9},
 CellLabel->
  "In[351]:=",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "Fisher", " ", "matrix", " ", "from", " ", "ILC", " ", 
    "approach", " ", "as", " ", "in", " ", "eq", ".30"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FisherAcmb", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAtsz", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbAtsz", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fisher", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"FisherAcmb", ",", " ", "FisherAcmbAtsz"}], "}"}], ",", " ", 
        
        RowBox[{"{", 
         RowBox[{"FisherAcmbAtsz", ",", " ", "FisherAtsz"}], "}"}]}], "}"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85034950498853*^9, 3.850349509828374*^9}, {
   3.850349574858923*^9, 3.850349597911985*^9}, {3.8503501515145063`*^9, 
   3.850350174863008*^9}, {3.850517816131082*^9, 3.8505178194977922`*^9}, {
   3.850771674560911*^9, 3.850771714825515*^9}, {3.851014797646678*^9, 
   3.851014799941732*^9}, {3.8510154513053293`*^9, 3.851015465448802*^9}, 
   3.851016028595449*^9, {3.851088185203498*^9, 3.851088185256936*^9}, {
   3.9019585255675287`*^9, 
   3.901958525930681*^9}},ExpressionUUID->"58056902-86fe-4fbf-8108-\
1396992f2aa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "final", " ", "covariance", " ", "matrix", " ", "from", 
    " ", "ILC", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovILC", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Inverse", "[", "Fisher", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovILC", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850349516022242*^9, 3.850349626346944*^9}, {
   3.850350209246752*^9, 3.850350218842215*^9}, {3.8503502589937963`*^9, 
   3.8503502599082937`*^9}, {3.85035083617115*^9, 3.85035084700953*^9}, {
   3.8503538388738003`*^9, 3.850353845960312*^9}, {3.850360123321699*^9, 
   3.850360130483348*^9}, {3.850733679149158*^9, 3.850733680874502*^9}, 
   3.850733764863978*^9, {3.851014815491434*^9, 3.851014817094797*^9}, {
   3.8510154835380983`*^9, 3.8510154868038597`*^9}, 3.8510881582325583`*^9},
 CellLabel->
  "In[358]:=",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Begin", " ", "multifrequency", " ", "template", " ", "fitting", " ", 
    "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "inverse", " ", "of", " ", "power", " ", "spectrum", " ", 
    "covariance", " ", "matrix", " ", 
    RowBox[{"Clij", "^", 
     RowBox[{"-", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PScovInv", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Inverse", "[", "PScovFull", "]"}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8503496400147123`*^9, 3.850349654350348*^9}, {
   3.8503497908572073`*^9, 3.8503497978710814`*^9}, {3.850349878403522*^9, 
   3.850349886056686*^9}, {3.85034993506516*^9, 3.850350027390441*^9}, {
   3.850350081207139*^9, 3.850350085493299*^9}, {3.850354087923471*^9, 
   3.850354094474616*^9}, {3.850354125284993*^9, 3.850354161519226*^9}, {
   3.850354210567197*^9, 3.850354224528007*^9}, {3.850354292756077*^9, 
   3.850354295342491*^9}, {3.850354361218829*^9, 3.850354362650098*^9}, {
   3.850355512960595*^9, 3.850355517830956*^9}, {3.850355592082144*^9, 
   3.8503556945546837`*^9}, {3.8503558183935328`*^9, 
   3.8503558213751707`*^9}, {3.850355862239695*^9, 3.850355862571498*^9}, {
   3.8503564617574*^9, 3.850356464796698*^9}, {3.850358682822667*^9, 
   3.8503587488098993`*^9}, {3.850358794002527*^9, 3.850358832500148*^9}, {
   3.850358866527831*^9, 3.850358912497348*^9}, 3.850359117661935*^9, {
   3.8503602492888603`*^9, 3.850360251119399*^9}, {3.850360284619053*^9, 
   3.850360484061838*^9}, {3.8503905177758913`*^9, 3.850390577682815*^9}, {
   3.850392744514257*^9, 3.850392748281014*^9}, {3.850392826907902*^9, 
   3.8503928482054653`*^9}, {3.8503942427038937`*^9, 3.850394263038974*^9}, {
   3.850399164204639*^9, 3.850399230813457*^9}, {3.8503995291376123`*^9, 
   3.850399543546097*^9}, {3.850399629073423*^9, 3.850399631962167*^9}, {
   3.8503996822963457`*^9, 3.850399688602214*^9}, {3.85039972404904*^9, 
   3.850399725387488*^9}, {3.8504002795194407`*^9, 3.8504003088129787`*^9}, {
   3.850518950334333*^9, 3.850518952616405*^9}, {3.850733555531424*^9, 
   3.8507335605151854`*^9}, {3.850770327055221*^9, 3.8507703312950974`*^9}, {
   3.850771922347678*^9, 3.850771924641581*^9}},
 CellLabel->
  "In[360]:=",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Find", " ", "K_", 
    RowBox[{"{", 
     RowBox[{"alpha", ",", "beta"}], "}"}], " ", "from", " ", "eq", ".18", 
    " ", "by", " ", "summing", " ", "over", " ", "each", " ", "term", " ", 
    "of", " ", "PScovInv", " ", 
    RowBox[{"once", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KCMBCMB", " ", "=", " ", 
     RowBox[{
      RowBox[{"CC", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KCMBtSZ", " ", "=", " ", 
     RowBox[{"CC", "*", "T", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], "+",
         " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KtSZtSZ", " ", "=", " ", 
     RowBox[{
      RowBox[{"T", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], "+",
         " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], "+",
         " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{"g2", "*", "g1", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "3"}], "]"}], "]"}], "*", "g2", "*", "g1"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KCMBCMB", ",", " ", "KCMBtSZ"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"KCMBtSZ", ",", " ", "KtSZtSZ"}], "}"}]}], "}"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8505198656666327`*^9, 3.850520162743334*^9}, {
   3.850520321814958*^9, 3.850520376883337*^9}, {3.8505206038216343`*^9, 
   3.85052067353691*^9}, {3.850520806532054*^9, 3.850520909483322*^9}, {
   3.85073357357976*^9, 3.850733622860013*^9}, {3.850770353217812*^9, 
   3.850770406891032*^9}, {3.8507708032485313`*^9, 3.850770985565879*^9}, {
   3.850772024644278*^9, 3.850772030791041*^9}, {3.850772073733844*^9, 
   3.85077208350599*^9}, 3.850772234339122*^9, {3.850826252965376*^9, 
   3.85082644940425*^9}, {3.901958591709545*^9, 
   3.901958592035812*^9}},ExpressionUUID->"6c901049-b1b5-4003-885a-\
cc30e39e5f0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "final", " ", "covariance", " ", "matrix", " ", "from", " ", 
    "template", " ", "fitting", " ", "approach", " ", "using", " ", "eq", 
    ".22"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovTemplateFitting", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Inverse", "[", "K", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovTemplateFitting", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850351206483547*^9, 3.8503512632120237`*^9}, {
   3.850360500871291*^9, 3.8503605209466867`*^9}, {3.8503605644973173`*^9, 
   3.850360567881268*^9}, {3.850518523986722*^9, 3.8505185287438593`*^9}, {
   3.850520397410143*^9, 3.850520397624772*^9}, {3.8505220180807*^9, 
   3.8505220242855*^9}, {3.850733628011723*^9, 3.850733628699942*^9}, 
   3.851015198548562*^9, {3.901958614322939*^9, 
   3.9019586147476683`*^9}},ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-\
975d68d3f8d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Subtract", " ", "final", " ", "covariance", " ", "for", " ", 
    "TemplateFitting", " ", "from", " ", "that", " ", "for", " ", "ILC"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"FinalCovILC", "-", "FinalCovTemplateFitting"}], "]"}], " ", "//",
    "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.850351271104641*^9, 3.850351296476169*^9}, {
  3.850355875846406*^9, 3.850355905899435*^9}, {3.850360545180888*^9, 
  3.8503605498940563`*^9}, {3.850360672509582*^9, 3.850360678869467*^9}, {
  3.850518617440613*^9, 3.850518631620695*^9}, {3.85051873631888*^9, 
  3.850518751618104*^9}, {3.850520457595566*^9, 3.850520482106653*^9}, {
  3.850520556251568*^9, 3.850520562191472*^9}, {3.8505207309376583`*^9, 
  3.850520736040427*^9}, {3.8505212461870737`*^9, 3.85052124648522*^9}, {
  3.850522102804269*^9, 3.8505221193104477`*^9}, {3.8507336453302402`*^9, 
  3.850733648739531*^9}, {3.850831138284753*^9, 3.85083115512575*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8508259432881393`*^9, 3.850826032700458*^9}, {
   3.850826090183419*^9, 3.850826096670219*^9}, {3.850831615386931*^9, 
   3.8508316277825003`*^9}, {3.85083197255822*^9, 3.850831975671237*^9}, {
   3.851014490001354*^9, 3.8510144903890657`*^9}, {3.8510145728706627`*^9, 
   3.851014576583416*^9}, 
   3.893757016554882*^9},ExpressionUUID->"31ff794c-f505-471d-8a56-\
21f4c54fa7e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Run", " ", "cell", " ", "below", " ", "to", " ", "clear", " ", 
    "numerical", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "CC", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "T", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "g1", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "g2", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N1Split1", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N1Split2", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N2Split1", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "N2Split2", "]"}], ";", " ", 
   RowBox[{"Clear", "[", "Nmodes", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8508260238458023`*^9, 3.850826114090095*^9}, {
   3.850831967738297*^9, 3.850831982983984*^9}, 3.8510140695405827`*^9},
 CellLabel->
  "In[698]:=",ExpressionUUID->"7f8e5ec9-b8df-4a2a-80a8-16f73dc6afc2"]
},
WindowSize->{1342, 730},
WindowMargins->{{Automatic, 6}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"839a2295-dbf7-4c58-9138-edbdf0665a83"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2543, 60, 115, "Input",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],
Cell[3104, 82, 3289, 94, 165, "Input",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],
Cell[6396, 178, 805, 20, 94, "Input",ExpressionUUID->"2f9d2e15-0d49-4cdb-bf16-a4240c685d25"],
Cell[7204, 200, 1771, 47, 75, "Input",ExpressionUUID->"0bb951f3-b1d8-4f5f-8b7f-9906015e0846"],
Cell[8978, 249, 515, 15, 52, "Input",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],
Cell[9496, 266, 549, 13, 30, "Input",ExpressionUUID->"ed802296-cd4f-4f6b-80ba-47a10560f486"],
Cell[10048, 281, 863, 21, 52, "Input",ExpressionUUID->"aae96ca5-3198-45e6-9d92-3d79d37e4666"],
Cell[10914, 304, 826, 21, 52, "Input",ExpressionUUID->"0440ec80-8221-4948-9d5d-7b2e05a13bbf"],
Cell[11743, 327, 684, 17, 52, "Input",ExpressionUUID->"2ce40ba6-77ff-44fa-a1cb-64d409f8b458"],
Cell[12430, 346, 474, 10, 30, "Input",ExpressionUUID->"5e903483-298c-407c-90ac-3c4e16f1c6a5"],
Cell[12907, 358, 544, 12, 52, "Input",ExpressionUUID->"017a879e-24ad-4c02-b8fb-f0e17fbf3732"],
Cell[13454, 372, 1255, 29, 94, "Input",ExpressionUUID->"ebf5ecff-a778-422e-902e-b0c43dbc07a2"],
Cell[14712, 403, 1173, 27, 54, "Input",ExpressionUUID->"5b898eea-17f6-4a1e-a531-c5fc3839954b"],
Cell[15888, 432, 11060, 292, 388, "Input",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],
Cell[26951, 726, 343, 8, 30, "Input",ExpressionUUID->"78b6aedf-982d-4dbf-aa72-f05a013c3cca"],
Cell[27297, 736, 1253, 31, 94, "Input",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],
Cell[28553, 769, 470, 12, 30, "Input",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],
Cell[29026, 783, 4519, 132, 346, "Input",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],
Cell[33548, 917, 2471, 58, 136, "Input",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],
Cell[36022, 977, 1855, 47, 115, "Input",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],
Cell[37880, 1026, 1899, 47, 115, "Input",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],
Cell[39782, 1075, 1751, 45, 115, "Input",ExpressionUUID->"91c2cf13-d95a-403a-819f-42d53ea2dba7"],
Cell[41536, 1122, 475, 12, 52, "Input",ExpressionUUID->"d1a0375d-b2ec-4c7c-a505-75632fbc2e83"],
Cell[42014, 1136, 2022, 52, 115, "Input",ExpressionUUID->"988997b5-45d0-46b5-9d35-ed0d56506ba2"],
Cell[44039, 1190, 1746, 45, 115, "Input",ExpressionUUID->"4805e1a6-9b6c-45e8-a9e3-bde8d5c28b62"],
Cell[45788, 1237, 1867, 47, 115, "Input",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],
Cell[47658, 1286, 546, 13, 52, "Input",ExpressionUUID->"da09e2b5-a7b4-49bf-9f2b-a1e96746c6fe"],
Cell[48207, 1301, 390, 10, 52, "Input",ExpressionUUID->"afc0ed14-2e84-4db2-b204-d5148e7a1f7b"],
Cell[48600, 1313, 1701, 45, 115, "Input",ExpressionUUID->"c8b78761-42fe-46bb-920b-b13a77ea2368"],
Cell[50304, 1360, 1697, 45, 115, "Input",ExpressionUUID->"3993c42b-0302-4e21-9400-788471ac28ef"],
Cell[52004, 1407, 449, 12, 52, "Input",ExpressionUUID->"ce94caec-2e68-41a4-b870-6d2a25617e9c"],
Cell[52456, 1421, 400, 11, 52, "Input",ExpressionUUID->"7d3e4827-8c5a-40f5-b971-4d8b6f218c4f"],
Cell[52859, 1434, 396, 11, 52, "Input",ExpressionUUID->"8df78459-b30b-4fb9-b63e-f675b16d5800"],
Cell[53258, 1447, 1901, 48, 115, "Input",ExpressionUUID->"2ce421c4-d370-4876-9cc8-d8ea9d613286"],
Cell[55162, 1497, 5429, 151, 451, "Input",ExpressionUUID->"fecf5d0e-3695-4c48-8a46-d277432bced8"],
Cell[60594, 1650, 1736, 47, 115, "Input",ExpressionUUID->"0b2e61ff-d8f9-4676-929f-e1cd906f54ac"],
Cell[62333, 1699, 2681, 61, 115, "Input",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],
Cell[65017, 1762, 3909, 104, 157, "Input",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],
Cell[68929, 1868, 1046, 21, 73, "Input",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],
Cell[69978, 1891, 2396, 42, 94, "Input",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],
Cell[72377, 1935, 9967, 264, 304, "Input",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],
Cell[82347, 2201, 1025, 21, 73, "Input",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],
Cell[83375, 2224, 1116, 21, 52, "Input",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"],
Cell[84494, 2247, 428, 7, 30, "Input",ExpressionUUID->"31ff794c-f505-471d-8a56-21f4c54fa7e2"],
Cell[84925, 2256, 898, 19, 73, "Input",ExpressionUUID->"7f8e5ec9-b8df-4a2a-80a8-16f73dc6afc2"]
}
]
*)

