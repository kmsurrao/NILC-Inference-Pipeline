(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     73819,       1949]
NotebookOptionsPosition[     70769,       1907]
NotebookOutlinePosition[     71166,       1923]
CellTagsIndexPosition[     71123,       1920]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "matrix", " ", "of", " ", "auto"}], "-", " ", 
    RowBox[{"and", " ", "cross"}], "-", 
    RowBox[{
    "frequency", " ", "power", " ", "spectra", " ", "at", " ", "some", " ", 
     "multipole", " ", "ell"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"here", ",", " ", 
    RowBox[{"CC", " ", "=", " ", 
     RowBox[{"C_ell", "^", "CMB"}]}], " ", ",", " ", 
    RowBox[{"N1", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq1", "}"}]}]}], " ", ",", " ", 
    RowBox[{"N2", " ", "=", " ", 
     RowBox[{"N_ell", "^", 
      RowBox[{"{", "freq2", "}"}]}]}], " ", ",", " ", 
    RowBox[{"g1", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq1"}]}], 
    ",", " ", 
    RowBox[{"g2", " ", "=", " ", 
     RowBox[{
     "tSZ", " ", "spectral", " ", "function", " ", "at", " ", "freq2"}]}], 
    ",", " ", 
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{"C_ell", "^", "yy"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "tSZ", " ", "power", " ", "spectrum", " ", "in", " ", "frequency"}], 
        "-", 
        RowBox[{"independent", " ", "Compton"}], "-", 
        RowBox[{"y", " ", "units"}]}], ")"}]}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8500974654435797`*^9, 3.850097474804103*^9}, {
   3.850097512768484*^9, 3.850097605412682*^9}, 3.850097643969492*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clij", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "Atsz", " ", "T"}]}], ",", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", 
        RowBox[{"g1", " ", "g2", " ", "Atsz", " ", "T"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Acmb", " ", "CC"}], "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], " ", "Atsz", " ", "T"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Clij", "]"}]}], "Input",
 CellChangeTimes->{{3.85009745416115*^9, 3.850097455840989*^9}, {
  3.850097507223783*^9, 3.850097508147098*^9}, {3.850097619328155*^9, 
  3.8500976307601347`*^9}, {3.851081839361023*^9, 3.8510818642124577`*^9}, {
  3.8510820267280817`*^9, 3.851082046218465*^9}, {3.851775495911669*^9, 
  3.851775519664749*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClijInv", " ", "=", " ", 
    RowBox[{"Inverse", "[", "Clij", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.893696922409892*^9, 3.893696939191497*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"6574f643-d4b1-4604-970a-deca9402bd10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gvec", "=", 
    RowBox[{"{", 
     RowBox[{"g1", ",", "g2"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"tSZ", " ", "spectral", " ", "response", " ", "vector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CMB", " ", "spectral", " ", "response", " ", "vector"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"let", "'"}], "s", " ", "get", " ", "the", " ", "ILC", " ", 
     "weights", " ", "for", " ", "the", " ", "y"}], "-", 
    RowBox[{"map", " ", "and", " ", "the", " ", "CMB", " ", "map", " ", 
     RowBox[{"explicitly", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "note", " ", "that", " ", "the", " ", "weights", " ", "should", 
    " ", "be", " ", "measured", " ", "once", " ", "from", " ", "data", " ", 
    "and", " ", "thus", " ", "should", " ", "not", " ", "be", " ", 
    "functions", " ", "of", " ", "Acmb", " ", "or", " ", "Atsz"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijNoA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CC", "+", "N1", "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], " ", "T"}]}], ",", " ", 
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", "  ", "T"}]}]}], "}"}], ",", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"CC", "+", 
        RowBox[{"g1", " ", "g2", "  ", "T"}]}], ",", "  ", 
       RowBox[{"CC", "+", "N2", "+", 
        RowBox[{
         SuperscriptBox["g2", "2"], "  ", "T"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClijNoAInv", " ", "=", " ", 
   RowBox[{"Inverse", "[", "ClijNoA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCy", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijNoAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"gvec", ".", "ClijNoAInv", ".", "gvec"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsILCCMB", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijNoAInv"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"hvec", ".", "ClijNoAInv", ".", "hvec"}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.850097695847044*^9, {3.851775606465138*^9, 3.851775621929944*^9}, {
   3.893696273622905*^9, 3.893696301133051*^9}, {3.893696839458085*^9, 
   3.8936969175247*^9}, {3.893696956827209*^9, 3.8936970072358513`*^9}, {
   3.893697068233581*^9, 3.893697068799679*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"first", " ", 
    RowBox[{"let", "'"}], "s", " ", "double"}], "-", 
   RowBox[{
   "check", " ", "the", " ", "calculation", " ", "of", " ", "the", " ", 
    "total", " ", "power", " ", "at", " ", "this", " ", "ell", " ", "in", " ",
     "the", " ", "harmonic", " ", "ILC", " ", "y"}], "-", "map"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.850097706486309*^9, 3.850097717640025*^9}, {
  3.8500977767353907`*^9, 3.8500977915243187`*^9}, {3.850097888230196*^9, 
  3.850097919774589*^9}, {3.8511767699252863`*^9, 3.851176769961831*^9}, {
  3.9019582424885406`*^9, 
  3.901958242793956*^9}},ExpressionUUID->"df97776b-da40-4b25-b589-\
6c7346b9279c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{"Clyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"weightsILCy", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"weightsILCy", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"Clij", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.850097721464882*^9, 3.8500977478645077`*^9}, {
   3.850346276713788*^9, 3.850346278442189*^9}, {3.851775542167411*^9, 
   3.85177557100146*^9}, 3.851775656318345*^9, {3.851775699975924*^9, 
   3.8517757097956247`*^9}, {3.851779231571993*^9, 3.851779267066864*^9}, {
   3.8517817147134447`*^9, 3.8517817163706827`*^9}, {3.851782329010209*^9, 
   3.8517824011966743`*^9}, {3.851782440513945*^9, 3.8517824671823483`*^9}, 
   3.851782501193589*^9, {3.851783004556847*^9, 3.851783007902253*^9}, {
   3.851783074788918*^9, 3.8517831921761217`*^9}, {3.851783279763715*^9, 
   3.851783285053823*^9}, {3.851783316808724*^9, 3.851783329632969*^9}, {
   3.851785330348691*^9, 3.8517853470821238`*^9}, 3.89369683587698*^9, 
   3.8936970396557217`*^9, 3.8936970997794724`*^9, {3.901958228925159*^9, 
   3.901958233818469*^9}, {3.9019582856648693`*^9, 
   3.901958286911723*^9}},ExpressionUUID->"2a5c4249-e0ed-410e-8c3e-\
5a3f596868af"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "we", " ", "can", " ", "also", " ", "do", " ", "the", " ", "same", " ", 
    "for", " ", "the", " ", "total", " ", "power", " ", "in", " ", "the", " ",
     "harmonic", " ", "ILC", " ", "CMB", " ", "map"}], ",", " ", 
   RowBox[{
    RowBox[{"and", " ", "the", " ", "cross"}], "-", 
    RowBox[{
    "power", " ", "between", " ", "the", " ", "CMB", " ", "map", " ", "and", 
     " ", "the", " ", "y"}], "-", "map"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850097988895115*^9, 3.8500980107783947`*^9}, {
  3.850098350392034*^9, 3.850098360121747*^9}, {3.901958628779997*^9, 
  3.901958629110497*^9}},ExpressionUUID->"9ff3a268-3d8e-422b-87d0-\
5b3bbdc7c55e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClTT", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"weightsILCCMB", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"weightsILCCMB", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Clij", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.850098038744236*^9, 3.850098040556843*^9}, {
  3.850346295093009*^9, 3.850346296550972*^9}, {3.851781726935107*^9, 
  3.8517817779944143`*^9}, {3.851782060870788*^9, 3.851782098855464*^9}, {
  3.851782574901383*^9, 3.8517825783021297`*^9}, {3.89369712139384*^9, 
  3.8936971256889963`*^9}, {3.90195824791475*^9, 3.901958251040288*^9}, {
  3.901958289771245*^9, 
  3.9019582905899963`*^9}},ExpressionUUID->"ef68a8aa-608a-4e49-ab94-\
ba30add8c398"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClTy", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"weightsILCCMB", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"weightsILCy", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         RowBox[{"Clij", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8500981952249937`*^9, 3.8500982362816143`*^9}, {
   3.850346324598196*^9, 3.850346326782585*^9}, {3.851781801757866*^9, 
   3.8517818139926243`*^9}, {3.851785310914205*^9, 3.851785318128643*^9}, {
   3.851785351279695*^9, 3.8517853719366426`*^9}, {3.851785409424596*^9, 
   3.851785409922306*^9}, 3.8936971319497347`*^9, 
   3.901958295779196*^9},ExpressionUUID->"1c59591f-124e-44d7-927c-\
7b4b25b7a6af"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"now", " ", 
     RowBox[{"let", "'"}], "s", " ", "compute", " ", "the", " ", "auto"}], 
    "-", 
    RowBox[{"covariance", " ", "of", " ", "the", " ", "ILC", " ", "y"}], "-", 
    
    RowBox[{"map", " ", "power", " ", "spectrum"}]}], ",", " ", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "Clyy"}], ")"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.850101693327486*^9, 3.8501017265692368`*^9}, {
  3.850103986399466*^9, 3.850103987874785*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"4fc0363f-8a90-463c-b651-01b54643e951"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"first", ",", " ", 
    RowBox[{
     RowBox[{
     "construct", " ", "the", " ", "covariance", " ", "matrix", " ", "of", 
      " ", "the", " ", "auto"}], "-", " ", 
     RowBox[{"and", " ", "cross"}], "-", 
     RowBox[{"frequency", " ", "power", " ", "spectra"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "explicitly", " ", "include", " ", "150", "x90", " ", "terms", " ", "in", 
     " ", "power", " ", "spectrum", " ", "covariance", " ", "matrix"}], ",", 
    " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"it", " ", "is", " ", "a", " ", "4", "x4", " ", "matrix"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"PScovFull", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "Nmodes"}], ")"}], "*", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N1", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N1", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N1", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N2", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g1", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N1", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N2", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N2", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"CC", "+", 
               RowBox[{
                RowBox[{"g2", "^", "2"}], "*", "T"}]}], ")"}], "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
            RowBox[{"2", "*", "N2", "*", 
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{"Clij", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "^", "2"}]}]}], "}"}]}],
         "}"}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PScovFull", " ", "=", " ", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Acmb", "=", "1"}], ",", 
          RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
        RowBox[{"Evaluate", "[", "PScovFull", "]"}]}], "]"}]}], ";"}]}],
   FontSize->14]}]], "Input",
 CellChangeTimes->{{3.850101781156426*^9, 3.850101947487274*^9}, {
  3.8501019960010643`*^9, 3.850102085096258*^9}, {3.850102119280776*^9, 
  3.850102143544561*^9}, {3.850102200267356*^9, 3.850102233136145*^9}, {
  3.850585600333256*^9, 3.850585721314766*^9}, {3.8517818473221893`*^9, 
  3.851781851416587*^9}, {3.851781891720147*^9, 3.851781906624173*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "we", " ", "are", " ", "really", " ", "representing", " ", "a", " ", 
      "four"}], "-", 
     RowBox[{"index", " ", "tensor"}]}], ",", " ", 
    RowBox[{
    "each", " ", "of", " ", "whose", " ", "indices", " ", "can", " ", "take", 
     " ", "2", " ", "values"}], ",", " ", 
    RowBox[{"as", " ", "a", " ", "4", "x4", " ", 
     RowBox[{"matrix", " ", "--"}], " ", "both", " ", "objects", " ", 
     "contain", " ", "16", " ", "elements"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"to", " ", "make", " ", "the", " ", "summation", " ", "in", " ", 
     RowBox[{"Eq", ".", " ", "21"}], " ", "straightforward"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "just", " ", "construct", " ", "the", 
      " ", "four"}], "-", 
     RowBox[{"index", " ", "tensor", " ", "explicitly"}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.850102297009666*^9, 3.850102300393331*^9}, {
  3.8501024445495653`*^9, 3.850102525922276*^9}, {3.9019586576614447`*^9, 
  3.901958688362542*^9}},ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-\
b460c1ab0052"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PScovFullTensor", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.850102529406659*^9, 3.850102532963168*^9}, {
  3.850102635776206*^9, 3.850102680133873*^9}, {3.850102808164304*^9, 
  3.850102844743293*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PScovFullTensor", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"PScovFull", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850102822907016*^9, 3.850102881013631*^9}, {
  3.850102939548687*^9, 3.850103116470541*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"now", " ", "compute", " ", "the", " ", "sum", " ", "in", " ", 
    RowBox[{"Eq", ".", " ", "21"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyyClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyyClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyyClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850103216280018*^9, 3.850103345534136*^9}, {
  3.85034688314222*^9, 3.8503468872510147`*^9}, {3.901958699977075*^9, 
  3.901958700805993*^9}},ExpressionUUID->"4b50a60d-5c89-4026-82d7-\
b87a5b4b31cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{
     "covariance", " ", "of", " ", "ILC", " ", "CMB", " ", "map", " ", 
      "power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClCMB", ",", "ClCMB"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClCMBClCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClCMBClCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClCMBClCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8501037946230087`*^9, 3.850103826071932*^9}, {
  3.8501038894304457`*^9, 3.8501039043584013`*^9}, {3.8501039917138147`*^9, 
  3.850103993005377*^9}, {3.850346897053793*^9, 3.85034690273654*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"auto", "-", 
     RowBox[{"covariance", " ", "of", " ", "ILC", " ", "y"}], "-", 
     RowBox[{"map", " ", "x", " ", "CMB", " ", "map", " ", "cross"}], "-", 
     RowBox[{"power", " ", "spectrum"}]}], ",", " ", 
    RowBox[{"Cov", 
     RowBox[{"(", 
      RowBox[{"ClyCMB", ",", "ClyCMB"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClyCMBClyCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyCMBClyCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyCMBClyCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104065705544*^9, 3.8501041223220253`*^9}, {
  3.8503469083506823`*^9, 3.8503469142925377`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"7c73614c-802e-4ef8-afa0-ea8ed97ad75c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "Clyy"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClCMBCMBClyy", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClCMBCMBClyy", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClCMBCMBClyy", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104449157226*^9, 3.850104514135442*^9}, {
  3.8503469341668787`*^9, 3.850346935303865*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"ClCMBCMB", ",", "ClyCMB"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CovClCMBCMBClyCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClCMBCMBClyCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClCMBCMBClyCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104656964769*^9, 3.850104669523221*^9}, {
  3.850346944794262*^9, 3.850346953475602*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Cov", 
    RowBox[{"(", 
     RowBox[{"Clyy", ",", "ClyCMB"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"CovClyyClyCMB", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", 
              RowBox[{"weightsILCy", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"weightsILCCMB", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "*", 
              RowBox[{"PScovFullTensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CovClyyClyCMB", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", "CovClyyClyCMB", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.850104715447761*^9, 3.850104746702614*^9}, {
  3.850346965296616*^9, 3.8503469672360687`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Construct", " ", "Cov_", 
    RowBox[{"{", 
     RowBox[{"ab", ",", "cd"}], "}"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"matrix", " ", "where", " ", "Cov_", 
        RowBox[{"{", 
         RowBox[{"ab", ",", "cd"}], "}"}]}], "=", " ", 
       RowBox[{
        RowBox[{"sigma", "^", "2"}], "_", 
        RowBox[{"{", 
         RowBox[{"Cl", "^", 
          RowBox[{"{", 
           RowBox[{"ab", ",", "cd"}], "}"}]}], "}"}], " ", "where", " ", "ab",
         " ", "and", " ", "cd", " ", "are", " ", "either", " ", "TT"}]}], ",",
       " ", "Ty", ",", " ", 
      RowBox[{"or", " ", "yy"}]}], ")"}], " ", "as", " ", "3", "x3", " ", 
    "matrix", " ", "and", " ", "find", " ", "its", " ", "inverse"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Covabcd", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "CovClCMBClCMB", ",", " ", "CovClCMBCMBClyCMB", ",", " ", 
         "CovClCMBCMBClyy"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClCMBCMBClyCMB", ",", " ", "CovClyCMBClyCMB", ",", " ", 
         "CovClyyClyCMB"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "CovClCMBCMBClyy", ",", " ", "CovClyyClyCMB", ",", " ", 
         "CovClyyClyy"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CovabcdInv", " ", "=", " ", 
     RowBox[{"Inverse", "[", "Covabcd", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85034761163262*^9, 3.850347627086789*^9}, {
  3.8503476620760183`*^9, 3.8503477074779863`*^9}, {3.850347738235574*^9, 
  3.850347827652006*^9}, {3.8503490303809557`*^9, 3.8503490480026217`*^9}, {
  3.850349554687873*^9, 3.850349555120212*^9}, {3.8504038756406727`*^9, 
  3.850403889498209*^9}, {3.850516671388743*^9, 3.850516713436687*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "derivatives", " ", "of", " ", "ClTT"}], ",", 
    " ", "ClTy", ",", " ", 
    RowBox[{
    "and", " ", "Clyy", " ", "with", " ", "respect", " ", "to", " ", "Acmb", 
     " ", "and", " ", "Atsz", " ", 
     RowBox[{"(", 
      RowBox[{
      "use", " ", "expressions", " ", "from", " ", "earlier", " ", "in", " ", 
       "notebook", " ", "with", " ", "Acmb", " ", "and", " ", "Atsz", " ", 
       "inserted", " ", "next", " ", "to", " ", "CC", " ", "and", " ", "T", 
       " ", "respectively"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTT", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTT", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTy", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"ClTy", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Clyy", ",", "Acmb"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Clyy", ",", "Atsz"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", " ", "derivClTTAcmb", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTTAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTTAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClTyAtsz", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClTyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAcmb", " ", "=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAcmb", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"derivClyyAtsz", " ", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Acmb", "=", "1"}], ",", 
         RowBox[{"Atsz", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{"Evaluate", "[", "derivClyyAtsz", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"derivAcmb", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAcmb", ",", " ", "derivClTyAcmb", ",", " ", "derivClyyAcmb"}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"derivAtsz", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "derivClTTAtsz", ",", " ", "derivClTyAtsz", ",", " ", "derivClyyAtsz"}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ7TNb+OCX9W8cz727dxxEP0/UPQOiZSdy3QPRHHbS
T0C0h33jSxD9+5YZ81cgXXInnBVEW7xxFAPRRvP3iINom2dSsiC6o5/XAETX
/VE0AdEingmWIPpEYawTiP6uWOwCok9Fc3uCaMldV71AtMc7z0AQLSNWAKZL
lvmHg+g7857EgmihSN9kED1hycZ8EL2ii7kUROdaTQTTl7Q2TgfRR9hjZoFo
PR3G6yB6U1j4TRCdFvH9FYjOaIz5A3b/+Z8834D0gzpFXhDdZqspBqJFZRbI
gGiWRhsV9w1vHMtvnQfTzy/VG0dvfOP4JtfAD0R7uOcHg+i+s3KRIForz6uo
E0if2J4Hph9EfHy+YdMbxzMvN74E0QAFudI/
  "],
 CellLabel->
  "In[166]:=",ExpressionUUID->"3d6b127a-5a9a-49a2-b7fe-3623bf033a7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "Fisher", " ", "matrix", " ", "from", " ", "HILC", " ", 
    "approach", " ", "as", " ", "in", " ", "eq", ".30"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FisherAcmb", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAcmb", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAtsz", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"derivAtsz", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "*", 
          RowBox[{"CovabcdInv", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FisherAcmbAtsz", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"derivAtsz", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"derivAcmb", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"CovabcdInv", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Fisher", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "FisherAcmb", "]"}], ",", " ", 
        RowBox[{"FullSimplify", "[", "FisherAcmbAtsz", "]"}]}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullSimplify", "[", "FisherAcmbAtsz", "]"}], ",", " ", 
        RowBox[{"FullSimplify", "[", "FisherAtsz", "]"}]}], "}"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.85034950498853*^9, 3.850349509828374*^9}, {
   3.850349574858923*^9, 3.850349597911985*^9}, {3.8503501515145063`*^9, 
   3.850350174863008*^9}, {3.850517816131082*^9, 3.8505178194977922`*^9}, 
   3.851176862907642*^9, {3.901958716511312*^9, 
   3.9019587273859*^9}},ExpressionUUID->"58056902-86fe-4fbf-8108-\
1396992f2aa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "final", " ", "covariance", " ", "matrix", " ", "from", 
    " ", "HILC", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovHILC", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "Fisher", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovHILC", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850349516022242*^9, 3.850349626346944*^9}, {
  3.850350209246752*^9, 3.850350218842215*^9}, {3.8503502589937963`*^9, 
  3.8503502599082937`*^9}, {3.85035083617115*^9, 3.85035084700953*^9}, {
  3.8503538388738003`*^9, 3.850353845960312*^9}, {3.850360123321699*^9, 
  3.850360130483348*^9}, {3.901958731129938*^9, 
  3.9019587428807507`*^9}},ExpressionUUID->"fa093843-a40e-4b97-8d7f-\
8c73871521ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Begin", " ", "multifrequency", " ", "template", " ", "fitting", " ", 
    "approach"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "inverse", " ", "of", " ", "power", " ", "spectrum", " ", 
    "covariance", " ", "matrix", " ", 
    RowBox[{"Clij", "^", 
     RowBox[{"-", "1"}]}], " ", "and", " ", "the", " ", "associated", " ", 
    "tensor"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PScov", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"PScovFull", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PScovInv", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "PScov", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PScovInvTensor", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"PScovInvTensor", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{"PScovInv", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8503496400147123`*^9, 3.850349654350348*^9}, {
   3.8503497908572073`*^9, 3.8503497978710814`*^9}, {3.850349878403522*^9, 
   3.850349886056686*^9}, {3.85034993506516*^9, 3.850350027390441*^9}, {
   3.850350081207139*^9, 3.850350085493299*^9}, {3.850354087923471*^9, 
   3.850354094474616*^9}, {3.850354125284993*^9, 3.850354161519226*^9}, {
   3.850354210567197*^9, 3.850354224528007*^9}, {3.850354292756077*^9, 
   3.850354295342491*^9}, {3.850354361218829*^9, 3.850354362650098*^9}, {
   3.850355512960595*^9, 3.850355517830956*^9}, {3.850355592082144*^9, 
   3.8503556945546837`*^9}, {3.8503558183935328`*^9, 
   3.8503558213751707`*^9}, {3.850355862239695*^9, 3.850355862571498*^9}, {
   3.8503564617574*^9, 3.850356464796698*^9}, {3.850358682822667*^9, 
   3.8503587488098993`*^9}, {3.850358794002527*^9, 3.850358832500148*^9}, {
   3.850358866527831*^9, 3.850358912497348*^9}, 3.850359117661935*^9, {
   3.8503602492888603`*^9, 3.850360251119399*^9}, {3.850360284619053*^9, 
   3.850360484061838*^9}, {3.8503905177758913`*^9, 3.850390577682815*^9}, {
   3.850392744514257*^9, 3.850392748281014*^9}, {3.850392826907902*^9, 
   3.8503928482054653`*^9}, {3.8503942427038937`*^9, 3.850394263038974*^9}, {
   3.850399164204639*^9, 3.850399230813457*^9}, {3.8503995291376123`*^9, 
   3.850399543546097*^9}, {3.850399629073423*^9, 3.850399631962167*^9}, {
   3.8503996822963457`*^9, 3.850399688602214*^9}, {3.85039972404904*^9, 
   3.850399725387488*^9}, {3.8504002795194407`*^9, 3.8504003088129787`*^9}, {
   3.850518950334333*^9, 3.850518952616405*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "K", " ", "by", " ", "explicitly", " ", "summing", " ", 
    "over", " ", "matrix", " ", "elements", " ", "instead", " ", "of", " ", 
    "tensor"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KCMBCMB", " ", "=", " ", 
     RowBox[{
      RowBox[{"CC", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], " ", "+", " ", 
        RowBox[{"PScovInv", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KCMBtSZ", " ", "=", " ", 
     RowBox[{"CC", "*", "T", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KtSZCMB", " ", "=", "  ", 
     RowBox[{"T", "*", "CC", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KtSZtSZ", " ", "=", " ", 
     RowBox[{
      RowBox[{"T", "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g1", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{"g1", "*", "g2", "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"g1", "^", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", "g1", "*", "g2"}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"g2", "^", "2"}], "*", 
         RowBox[{"PScovInv", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"g2", "^", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"KCMBCMB", ",", " ", "KCMBtSZ"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"KtSZCMB", ",", " ", "KtSZtSZ"}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8505198656666327`*^9, 3.850520162743334*^9}, {
  3.850520321814958*^9, 3.850520376883337*^9}, {3.8505206038216343`*^9, 
  3.85052067353691*^9}, {3.850520806532054*^9, 3.850520909483322*^9}, {
  3.851082502529337*^9, 3.8510825452871637`*^9}, {3.851176880241252*^9, 
  3.85117691126571*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Find", " ", "final", " ", "covariance", " ", "matrix", " ", "from", " ", 
    "template", " ", "fitting", " ", "approach", " ", "using", " ", "eq", 
    ".22"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalCovTemplateFitting", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "K", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "FinalCovTemplateFitting", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.850351206483547*^9, 3.8503512632120237`*^9}, {
  3.850360500871291*^9, 3.8503605209466867`*^9}, {3.8503605644973173`*^9, 
  3.850360567881268*^9}, {3.850518523986722*^9, 3.8505185287438593`*^9}, {
  3.850520397410143*^9, 3.850520397624772*^9}, {3.8505220180807*^9, 
  3.8505220242855*^9}, {3.851082551020994*^9, 3.8510825514764843`*^9}, {
  3.901958766692108*^9, 
  3.901958767175706*^9}},ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-\
975d68d3f8d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "quick", " ", "idea", " ", "of", " ", "whether", " ", "final",
      " ", "covariance", " ", "matrices", " ", "from", " ", "NILC", " ", 
     "and", " ", "template", " ", "fitting", " ", "are", " ", "equal"}], ",", 
    " ", 
    RowBox[{
    "check", " ", "using", " ", "numerical", " ", "values", " ", "from", " ", 
     "fgspectra", " ", "and", " ", "CLASS", " ", "in", " ", "python", " ", 
     "code", " ", 
     RowBox[{"(", 
      RowBox[{"ell", "=", 
       RowBox[{"1500", " ", "here"}]}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CC", "=", "0.0019252172031626088"}], ",", " ", 
        RowBox[{"T", "=", 
         RowBox[{"1.4575172568790597", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "18"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"g1", "=", 
         RowBox[{"-", "4356390.851902919"}]}], ",", " ", 
        RowBox[{"g2", "=", 
         RowBox[{"-", "2599711.593181207"}]}], ",", " ", 
        RowBox[{"N1", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"N2", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"Nmodes", "=", "3001"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "FinalCovNILC", "]"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CC", "=", "0.0019252172031626088"}], ",", " ", 
        RowBox[{"T", "=", 
         RowBox[{"1.4575172568790597", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "18"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"g1", "=", 
         RowBox[{"-", "4356390.851902919"}]}], ",", " ", 
        RowBox[{"g2", "=", 
         RowBox[{"-", "2599711.593181207"}]}], ",", " ", 
        RowBox[{"N1", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"N2", "=", 
         RowBox[{"9.051010437258822", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}]}], ",", " ", 
        RowBox[{"Nmodes", "=", "3001"}]}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "FinalCovTemplateFitting", "]"}]}], "]"}], " ",
     "//", "MatrixForm"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.850518551990716*^9, 3.850518602762053*^9}, 
   3.850522254379108*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"504ce110-8039-496b-a8d4-aadf73bca5af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Analytically", " ", "compare", " ", "final", " ", "covariance", " ", 
    "matrices", " ", "from", " ", "NILC", " ", "and", " ", "template", " ", 
    "fitting"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"FinalCovHILC", "-", "FinalCovTemplateFitting"}], "]"}], " ", "//",
    "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.850351271104641*^9, 3.850351296476169*^9}, {
  3.850355875846406*^9, 3.850355905899435*^9}, {3.850360545180888*^9, 
  3.8503605498940563`*^9}, {3.850360672509582*^9, 3.850360678869467*^9}, {
  3.850518617440613*^9, 3.850518631620695*^9}, {3.85051873631888*^9, 
  3.850518751618104*^9}, {3.850520457595566*^9, 3.850520482106653*^9}, {
  3.850520556251568*^9, 3.850520562191472*^9}, {3.8505207309376583`*^9, 
  3.850520736040427*^9}, {3.8505212461870737`*^9, 3.85052124648522*^9}, {
  3.850522102804269*^9, 3.8505221193104477`*^9}, {3.901958769777672*^9, 
  3.901958770197629*^9}},ExpressionUUID->"0a153ff8-2438-42d0-a366-\
cc118750013b"]
},
WindowSize->{1233, 746},
WindowMargins->{{Automatic, 37}, {28, Automatic}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"839a2295-dbf7-4c58-9138-edbdf0665a83"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1549, 39, 73, "Input",ExpressionUUID->"5df9ed2b-4c36-4c7e-aa05-3052f431814e"],
Cell[2110, 61, 1218, 30, 54, "Input",ExpressionUUID->"0e3f2d6a-b561-4102-8127-33814d232d10"],
Cell[3331, 93, 304, 6, 52, "Input",ExpressionUUID->"6574f643-d4b1-4604-970a-deca9402bd10"],
Cell[3638, 101, 2809, 74, 201, "Input",ExpressionUUID->"d4cdc9ab-cb22-4fe9-83fa-339f77bb56c4"],
Cell[6450, 177, 699, 15, 30, "Input",ExpressionUUID->"df97776b-da40-4b25-b589-6c7346b9279c"],
Cell[7152, 194, 1674, 35, 52, "Input",ExpressionUUID->"2a5c4249-e0ed-410e-8c3e-5a3f596868af"],
Cell[8829, 231, 715, 15, 30, "Input",ExpressionUUID->"9ff3a268-3d8e-422b-87d0-5b3bbdc7c55e"],
Cell[9547, 248, 1142, 28, 30, "Input",ExpressionUUID->"ef68a8aa-608a-4e49-ab94-ba30add8c398"],
Cell[10692, 278, 1098, 27, 30, "Input",ExpressionUUID->"1c59591f-124e-44d7-927c-7b4b25b7a6af"],
Cell[11793, 307, 614, 16, 30, "Input",ExpressionUUID->"4fc0363f-8a90-463c-b651-01b54643e951"],
Cell[12410, 325, 8498, 227, 220, "Input",ExpressionUUID->"55f5dfde-ddb1-4257-bb79-cc11dca546de"],
Cell[20911, 554, 1187, 28, 94, "Input",ExpressionUUID->"5c27b8ac-71c0-4323-b2e0-b460c1ab0052"],
Cell[22101, 584, 470, 12, 30, "Input",ExpressionUUID->"0ef201b6-d7c0-4547-824c-b517ffc10786"],
Cell[22574, 598, 4519, 132, 346, "Input",ExpressionUUID->"b047bfce-6f32-494d-a327-e41a90ed23c7"],
Cell[27096, 732, 1742, 43, 94, "Input",ExpressionUUID->"4b50a60d-5c89-4026-82d7-b87a5b4b31cf"],
Cell[28841, 777, 1984, 51, 115, "Input",ExpressionUUID->"67d94767-cec9-46e3-9c9d-7dbca1cf7588"],
Cell[30828, 830, 1957, 50, 115, "Input",ExpressionUUID->"7c73614c-802e-4ef8-afa0-ea8ed97ad75c"],
Cell[32788, 882, 1712, 45, 115, "Input",ExpressionUUID->"6aad7860-ddb2-4139-8a75-1cf7c84d7753"],
Cell[34503, 929, 1720, 45, 115, "Input",ExpressionUUID->"a7763ff9-7dc1-4c2f-abed-12edafd94281"],
Cell[36226, 976, 1702, 45, 115, "Input",ExpressionUUID->"4f1b13f5-a207-482d-939f-78df918f066d"],
Cell[37931, 1023, 1959, 49, 115, "Input",ExpressionUUID->"786b9f9a-4225-41bc-a290-638d63b5ad29"],
Cell[39893, 1074, 4796, 132, 346, "Input",ExpressionUUID->"3d6b127a-5a9a-49a2-b7fe-3623bf033a7d"],
Cell[44692, 1208, 3815, 103, 157, "Input",ExpressionUUID->"58056902-86fe-4fbf-8108-1396992f2aa3"],
Cell[48510, 1313, 878, 19, 73, "Input",ExpressionUUID->"fa093843-a40e-4b97-8d7f-8c73871521ea"],
Cell[49391, 1334, 8523, 231, 493, "Input",ExpressionUUID->"1906fe01-2cd2-4f2d-8e2c-385142f4ee5d"],
Cell[57917, 1567, 7852, 214, 325, "Input",ExpressionUUID->"6c901049-b1b5-4003-885a-cc30e39e5f0c"],
Cell[65772, 1783, 1001, 21, 73, "Input",ExpressionUUID->"a154c0d5-ccb0-43e9-bc19-975d68d3f8d5"],
Cell[66776, 1806, 2919, 77, 157, "Input",ExpressionUUID->"504ce110-8039-496b-a8d4-aadf73bca5af"],
Cell[69698, 1885, 1067, 20, 52, "Input",ExpressionUUID->"0a153ff8-2438-42d0-a366-cc118750013b"]
}
]
*)

